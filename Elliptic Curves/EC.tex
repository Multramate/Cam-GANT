\def\module{Elliptic Curves}
\def\lecturer{Prof Tom Fisher}
\def\term{Michaelmas 2020}
\def\cover{}
\def\syllabus{}
\def\thm{section}

\input{../style/header}

% Macros
\newcommand{\pp}{\mathfrak{P}}
\newcommand{\rational}[5][]{
  \ifx &#1&
    \begin{array}{rcl}
      #2 & \dashrightarrow & #3 \\
      #4 & \longmapsto     & #5
    \end{array}
  \else
    \begin{array}{ccrcl}
      #1 & : & #2 & \dashrightarrow & #3 \\
         &   & #4 & \longmapsto     & #5
    \end{array}
  \fi
}

\begin{document}

\input{../style/cover}

\setcounter{section}{0}

\section{Fermat's method of infinite descent}

\lecture{1}{Friday}{09/10/20}

The following are the books.
\begin{itemize}
\item J H Silverman, The arithmetic of elliptic curves, 1986
\item J W S Cassels, Lectures on elliptic curves, 1991
\item J H Silverman and J Tate, Rational points on elliptic curves, 1992
\item J S Milne, Elliptic curves, 2006
\end{itemize}

\subsection{Primitive triangles}

\begin{definition*}
Let $ \Delta = \Delta\br{a, b, c} $ be a right triangle
$$
\begin{tikzpicture}
\draw (0, 0) to node[below]{$ a $} (-1, 0);
\draw (0, 0) to node[right]{$ b $} (0, 1);
\draw (-1, 0) to node[above left]{$ c $} (0, 1);
\end{tikzpicture},
$$
so $ a^2 + b^2 = c^2 $ and the area of $ \Delta $ is $ \tfrac{1}{2}ab $. Then $ \Delta $ is \textbf{rational} if $ a, b, c \in \QQ $, and $ \Delta $ is \textbf{primitive} if $ a, b, c \in \ZZ $ are coprime.
\end{definition*}

\begin{lemma}
\label{lem:1.1}
Every primitive triangle is of the form $ \Delta\br{u^2 - v^2, 2uv, u^2 + v^2} $ for some $ u, v \in \ZZ $ such that $ u > v > 0 $.
\end{lemma}

\begin{proof}
Without loss of generality $ a $ is odd, $ b $ is even, and $ c $ is odd, so $ \br{b / 2}^2 = \br{\br{c + a} / 2}\br{\br{c - a} / 2} $ is a product of coprime positive integers. By unique prime factorisation in $ \ZZ $,
$$ \dfrac{c + a}{2} = u^2, \qquad \dfrac{c - a}{2} = v^2, \qquad u, v \in \ZZ, $$
so $ a = u^2 - v^2 $, $ b = 2uv $, and $ c = u^2 + v^2 $.
\end{proof}

\begin{definition*}
$ D \in \QQ_{> 0} $ is a \textbf{congruent number} if there exists a rational triangle $ \Delta $ with area $ D $.
\end{definition*}

Note that it suffices to consider $ D \in \ZZ_{> 0} $ squarefree.

\begin{example*}
$ D = 5, 6 $ are congruent numbers.
\end{example*}

\begin{lemma}
\label{lem:1.2}
$ D \in \QQ_{> 0} $ is congruent if and only if $ Dy^2 = x^3 - x $ for some $ x, y \in \QQ $ such that $ y \ne 0 $.
\end{lemma}

\begin{proof}
Lemma \ref{lem:1.1} shows $ D $ is congruent if and only if $ Dw^2 = uv\br{u^2 - v^2} $ for some $ u, v, w \in \QQ $ such that $ w \ne 0 $. Put $ x = u / v $ and $ y = w / v^2 $.
\end{proof}

Fermat showed that $ 1 $ is not a congruent number.

\begin{theorem}
\label{thm:1.3}
There is no solution to
\begin{equation}
\label{eq:1}
w^2 = uv\br{u + v}\br{u - v}, \qquad u, v, w \in \ZZ, \qquad w \ne 0.
\end{equation}
\end{theorem}

\begin{proof}
Without loss of generality $ u $ and $ v $ are coprime, and $ u > 0 $ and $ w > 0 $. If $ v < 0 $ then replace $ \br{u, v, w} $ by $ \br{-v, u, w} $. If $ u \equiv v \mod 2 $ then replace $ \br{u, v, w} $ by $ \br{\br{u + v} / 2, \br{u - v} / 2, w / 2} $. Then $ u, v, u + v, u - v $ are pairwise coprime positive integers whose product is a square. By unique factorisation in $ \ZZ $,
$$ u = a^2, \qquad v = b^2, \qquad u + v = c^2, \qquad u - v = d^2, \qquad a, b, c, d \in \ZZ_{> 0}. $$
Since $ u \not\equiv v \mod 2 $ both $ c $ and $ d $ are odd. Then $ \br{\br{c + d} / 2}^2 + \br{\br{c - d} / 2}^2 = \br{c^2 + d^2} / 2 = u = a^2 $, so $ \Delta\br{\br{c + d} / 2, \br{c - d} / 2, a} $ is a primitive triangle. Its area is $ \br{c^2 - d^2} / 8 = v / 4 = \br{b / 2}^2 $. Let $ w_1 = b / 2 $. By Lemma \ref{lem:1.1}, $ w_1^2 = u_1v_1\br{u_1^2 - v_1^2} $ for some $ u_1, v_1 \in \ZZ $, that is we have a new solution to $ \br{\ref{eq:1}} $. But $ 4w_1^2 = b^2 = v \mid w^2 $, so $ w_1 \le w / 2 $. So by Fermat's method of infinite descent, there is no solution to $ \br{\ref{eq:1}} $.
\end{proof}

\pagebreak

\subsection{A variant for polynomials}

In this section, $ K $ is a field with $ \ch K \ne 2 $ and algebraic closure $ \overline{K} $.

\begin{lemma}
\label{lem:1.4}
Let $ u, v \in K\sbr{t} $ be coprime. If $ \alpha u + \beta v $ is a square for four distinct $ \br{\alpha : \beta} \in \PP^1 $ then $ u, v \in K $.
\end{lemma}

\begin{proof}
Without loss of generality $ K = \overline{K} $. Changing coordinates on $ \PP^1 $ we may assume the ratios $ \br{\alpha : \beta} $ are $ \br{1 : 0}, \br{0 : 1}, \br{1 : -1}, \br{1 : -\lambda} $ for some $ \lambda \in K \setminus \cbr{0, 1} $. Then $ u = a^2 $ and $ v = b^2 $ for some $ a, b \in K\sbr{t} $, so $ u - v = \br{a + b}\br{a - b} $ and $ u - \lambda v = \br{a + \mu b}\br{a - \mu b} $ for $ \mu = \sqrt{\lambda} $. By unique factorisation in $ K\sbr{t} $, $ a + b, a - b, a + \mu b, a - \mu b $ are squares. But $ \max\br{\deg a, \deg b} \le \tfrac{1}{2}\max\br{\deg u, \deg v} $. So by Fermat's method of infinite descent $ u, v \in K $.
\end{proof}

\begin{definition}
\label{def:1.5}
An \textbf{elliptic curve} $ E / K $ is the projective closure of the plane affine curve $ y^2 = f\br{x} $ where $ f \in K\sbr{x} $ is a monic cubic polynomial with distinct roots in $ \overline{K} $. For $ L / K $ any field extension
$$ E\br{L} = \cbr{\br{x, y} \in L^2 \st y^2 = f\br{x}} \cup \cbr{\OOO}, $$
where $ \OOO $ is the \textbf{point at infinity}.
\end{definition}

\begin{fact*}
$ E\br{L} $ is naturally an abelian group.
\end{fact*}

In this course we study $ E\br{L} $ for $ L $ a finite field, a local field $ \sbr{L : \QQ_p} < \infty $, or a number field $ \sbr{L : \QQ} < \infty $. By Lemma \ref{lem:1.2} and Theorem \ref{thm:1.3}, if $ E $ is $ y^2 = x^3 - x $ then $ E\br{\QQ} = \cbr{\OOO, \br{0, 0}, \br{\pm 1, 0}} $.

\begin{corollary}
\label{cor:1.6}
Let $ E / K $ be an elliptic curve. Then $ E\br{K\br{t}} = E\br{K} $.
\end{corollary}

\begin{proof}
Without loss of generality $ K = \overline{K} $. By a change of coordinates we may assume $ E $ is
$$ y^2 = x\br{x - 1}\br{x - \lambda}, \qquad \lambda \in K \setminus \cbr{0, 1}. $$
Suppose $ \br{x, y} \in E\br{K\br{t}} $. Write $ x = u / v $ for $ u, v \in K\sbr{t} $ coprime. Then $ w^2 = uv\br{u - v}\br{u - \lambda v} $ for some $ w \in K\sbr{t} $. By unique factorisation in $ K\sbr{t} $, $ u, v, u - v, u - \lambda v $ are all squares. By Lemma \ref{lem:1.4}, $ u, v \in K $, so $ x, y \in K $.
\end{proof}

\pagebreak

\section{Some remarks on algebraic curves}

\lecture{2}{Monday}{12/10/20}

Work over $ K = \overline{K} $.

\subsection{Rational curves}

\begin{definition}
\label{def:2.1}
A plane algebraic curve $ C = \cbr{f\br{x, y} = 0} \subset \AA^2 $ for an irreducible polynomial $ f $ is \textbf{rational} if it has a \textbf{rational parameterisation}, that is there exists $ \phi, \psi \in K\br{t} $ such that
$$ \function{\AA^1}{\AA^2}{t}{\br{\phi\br{t}, \psi\br{t}}} $$
is injective on $ \AA^1 $ minus a finite set, and $ f\br{\phi\br{t}, \psi\br{t}} = 0 $.
\end{definition}

\begin{example}
\hfill
\begin{itemize}
\item Any nonsingular plane conic is rational. For example, let $ x^2 + y^2 = 1 $. The line of slope $ t $ at $ \br{-1, 0} $ is $ y = t\br{x + 1} $. Their intersection is $ x^2 + t^2\br{x + 1}^2 = 1 $, so $ \br{x + 1}\br{x - 1 + t^2\br{x + 1}} = 0 $. Thus $ x = -1 $ or $ x = \br{1 - t^2} / \br{1 + t^2} $. The rational parameterisation is
$$ \br{x, y} = \br{\dfrac{1 - t^2}{1 + t^2}, \dfrac{2t}{1 + t^2}}. $$
\item Any singular plane cubic is rational. For example, let $ y^2 = x^3 $. The line of slope $ t $ at $ \br{0, 0} $ is $ y = tx $. The rational parameterisation is
$$ \br{x, y} = \br{t^2, t^3}. $$
\item Corollary \ref{cor:1.6} shows that elliptic curves are not rational.
\end{itemize}
\end{example}

\begin{remark}
\label{rem:2.3}
The genus $ \g\br{C} \in \ZZ_{\ge 0} $ is an invariant of a smooth projective curve $ C $.
\begin{itemize}
\item If $ K = \CC $ then $ \g\br{C} $ is the genus of a Riemann surface.
\item A smooth plane curve $ C \subset \PP^2 $ of degree $ d $ has genus $ \g\br{C} = \br{d - 1}\br{d - 2} / 2 $.
\end{itemize}
\end{remark}

\begin{proposition}
Still assuming $ K = \overline{K} $, let $ C $ be a smooth projective curve.
\begin{enumerate}
\item $ C $ is rational as in Definition \ref{def:2.1} if and only if $ \g\br{C} = 0 $.
\item $ C $ is an elliptic curve as in Definition \ref{def:1.5} if and only if $ \g\br{C} = 1 $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item Omitted.
\item For $ \implies $, use Remark \ref{rem:2.3}. For $ \impliedby $, see later Theorem \ref{thm:3.1}.
\end{enumerate}
\end{proof}

\subsection{Order of vanishing}

Let $ C $ be an algebraic curve, with function field $ K\br{C} $. Let $ P \in C $ be a smooth point. Write $ \ord_P f $ for the order of vanishing of $ f \in K\br{C} $ at $ P $, which is negative if $ f $ has a pole.

\begin{fact*}
$ \ord_P : K\br{C}^* \to \ZZ $ is a \textbf{discrete valuation}, that is
$$ \ord_P \br{f_1f_2} = \ord_P f_1 + \ord_P f_2, \qquad \ord_P \br{f_1 + f_2} \ge \min\br{\ord_P f_1, \ord_P f_2}. $$
\end{fact*}

\begin{definition*}
$ t \in K\br{C}^* $ is a \textbf{uniformiser} at the point $ P $ if $ \ord_P t = 1 $.
\end{definition*}

\pagebreak

\begin{example}
Let $ C = \cbr{g = 0} \subset \AA^2 $ for $ g \in K\sbr{x, y} $ irreducible, so $ K\br{C} = \Frac \br{K\sbr{x, y} / \abr{g}} $ for $ g = g_0 + g_1\br{x, y} + \dots $ where $ g_i $ is homogeneous of degree $ i $. Suppose $ P = \br{0, 0} \in C $ is a smooth point, that is $ g_0 = 0 $ and $ g_1\br{x, y} = \alpha x + \beta y $ such that $ \alpha $ and $ \beta $ are not both zero. Let $ \gamma, \delta \in K $. A fact is that
$$ \gamma x + \delta y \in K\br{C} \ \text{is a uniformiser at} \ p \qquad \iff \qquad \alpha\delta - \beta\gamma \ne 0. $$
\end{example}

\begin{example}
\label{eg:2.6}
By $ x = X / Z $ and $ y = Y / Z $, the projective closure of $ \cbr{y^2 = x\br{x - 1}\br{x - \lambda}} \subset \AA^2 $ for $ \lambda \ne 0, 1 $ is
$$ \cbr{Y^2Z = X\br{X - Z}\br{X - \lambda Z}} \subset \PP^2. $$
Let $ P = \br{0 : 1 : 0} $. We compute $ \ord_P x $ and $ \ord_P y $. Put $ t = X / Y $ and $ w = Z / Y $. Then
\begin{equation}
\label{eq:2}
w = t\br{t - w}\br{t - \lambda w}.
\end{equation}
Now $ P $ is the point $ \br{t, w} = \br{0, 0} $. This is a smooth point and $ \ord_P t = \ord_P \br{t - w} = \ord_P \br{t - \lambda w} = 1 $. By $ \br{\ref{eq:2}} $, $ \ord_P w = 3 $, so
$$ \ord_P x = \ord_P \dfrac{X}{Z} = \ord_P \dfrac{t}{w} = 1 - 3 = -2, \qquad \ord_P y = \ord_P \dfrac{Y}{Z} = \ord_P \dfrac{1}{w} = -3. $$
Remark that the line $ \cbr{w = 0} $ meets $ E $ with multiplicity three at $ P $, so $ P $ is a point of inflection.
\end{example}

\subsection{Riemann Roch spaces}

\begin{definition*}
Let $ C $ be a smooth projective curve. A \textbf{divisor} is a formal sum of points on $ C $, say
$$ D = \sum_{P \in C} n_P\br{P}, \qquad n_P \in \ZZ, $$
with $ n_P = 0 $ for all but finitely many $ P \in C $. The \textbf{degree} of $ D $ is
$$ \deg D = \sum_{P \in C} n_P. $$
Then $ D $ is \textbf{effective}, written $ D \ge 0 $, if $ n_P \ge 0 $ for all $ P \in C $. If $ f \in K\br{C}^* $ then the \textbf{divisor of $ f $} is
$$ \div f = \sum_{P \in C} \br{\ord_P f}\br{P}. $$
The \textbf{Riemann Roch space} of $ D \in \Div C $ is
$$ \LLL\br{D} = \cbr{f \in K\br{C}^* \st \div f + D \ge 0} \cup \cbr{0}, $$
that is the $ K $-vector space of rational functions on $ C $ with poles no worse than specified by $ D $.
\end{definition*}

\textbf{Riemann Roch for genus one} states that
$$ \dim \LLL\br{D} =
\begin{cases}
0 & \deg D < 0 \\
0 \ \text{or} \ 1 & \deg D = 0 \\
\deg D & \deg D > 0
\end{cases}.
$$

\begin{example*}
Revisiting Example \ref{eg:2.6}, let $ P $ be the point at infinity of $ \cbr{y^2 = x\br{x - 1}\br{x - \lambda}} \subset \AA^2 $. Then $ \ord_P x = -2 $ and $ \ord_P y = -3 $. We deduce
$$ \LLL\br{2\br{P}} = \abr{1, x}, \qquad \LLL\br{3\br{P}} = \abr{1, x, y}. $$
This motivates the proof of Theorem \ref{thm:3.1}.
\end{example*}

\pagebreak

\lecture{3}{Wednesday}{14/10/20}

Assume $ K = \overline{K} $ and $ \ch K \ne 2 $.

\begin{proposition}
\label{prop:2.7}
Let $ C \subset \PP^2 $ be a smooth plane cubic and $ P \in C $ a point of inflection. Then we may change coordinates such that $ C $ is
$$ Y^2 = X\br{X - Z}\br{X - \lambda Z}, \qquad \lambda \ne 0, 1, $$
and $ P = \br{0 : 1 : 0} $.
\end{proposition}

\begin{proof}
We change coordinates such that $ P = \br{0 : 1 : 0} $ and $ \T_PC = \cbr{Z = 0} $. Let $ C = \cbr{F\br{X, Y, Z} = 0} $. Since $ P \in C $ is a point of inflection, $ F\br{t, 1, 0} $ is a constant times $ t^3 $, that is no terms $ X^2Y, XY^2, Y^3 $, so
$$ F \in \abr{Y^2Z, XYZ, YZ^2, X^3, X^2Z, XZ^2, Z^3}. $$
The coefficient of $ Y^2Z $ is nonzero otherwise $ P \in C $ is singular. The coefficient of $ X^3 $ is nonzero otherwise $ \cbr{Z = 0} \subset C $. We are free to rescale $ X, Y, Z, F $. Without loss of generality $ C $ is defined by
$$ Y^2Z + a_1XYZ + a_3YZ^2 = X^3 + a_2X^2Z + a_4XZ^2 + a_6Z^3, $$
the \textbf{Weierstrass form}. Substituting $ Y $ by $ Y - \tfrac{1}{2}a_1X - \tfrac{1}{2}a_3Z $ we may assume $ a_1 = a_3 = 0 $. Now $ C $ is $ Y^2Z = Z^3f\br{X / Z} $ for $ f $ a monic cubic polynomial. Since $ C $ is smooth, $ f $ has distinct roots, without loss of generality $ 0, 1, \lambda $. Thus $ C $ is
$$ Y^2 = X\br{X - Z}\br{X - \lambda Z}, $$
the \textbf{Legendre form}.
\end{proof}

\begin{remark*}
It may be shown that the points of inflection on $ C = \cbr{F = 0} \subset \PP^2 $ in coordinates $ \br{X_1 : X_2 : X_3} $ are given by $ F = \det H = 0 $, where $ H = \br{\tmd{F}{2}{X_i}{}{X_j}{}} $ is a $ 3 \times 3 $ matrix.
\end{remark*}

\subsection{The degree of a morphism}

\begin{definition*}
Let $ \phi : C_1 \to C_2 $ be a nonconstant morphism of smooth projective curves. Let
$$ \function[\phi^*]{K\br{C_2}}{K\br{C_1}}{f}{f \circ \phi}. $$
The \textbf{degree} of $ \phi $ is
$$ \deg \phi = \sbr{K\br{C_1} : \phi^*K\br{C_2}}, $$
and $ \phi $ is \textbf{separable} if $ K\br{C_1} / \phi^*K\br{C_2} $ is a separable field extension, which is automatic if $ \ch K = 0 $. Suppose
$$ \function[\phi]{C_1}{C_2}{P}{Q}. $$
Let $ t \in K\br{C_2} $ be a uniformiser at $ Q $. The \textbf{ramification index} of $ \phi $ at $ P $ is
$$ \e_\phi\br{P} = \ord_P \phi^*t, $$
which is always at least one, and independent of $ t $.
\end{definition*}

\begin{theorem}
\label{thm:2.8}
Let $ \phi : C_1 \to C_2 $ be a nonconstant morphism of smooth projective curves. Then
$$ \sum_{P \in \phi^{-1}\br{Q}} \e_\phi\br{P} = \deg \phi, \qquad Q \in C_2. $$
Moreover if $ \phi $ is separable then $ \e_\phi\br{P} = 1 $ for all but finitely many $ P \in C_1 $. In particular
\begin{itemize}
\item $ \phi $ is surjective, noting that $ K = \overline{K} $, and
\item $ \#\phi^{-1}\br{Q} \le \deg \phi $, with equality for all but finitely many $ Q $, assuming $ \phi $ is separable.
\end{itemize}
\end{theorem}

\begin{remark}
\label{rem:2.9}
Let $ C $ be an algebraic curve. A rational map is given by
$$ \rational[\phi]{C}{\PP^n}{P}{\br{f_0\br{P} : \dots : f_n\br{P}}}, $$
where $ f_0, \dots, f_n \in K\br{C} $ are not all zero. A fact is if $ C $ is smooth then $ \phi $ is a morphism.
\end{remark}

\pagebreak

\section{Weierstrass equations}

In this section $ K $ is a perfect field, with algebraic closure $ \overline{K} $.

\begin{definition*}
An \textbf{elliptic curve} $ E $ over $ K $ is a smooth projective curve of genus one defined over $ K $ with a specified $ K $-rational point $ \OOO_E $.
\end{definition*}

\begin{example*}
$ \cbr{X^3 + pY^3 + p^2Z^3 = 0} \subset \PP^2 $ for $ p $ prime is not an elliptic curve over $ \QQ $, since it has no $ \QQ $-points.
\end{example*}

\subsection{The Weierstrass form}

\begin{theorem}
\label{thm:3.1}
Every elliptic curve $ E $ is isomorphic over $ K $ to a curve in Weierstrass form, via an isomorphism taking $ \OOO_E $ to $ \br{0 : 1 : 0} $.
\end{theorem}

\begin{remark*}
Proposition \ref{prop:2.7} treated the special case where $ E $ is a smooth plane cubic and $ \OOO_E $ is a point of inflection.
\end{remark*}

\begin{fact*}
If $ D \in \Div E $ is defined over $ K $, that is fixed by $ \Gal\br{\overline{K} / K} $, then $ \LLL\br{D} $ has a basis in $ K\br{E} $, not just in $ \overline{K}\br{E} $.
\end{fact*}

\begin{proof}
Pick bases $ \abr{1, x} = \LLL\br{2\br{\OOO_E}} \subset \LLL\br{3\br{\OOO_E}} = \abr{1, x, y} $. Then $ \ord_{\OOO_E} x = -2 $ and $ \ord_{\OOO_E} y = -3 $. The seven elements $ 1, x, y, x^2, xy, x^3, y^2 $ in the six-dimensional vector space $ \LLL\br{6\br{\OOO_E}} $ must satisfy a dependence relation. Leaving out $ x^3 $ or $ y^2 $ gives a basis for $ \LLL\br{6\br{\OOO_E}} $ since each term has a different order pole at $ \OOO_E $, so the coefficients of $ x^3 $ and $ y^2 $ are nonzero. Rescaling $ x $ and $ y $ we get
$$ y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6, \qquad a_i \in K. $$
Let $ E' $ be the curve defined by this equation, or rather its projective closure. There is a morphism
$$ \functions[\phi]{E}{E' \subset \PP^2}{P}{\br{x\br{P} : y\br{P} : 1} = \br{\dfrac{x}{y}\br{P} : 1 : \dfrac{1}{y}\br{P}}}{\OOO_E}{\br{0 : 1 : 0}}. $$
Then
$$ \sbr{K\br{E} : K\br{x}} = \deg \br{x : E \to \PP^1} = \ord_{\OOO_E} \dfrac{1}{x} = 2, \qquad \sbr{K\br{E} : K\br{y}} = \deg \br{y : E \to \PP^1} = \ord_{\OOO_E} \dfrac{1}{y} = 3, $$
so
$$
\begin{tikzcd}
& K\br{E} \arrow[dash]{d} \arrow[dash]{ddl}[swap]{2} \arrow[dash]{ddr}{3} & \\
& K\br{x, y} \arrow[dash]{dl} \arrow[dash]{dr} & \\
K\br{x} & & K\br{y}
\end{tikzcd}.
$$
By the tower law, $ \sbr{K\br{E} : K\br{x, y}} = 1 $, so $ \deg \br{\phi : E \to E'} = 1 $, so $ \phi $ is birational. If $ E' $ is singular then $ E $ and $ E' $ are rational, a contradiction. So $ E' $ is smooth and we may apply Remark \ref{rem:2.9} to $ \phi^{-1} $ to see that $ \phi^{-1} $ is a morphism, so $ \phi $ is an isomorphism.
\end{proof}

\lecture{4}{Friday}{16/10/20}

\begin{proposition}
\label{prop:3.2}
Let $ E $ and $ E' $ be elliptic curves over $ K $ in Weierstrass form. Then $ E \cong E' $ over $ K $ if and only if the Weierstrass equations are related by a change of variables
$$ x = u^2x' + r, \qquad y = u^3y' + u^2sx' + t, \qquad u, r, s, t \in K, \qquad u \ne 0. $$
\end{proposition}

\begin{proof}
Let $ \abr{1, x} = \LLL\br{2\br{\OOO_E}} = \abr{1, x'} $ and $ \abr{1, x, y} = \LLL\br{3\br{\OOO_E}} = \abr{1, x', y'} $. Then
$$ x = \lambda x' + r, \qquad y = \mu y' + \sigma x' + t, \qquad \lambda, r, \mu, \sigma, t \in K, \qquad \lambda, \mu \ne 0. $$
Looking at the coefficients of $ x^3 $ and $ y^2 $, $ \lambda^3 = \mu^2 $, so $ \br{\lambda, \mu} = \br{u^2, u^3} $ for some $ u \in K^* $. Put $ s = \sigma / u^2 $.
\end{proof}

\pagebreak

\subsection{Discriminant and \texorpdfstring{$ \j $}{j}-invariant}

A Weierstrass equation defines an elliptic curve if and only if it defines a smooth curve, if and only if $ \Delta\br{a_1, \dots, a_6} \ne 0 $ where $ \Delta \in \ZZ\sbr{a_1, \dots, a_6} $ is a certain polynomial. If $ \ch K \ne 2, 3 $ then we can reduce to the case $ E $ is
$$ y^2 = x^3 + ax + b, $$
with \textbf{discriminant}
$$ \Delta = -16\br{4a^3 + 27b^2}. $$

\begin{corollary}
Assume $ \ch K \ne 2, 3 $. Elliptic curves $ E = \cbr{y^2 = x^3 + ax + b} $ and $ E' = \cbr{y^2 = x^3 + a'x + b'} $ are isomorphic over $ K $ if and only if $ a' = u^4a $ and $ b' = u^6b $ for some $ u \in K^* $.
\end{corollary}

\begin{proof}
$ E $ and $ E' $ are related as in Proposition \ref{prop:3.2} with $ r = s = t = 0 $.
\end{proof}

\begin{definition*}
The \textbf{$ \j $-invariant} is
$$ \j\br{E} = \dfrac{1728\br{4a^3}}{4a^3 + 27b^2}. $$
\end{definition*}

\begin{corollary}
If $ E \cong E' $, then $ \j\br{E} = \j\br{E'} $, and the converse holds if $ K = \overline{K} $.
\end{corollary}

\begin{proof}
$$ E \cong E' \quad \iff \quad \exists u \in K^*, \
\begin{cases}
a' = u^4a \\
b' = u^6b
\end{cases}
\quad \implies \quad \br{a^3 : b^2} = \br{a'^3 : b'^2} \quad \iff \quad \j\br{E} = \j\br{E'}, $$
and the converse holds if $ K = \overline{K} $.
\end{proof}

\pagebreak

\section{Group law}

Let $ E = E\br{\overline{K}} \subset \PP^2 $ be a smooth plane cubic, and let $ \OOO_E \in E\br{K} $. Then $ E $ meets each line in three points counted with multiplicity.

\subsection{The Picard group law}

Let $ P, Q \in E $, let $ S $ be the third point of intersection of $ PQ $ and $ E $, and let $ R $ be the third point of intersection of $ \OOO_ES $ and $ E $. We define
$$ P \oplus Q = R. $$
If $ P = Q $ then take $ \T_PE $ instead, etc. This is the \textbf{chord and tangent process}.

\begin{theorem}
\label{thm:4.1}
$ \br{E, \oplus} $ is an abelian group.
\end{theorem}

Associativity is hard.

\begin{definition*}
$ D_1, D_2 \in \Div E $ are \textbf{linearly equivalent}, written $ D_1 \sim D_2 $, if there exists $ f \in \overline{K}\br{E}^* $ such that
$$ \div f = D_1 - D_2. $$
Let
$$ \sbr{D} = \cbr{D' \st D' \sim D}. $$
The \textbf{Picard group} is
$$ \Pic E = \Div E / \sim. $$
If
$$ \Div^0 E = \ker \br{\deg : \Div E \to \ZZ} $$
is the degree zero divisors on $ E $, let
$$ \Pic^0 E = \Div^0 E / \sim. $$
\end{definition*}

Note that $ \div fg = \div f + \div g $.

\begin{proposition}
\label{prop:4.2}
Let
$$ \function[\psi]{E}{\Pic^0 E}{P}{\sbr{\br{P} - \br{\OOO_E}}}. $$
Then
\begin{enumerate}
\item $ \psi\br{P \oplus Q} = \psi\br{P} + \psi\br{Q} $, and
\item $ \psi $ is a bijection.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item Let $ P, Q \in E $, let $ S $ be the third point of intersection of $ PQ $ and $ E $, and let $ R $ be the third point of intersection of $ \OOO_ES $ and $ E $. Let $ l = 0 $ be the line $ PQ $ and let $ m = 0 $ be the line $ \OOO_ES $. Then
$$ \div \dfrac{l}{m} = \br{P} + \br{S} + \br{Q} - \br{R} - \br{S} - \br{\OOO_E} = \br{P} + \br{Q} - \br{\OOO_E} - \br{P \oplus Q}, $$
so $ \br{P \oplus Q} + \br{\OOO_E} \sim \br{P} + \br{Q} $. Thus $ \br{P \oplus Q} - \br{\OOO_E} \sim \br{P} - \br{\OOO_E} + \br{Q} - \br{\OOO_E} $, so $ \psi\br{P \oplus Q} = \psi\br{P} + \psi\br{Q} $.
\item For injectivity, suppose $ \psi\br{P} = \psi\br{Q} $ for $ P \ne Q $. Then there exists $ f \in \overline{K}\br{E}^* $ such that $ \div f = \br{P} - \br{Q} $, and $ \deg \br{f : E \to \PP^1} = \ord_P f = 1 $, so $ E \cong \PP^1 $, a contradiction. For surjectivity, let $ \sbr{D} \in \Pic^0 E $. Then $ D + \br{\OOO_E} $ has degree one. By Riemann Roch, $ \dim \LLL\br{D + \br{\OOO_E}} = 1 $, so there exists $ f \in \overline{K}\br{E}^* $ such that $ \div f + D + \br{\OOO_E} \ge 0 $. Since $ \div f + D + \br{\OOO_E} $ has degree one, $ \div f + D + \br{\OOO_E} = \br{P} $ for some $ P \in E $, so $ \br{P} - \br{\OOO_E} \sim D $. Thus $ \psi\br{P} = \sbr{D} $.
\end{enumerate}
\end{proof}

\pagebreak

\begin{proof}[Proof of Theorem \ref{thm:4.1}]
\hfill
\begin{itemize}
\item $ P \oplus Q = Q \oplus P $ is clear.
\item $ \OOO_E $ is the identity. Let $ S $ be the third point of intersection of $ \OOO_EP $ and $ E $. Then $ P $ is the third point of intersection of $ \OOO_ES $ and $ E $, so $ \OOO_E \oplus P = P $.
\item Inverses. Let $ S $ be the third point of intersection of $ \T_{\OOO_E}E $ and $ E $, and let $ Q $ be the third point of intersection of $ PS $ and $ E $. Then $ S $ is the third point of intersection of $ PQ $ and $ E $, and $ \OOO_E $ is the third point of intersection of $ \OOO_ES $ and $ E $, so $ P \oplus Q = \OOO_E $.
\item By Proposition \ref{prop:4.2},
$$ \psi\br{\br{P \oplus Q} \oplus R} = \psi\br{P \oplus Q} + \psi\br{R} = \psi\br{P} + \psi\br{Q} + \psi\br{R} = \psi\br{P} + \psi\br{Q \oplus R} = \psi\br{P \oplus \br{Q \oplus R}}. $$
Since $ \psi $ is injective, $ \br{P \oplus Q} \oplus R = P \oplus \br{Q \oplus R} $. We deduce that $ \oplus $ is associative, and
$$ \psi : \br{E, \oplus} \xrightarrow{\sim} \br{\Pic^0 E, +} $$
is an isomorphism of groups. Note that we did not need $ \psi $ surjective for the proof that $ \oplus $ is associative.
\end{itemize}
\end{proof}

\subsection{Explicit formulae for the group law}

\lecture{5}{Monday}{19/10/20}

We consider $ E $ in Weierstrass form
\begin{equation}
\label{eq:3}
y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6,
\end{equation}
and $ \OOO_E $ is the point at infinity.

\begin{remark*}
$ \OOO_E $ is a point of inflection. So now $ P_1 \oplus P_2 \oplus P_3 = \OOO_E $ if and only if $ P_1, P_2, P_3 $ are collinear.
\end{remark*}

Let $ P_1 = \br{x_1, y_1} $ and $ P_2 = \br{x_3, y_3} $, let $ P' = \br{x', y'} $ be the third point of intersection of $ P_1P_2 = \cbr{y = \lambda x + \nu} $ and $ E $, and let $ P_3 = \br{x_3, y_3} $ be the second point of intersection between $ x = x' $ and $ E $, so $ P_3 = P_1 \oplus P_2 = \ominus P' $. Thus
$$ \ominus P_1 = \br{x_1, -\br{a_1x_1 + a_3} - y_1}. $$
Substituting $ y = \lambda x + \nu $ into $ \br{\ref{eq:3}} $ and looking at the coefficient of $ x^2 $ gives $ \lambda^2 + a_1\lambda - a_2 = x_1 + x_2 + x' $, so
$$ x_3 = \lambda^2 + a_1\lambda - a_2 - x_1 - x_2, \qquad y_3 = -\br{a_1x' + a_3} - y' = -\br{a_1x' + a_3} - \br{\lambda x' + \nu} = -\br{\lambda + a_1}x_3 - \nu - a_3. $$
It remains to find formulae for $ \lambda $ and $ \nu $.
\begin{enumerate}[leftmargin=0.5in, label=Case \arabic*.]
\item $ x_1 = x_2 $ and $ P_1 \ne P_2 $. Then $ P_1 \oplus P_2 = \OOO_E $.
\item $ x_1 \ne x_2 $. Then
$$ \lambda = \dfrac{y_2 - y_1}{x_2 - x_1}, \qquad \nu = y_1 - \lambda x_1 = \dfrac{y_1\br{x_2 - x_1} - \br{y_2 - y_1}x_1}{x_2 - x_1} = \dfrac{y_1x_2 - y_2x_1}{x_2 - x_1}. $$
\item $ x_1 = x_2 $ and $ P_1 = P_2 $. Then
$$ \lambda = \dfrac{3x_1^2 + 2a_2x_1 + a_4 - a_1y_1}{2y_1 + a_1x_1 + a_3}, \qquad \nu = \dfrac{-x_1^3 + a_4x_1 + 2a_6 - a_3y_1}{2y_1 + a_1x_1 + a_3}. $$
\end{enumerate}

\begin{corollary}
$ E\br{K} $ is an abelian group.
\end{corollary}

\begin{proof}
It is a subgroup of $ E = E\br{\overline{K}} $.
\begin{itemize}
\item Identity is $ \OOO_E \in E\br{K} $ by definition.
\item Closure and inverses are by the formulae above.
\item Associativity and commutativity are inherited.
\end{itemize}
\end{proof}

\pagebreak

\subsection{Maps on an elliptic curve}

\begin{theorem}
\label{thm:4.4}
Elliptic curves are \textbf{group varieties}. That is,
$$ \function[\sbr{-1}]{E}{E}{P}{-P}, \qquad \function[+]{E \times E}{E}{\br{P, Q}}{P + Q} $$
are morphisms of algebraic varieties.
\end{theorem}

\begin{proof}
The above formulae show $ \sbr{-1} $ and $ + $ are rational maps. By Remark \ref{rem:2.9}, $ \sbr{-1} : E \to E $ is a morphism. The formulae also show, by case $ 2 $, that $ + $ is regular on
$$ U = \cbr{\br{P, Q} \in E \times E \st P, Q, P + Q, P - Q \ne \OOO_E}. $$
For $ P \in E $ let translation by $ P $ be
$$ \function[\tau_P]{E}{E}{X}{P + X}, $$
which is a rational map and therefore a morphism. Let $ A, B \in E $. We factor $ + $ as
$$ E \times E \xrightarrow{\tau_{-A} \times \tau_{-B}} E \times E \xrightarrow{+} E \xrightarrow{\tau_{A + B}} E. $$
Thus $ + $ is regular on $ \br{\tau_A \times \tau_B}\br{U} $ for all $ A, B \in E $, so $ + $ is regular on $ E \times E $.
\end{proof}

\begin{definition*}
For $ n \in \ZZ $ let
$$ \function[\sbr{n}]{E}{E}{P}{\underbrace{P + \dots + P}_n}, $$
and $ \sbr{-n} = \sbr{-1} \circ \sbr{n} $. The \textbf{$ n $-torsion subgroup} of $ E $ is
$$ E\sbr{n} = \ker \br{\sbr{n} : E \to E}. $$
\end{definition*}

\begin{lemma}
\label{lem:4.5}
Assume $ \ch K \ne 2 $. Let $ E $ be
$$ y^2 = \br{x - e_1}\br{x - e_2}\br{x - e_3}, $$
for $ e_1, e_2, e_3 \in \overline{K} $ distinct. Then
$$ E\sbr{2} = \cbr{\OOO, \br{e_1, 0}, \br{e_2, 0}, \br{e_3, 0}} \cong \br{\ZZ / 2\ZZ}^2. $$
\end{lemma}

\begin{proof}
Let $ P = \br{x, y} \in E $. Then $ \sbr{2}P = 0 $ if and only if $ P = -P $, if and only if $ \br{x, y} = \br{x, -y} $, if and only if $ y = 0 $.
\end{proof}

\subsection{Elliptic curves over \texorpdfstring{$ \CC $}{C} and other fields}

Let $ \Lambda = \cbr{a\omega_1 + b\omega_2 \st a, b \in \ZZ} $ for $ \omega_1 $ and $ \omega_2 $ a basis for $ \CC $ as an $ \RR $-vector space. Then
$$ \correspondence{\text{meromorphic functions on} \\ \text{Riemann surface} \ \CC / \Lambda}{\text{$ \Lambda $-invariant meromorphic} \\ \text{functions on} \ \CC}. $$
This field is generated by $ \wp\br{z} $ and $ \wp'\br{z} $ where
$$ \wp\br{z} = \dfrac{1}{z^2} + \sum_{0 \ne \lambda \in \Lambda} \br{\dfrac{1}{\br{z - \lambda}^2} - \dfrac{1}{\lambda^2}}. $$
They satisfy
$$ \wp'\br{z}^2 = 4\wp\br{z}^3 - g_2\wp\br{z} - g_3 $$
for some $ g_2, g_3 \in \CC $ depending on $ \Lambda $. One shows that
$$ \CC / \Lambda \cong E\br{\CC} $$
is an isomorphism as Riemann surfaces and as groups, where $ E $ is the elliptic curve
$$ y^2 = 4x^3 - g_2x - g_3. $$

\pagebreak

\begin{theorem}[Uniformisation theorem]
Every elliptic curve over $ \CC $ arises in this way.
\end{theorem}

For elliptic curves $ E / \CC $ we have
\begin{enumerate}
\item $ E\sbr{n} \cong \br{\ZZ / n\ZZ}^2 $, and
\item $ \deg \sbr{n} = n^2 $.
\end{enumerate}
We show $ 2 $ holds over any field $ K $ and $ 1 $ holds if $ \ch K \nmid n $. The following will be a summary of the results.
\begin{enumerate}
\item If $ K = \CC $, then
$$ E\br{\CC} \cong \CC / \Lambda \cong \RR / \ZZ \times \RR / \ZZ. $$
\item If $ K = \RR $, then
$$ E\br{\RR} \cong
\begin{cases}
\ZZ / 2\ZZ \times \RR / \ZZ & \Delta > 0 \\
\RR / \ZZ & \Delta < 0
\end{cases}.
$$
\item If $ K = \FF_q $, then Hasse's theorem states that
$$ \abs{\#E\br{\FF_q} - \br{q + 1}} \le 2\sqrt{q}. $$
\item If $ \sbr{K : \QQ_p} < \infty $ with ring of integers $ \OOO_K $, then $ E\br{K} $ has a subgroup of finite index isomorphic to $ \br{\OOO_K, +} $.
\item If $ \sbr{K : \QQ} < \infty $, then the Mordell-Weil theorem states that $ E\br{K} $ is a finitely generated abelian group.
\end{enumerate}
Note that the isomorphisms in $ 1 $, $ 2 $, and $ 4 $ respect the relevant topologies.

\pagebreak

\section{Isogenies}

\subsection{Isogenies}

\lecture{6}{Wednesday}{21/10/20}

\begin{definition*}
Let $ E_1 $ and $ E_2 $ be elliptic curves. An \textbf{isogeny} $ \phi : E_1 \to E_2 $ is a nonconstant morphism with $ \phi\br{\OOO_{E_1}} = \OOO_{E_2} $, which is if and only if it is surjective on $ \overline{K} $-points, by Theorem \ref{thm:2.8}. We say $ E_1 $ and $ E_2 $ are \textbf{isogenous}.
\end{definition*}

Let
$$ \Hom\br{E_1, E_2} = \cbr{\text{isogenies} \ E_1 \to E_2} \cup \cbr{0}. $$
This is a group under $ \br{\phi + \psi}\br{P} = \phi\br{P} + \psi\br{P} $. If $ \phi : E_1 \to E_2 $ and $ \psi : E_2 \to E_3 $ are isogenies then $ \psi \circ \phi $ is an isogeny. By the tower law, $ \deg \br{\psi \circ \phi} = \deg \phi\deg \psi $.

\begin{lemma}
If $ 0 \ne n \in \ZZ $ then $ \sbr{n} : E \to E $ is an isogeny.
\end{lemma}

\begin{proof}
By Theorem \ref{thm:4.4}, $ \sbr{n} $ is a morphism. We must show $ \sbr{n} \ne 0 $. Assume $ \ch K \ne 2 $.
\begin{itemize}[leftmargin=0.5in]
\item[$ n = 2 $.] By Lemma \ref{lem:4.5}, $ \#E\sbr{2} = 4 $, so $ \sbr{2} \ne 0 $.
\item[$ n $ odd.] By Lemma \ref{lem:4.5}, there exists $ \OOO \ne T \in E\sbr{2} $. Then $ nT = T \ne 0 $, so $ \sbr{n} \ne 0 $.
\end{itemize}
Now use $ \sbr{mn} = \sbr{m} \circ \sbr{n} $. If $ \ch K = 2 $ then replace Lemma \ref{lem:4.5} with a lemma computing $ E\sbr{3} $.
\end{proof}

A corollary is that $ \Hom\br{E_1, E_2} $ is torsion free as a $ \ZZ $-module.

\begin{lemma}
Let $ \phi : E_1 \to E_2 $ be an isogeny. Then
$$ \phi\br{P + Q} = \phi\br{P} + \phi\br{Q}, \qquad P, Q \in E_1. $$
\end{lemma}

\begin{proof}
$ \phi $ induces a map
$$ \function[\phi_*]{\Div^0 E_1}{\Div^0 E_2}{\sum_{P \in E} n_P\br{P}}{\sum_{P \in E} n_P\br{\phi\br{P}}}. $$
Recall $ \phi^* : K\br{E_2} \hookrightarrow K\br{E_1} $. A fact is that
$$ \div \br{\N_{K\br{E_1} / K\br{E_2}} f} = \phi_*\br{\div f}, \qquad f \in K\br{E_1}^*. $$
So $ \phi_* $ takes principal divisors to principal divisors. Since $ \phi\br{\OOO_{E_1}} = \OOO_{E_2} $ the diagram
$$
\begin{tikzcd}
E_1 \arrow{r}{\phi} \arrow{d}{\sim}[swap]{P \mapsto \sbr{\br{P} - \br{\OOO_{E_1}}}} & E_2 \arrow{d}{Q \mapsto \sbr{\br{Q} - \br{\OOO_{E_2}}}}[swap]{\sim} \\
\Pic^0 E_1 \arrow{r}[swap]{\phi_*} & \Pic^0 E_2
\end{tikzcd}
$$
commutes. Since $ \phi_* $ is a group homomorphism, $ \phi $ is group homomorphism.
\end{proof}

\begin{lemma}
\label{lem:5.3}
Let $ \phi : E_1 \to E_2 $ be an isogeny. Then there exists a morphism $ \xi $ making the diagram
$$
\begin{tikzcd}
E_1 \arrow{r}{\phi} \arrow{d}[swap]{x_1} & E_2 \arrow{d}{x_2} \\
\PP^1 \arrow{r}[swap]{\xi} & \PP^1
\end{tikzcd}
$$
commute, where $ x_i $ is the $ x $-coordinate on a Weierstrass equation for $ E_i $. Moreover if $ \xi\br{t} = r\br{t} / s\br{t} $ for $ r, s \in K\sbr{t} $ coprime then $ \deg \phi = \deg \xi = \max\br{\deg r, \deg s} $.
\end{lemma}

\pagebreak

\begin{proof}
For $ i = 1, 2 $, $ K\br{E_i} / K\br{x_i} $ is a degree two Galois extension with Galois group generated by $ \sbr{-1}^* $. Since $ \phi $ is a group homomorphism we have $ \phi \circ \sbr{-1} = \sbr{-1} \circ \phi $. If $ f \in K\br{x_2} $ then $ \sbr{-1}^*f = f $ and $ \sbr{-1}^*\br{\phi^*f} = \phi^*\br{\sbr{-1}^*f} = \phi^*f $, so $ \phi^*f \in K\br{x_1} $. Taking $ f = x_2 $ gives $ \phi^*x_2 = \xi\br{x_1} $ for some rational function $ \xi $, so
$$
\begin{tikzcd}
& K\br{E_1} \arrow[dash]{dl}[swap]{2} \arrow[dash]{dd}{\deg \phi} \\
K\br{x_1} \arrow[dash]{dd}[swap]{\deg \xi} & \\
& K\br{E_2} \arrow[dash]{dl}{2} \\
K\br{x_2} &
\end{tikzcd}.
$$
By the tower law, $ 2\deg \phi = 2\deg \xi $, so $ \deg \phi = \deg \xi $. Now
$$ \function[\phi^*]{K\br{x_2}}{K\br{x_1}}{x_2}{\xi\br{x_1} = \dfrac{r\br{x_1}}{s\br{x_1}}}, $$
for $ r, s \in K\sbr{t} $ coprime. Claim that the minimal polynomial of $ x_1 $ over $ K\br{x_2} $ is
$$ f\br{t} = r\br{t} - s\br{t}x_2 \in K\br{x_2}\sbr{t}. $$
Check that $ f\br{x_1} = 0 $ and $ f $ is irreducible in $ K\sbr{x_2, t} $, since $ r $ and $ s $ are coprime. By Gauss' lemma, $ f $ is irreducible in $ K\br{x_2}\sbr{t} $. Thus
$$ \deg \phi = \deg \xi = \sbr{K\br{x_1} : K\br{x_2}} = \deg f = \max\br{\deg r, \deg s}. $$
\end{proof}

\begin{lemma}
$ \deg \sbr{2} = 4 $.
\end{lemma}

\begin{proof}
Assuming $ \ch K \ne 2, 3 $, let $ E $ be $ y^2 = f\br{x} = x^3 + ax + b $. If $ P = \br{x, y} $ then
$$ x\br{2P} = \br{\dfrac{3x^2 + a}{2y}}^2 - 2x = \dfrac{\br{3x^2 + a}^2 - 8xf\br{x}}{4f\br{x}} = \dfrac{x^4 + \dots}{4f\br{x}}. $$
The numerator and denominator are coprime. Indeed otherwise there exists $ \theta \in \overline{K} $ with $ f\br{\theta} = f'\br{\theta} = 0 $, so $ f $ has a multiple root, a contradiction. By Lemma \ref{lem:5.3}, $ \deg \sbr{2} = \max\br{4, 3} = 4 $.
\end{proof}

\subsection{The degree quadratic form}

\lecture{7}{Friday}{23/10/20}

\begin{definition*}
Let $ A $ be an abelian group. Then $ q : A \to \ZZ $ is a \textbf{quadratic form} if
\begin{enumerate}
\item $ q\br{nx} = n^2q\br{x} $ for all $ n \in \ZZ $ and all $ x \in A $, and
\item $ \br{x, y} \mapsto q\br{x + y} - q\br{x} - q\br{y} $ is $ \ZZ $-bilinear.
\end{enumerate}
\end{definition*}

\begin{lemma}
$ q : A \to \ZZ $ is a quadratic form if and only if it satisfies the \textbf{parallelogram law}
$$ q\br{x + y} + q\br{x - y} = 2q\br{x} + 2q\br{y}, \qquad x, y \in A. $$
\end{lemma}

\begin{proof}
\hfill
\begin{itemize}
\item[$ \implies $] Let $ \abr{x, y} = q\br{x + y} - q\br{x} - q\br{y} $. Then $ \abr{x, x} = q\br{2x} - 2q\br{x} = 2q\br{x} $ by $ 1 $ with $ n = 2 $. But by $ 2 $,
$$ q\br{x + y} + q\br{x - y} = \dfrac{1}{2}\abr{x + y, x + y} + \dfrac{1}{2}\abr{x - y, x - y} = \abr{x, x} + \abr{y, y} = 2q\br{x} + 2q\br{y}. $$
\item[$ \impliedby $] On example sheet $ 2 $.
\end{itemize}
\end{proof}

\pagebreak

\begin{theorem}
\label{thm:5.6}
$ \deg : \Hom\br{E_1, E_2} \to \ZZ $ is a quadratic form.
\end{theorem}

Note that $ \deg 0 = 0 $. For the proof we assume $ \ch K \ne 2, 3 $. We write $ E_2 $ as $ y^2 = x^3 + ax + b $. Let $ P, Q \in E_2 $ with $ P, Q, P + Q, P - Q \ne \OOO $. Let $ x_1, \dots, x_4 $ be the $ x $-coordinates of these four points.

\begin{lemma}
\label{lem:5.7}
There exist $ w_0, w_1, w_2 \in \ZZ\sbr{a, b}\sbr{x_1, x_2} $ of degree at most two in $ x_1 $ and of degree at most two in $ x_2 $ such that $ \br{1 : x_3 + x_4 : x_3x_4} = \br{w_0 : w_1 : w_2} $.
\end{lemma}

\begin{proof}
By direct calculation,
$$ w_0 = \br{x_1 - x_2}^2, \qquad w_1 = 2\br{x_1x_2 + a}\br{x_1 + x_2} + 4b, \qquad w_2 = x_1^2x_2^2 - 2ax_1x_2 - 4b\br{x_1 + x_2} + a^2. $$
Alternatively, let $ y = \lambda x + \nu $ be the line through $ P $ and $ Q $. Then
$$ x^3 + ax + b - \br{\lambda x + \nu}^2 = \br{x - x_1}\br{x - x_2}\br{x - x_3} = x^3 - s_1x^2 + s_2x - s_3, $$
where $ s_i $ is the $ i $-th symmetric polynomial in $ x_1, x_2, x_3 $. Comparing coefficients gives $ \lambda^2 = s_1 $, $ -2\lambda\nu = s_2 - a $, and $ \nu^2 = s_3 + b $. Eliminating $ \lambda $ and $ \nu $ gives
$$ F\br{x_1, x_2, x_3} = \br{s_2 - a}^2 - 4s_1\br{s_3 + b} = 0, $$
which has degree at most two in each $ x_i $. Then $ x_3 $ is a root of the quadratic polynomial $ w\br{t} = F\br{x_1, x_2, t} $. Repeating for the line through $ P $ and $ -Q $ shows that $ x_4 $ is the other root. Thus $ w_0\br{t - x_3}\br{t - x_4} = w\br{t} = w_0t^2 - w_1t + w_2 $, so $ \br{1 : x_3 + x_4 : x_3x_4} = \br{w_0 : w_1 : w_2} $.
\end{proof}

\begin{proof}[Proof of Theorem \ref{thm:5.6}]
We show that if $ \phi, \psi \in \Hom\br{E_1, E_2} $ then
$$ \deg \br{\phi + \psi} + \deg \br{\phi - \psi} \le 2\deg \phi + 2\deg \psi. $$
We may assume $ \phi, \psi, \phi + \psi, \phi - \psi \ne 0 $, otherwise trivial, or use $ \deg \sbr{2} = 4 $. Let
$$ \phi : \br{x, y} \mapsto \br{\xi_1\br{x}, \dots}, \qquad \psi : \br{x, y} \mapsto \br{\xi_2\br{x}, \dots}, $$
$$ \phi + \psi : \br{x, y} \mapsto \br{\xi_3\br{x}, \dots}, \qquad \phi - \psi : \br{x, y} \mapsto \br{\xi_4\br{x}, \dots}. $$
By Lemma \ref{lem:5.7},
$$ \br{1 : \xi_3\br{x} + \xi_4\br{x} : \xi_3\br{x}\xi_4\br{x}} = \br{w_0 : w_1 : w_2}, $$
where $ w_0, w_1, w_2 $ are in terms of $ \xi_1\br{x} $ and $ \xi_2\br{x} $. Put $ \xi_i = r_i / s_i $ for $ r_i / s_i \in K\sbr{x} $ coprime. Then
$$ \br{s_3\br{x}s_4\br{x} : r_3\br{x}s_4\br{x} + r_4\br{x}s_3\br{x} : r_3\br{x}r_4\br{x}} = \br{w_0 : w_1 : w_2}, $$
where $ w_0, w_1, w_2 $ are in terms of $ r_1\br{x}, s_1\br{x}, r_2\br{x}, s_2\br{x} $, so
\begin{align*}
\deg \br{\phi + \psi} + \deg \br{\phi - \psi}
& = \max\br{\deg r_3\br{x}, \deg s_3\br{x}} + \max\br{\deg r_4\br{x}, \deg s_4\br{x}} \\
& = \max\br{\deg s_3\br{x}s_4\br{x}, \deg \br{r_3\br{x}s_4\br{x} + r_4\br{x}s_3\br{x}}, \deg r_3\br{x}r_4\br{x}} \\
& \le 2\max\br{\deg r_1\br{x}, \deg s_1\br{x}} + 2\max\br{\deg r_2\br{x}, \deg s_2\br{x}} \\
& = 2\deg \phi + 2\deg \psi,
\end{align*}
since $ s_3\br{x}s_4\br{x}, r_3\br{x}s_4\br{x} + r_4\br{x}s_3\br{x}, r_3\br{x}r_4\br{x} $ are coprime. Now replace $ \phi $ and $ \psi $ by $ \phi + \psi $ and $ \phi - \psi $ to get
$$ \deg 2\phi + \deg 2\psi \le 2\deg \br{\phi + \psi} + 2\deg \br{\phi - \psi}. $$
Since $ \deg \sbr{2} = 4 $ we get
$$ 2\deg \phi + 2\deg \psi \le \deg \br{\phi + \psi} + \deg \br{\phi - \psi}. $$
Thus $ \deg $ satisfies the parallelogram law, so $ \deg $ is a quadratic form.
\end{proof}

\begin{corollary}
\label{cor:5.8}
$ \deg n\phi = n^2\deg \phi $ for all $ n \in \ZZ $ and $ \phi \in \Hom\br{E_1, E_2} $. In particular $ \deg \sbr{n} = n^2 $.
\end{corollary}

\pagebreak

\begin{example}
Let $ E / K $ be an elliptic curve, and let $ \OOO \ne T \in E\br{K}\sbr{2} $. Suppose $ \ch K \ne 2 $. Without loss of generality $ E $ is
$$ y^2 = x\br{x^2 + ax + b}, \qquad a, b \in K, \qquad b\br{a^2 - 4b} \ne 0, $$
and $ T = \br{0, 0} $. If $ P = \br{x, y} $ and $ P' = P + T = \br{x', y'} $, then
$$ x' = \br{\dfrac{y}{x}}^2 - x - a = \dfrac{x^2 + ax + b}{x} - x - a = \dfrac{b}{x}, \qquad y' = -\br{\dfrac{y}{x}}x' = -\dfrac{by}{x^2}. $$
Let
$$ \xi = x + x' + a = \dfrac{x^2 + ax + b}{x} = \br{\dfrac{y}{x}}^2, \qquad \eta = y + y' = \br{\dfrac{y}{x}}\br{x - \dfrac{b}{x}}. $$
Then
$$ \eta^2 = \br{\dfrac{y}{x}}^2\br{\br{x + \dfrac{b}{x}}^2 - 4b} = \xi\br{\br{\xi - a}^2 - 4b} = \xi\br{\xi^2 - 2a\xi + a^2 - 4b}. $$
Let $ E' $ be
$$ y^2 = x\br{x^2 + a'x + b'}, \qquad a' = -2a, \qquad b' = a^2 - 4b. $$
There is an isogeny
$$ \functions[\phi]{E}{E'}{\br{x, y}}{\br{\br{\dfrac{y}{x}}^2 : \dfrac{y\br{x^2 - b}}{x^2} : 1}}{\OOO_E}{\br{0 : 1 : 0}}. $$
Then $ \br{y / x}^2 = \br{x^2 + ax + b} / x $, which are coprime since $ b \ne 0 $. By Lemma \ref{lem:5.3}, $ \deg \phi = 2 $. We say $ \phi $ is a \textbf{$ 2 $-isogeny}.
\end{example}

\pagebreak

\section{The invariant differential}

\lecture{8}{Monday}{26/10/20}

Let $ C $ be an algebraic curve over $ K = \overline{K} $.

\subsection{Differentials}

\begin{definition*}
The space of \textbf{differentials} $ \Omega_C $ is the $ K\br{C} $-vector space generated by $ \d f $ for $ f \in K\br{C} $ subject to the relations
\begin{itemize}
\item $ \d\br{f + g} = \d f + \d g $,
\item $ \d\br{fg} = f\d g + g\d f $, and
\item $ \d a = 0 $ for all $ a \in K $.
\end{itemize}
\end{definition*}

\begin{fact*}
$ \Omega_C $ is a one-dimensional $ K\br{C} $-vector space.
\end{fact*}

Let $ 0 \ne \omega \in \Omega_C $. Let $ P \in C $ be a smooth point and $ t \in K\br{C} $ a uniformiser at $ P $. Then $ \omega = f\d t $ for some $ f \in K\br{C}^* $. We define
$$ \ord_P \omega = \ord_P f. $$
This is independent of the choice of $ t $.

\begin{fact*}
Suppose $ f \in K\br{C}^* $ such that $ \ord_P f = n \ne 0 $. If $ \ch K \nmid n $ then
$$ \ord_P \br{\d f} = n - 1. $$
\end{fact*}

We now assume $ C $ is a smooth projective curve.

\begin{definition*}
Let
$$ \div \omega = \sum_{P \in C} \br{\ord_P \omega}P \in \Div C, $$
using here the fact that $ \ord_P \omega = 0 $ for all but finitely many $ P \in C $.
\end{definition*}

\begin{definition*}
The \textbf{genus} is
$$ \g\br{C} = \dim_K \cbr{\omega \in \Omega_C \st \div \omega \ge 0}, $$
the space of \textbf{regular differentials}.
\end{definition*}

As a consequence of Riemann Roch we have, if $ 0 \ne \omega \in \Omega_C $, then
$$ \deg \br{\div \omega} = 2\g\br{C} - 2. $$

\begin{lemma}
Assume $ \ch K \ne 2 $. Let $ E $ be $ y^2 = \br{x - e_1}\br{x - e_2}\br{x - e_3} $ for $ e_1, e_2, e_3 $ distinct. Then $ \omega = \d x / y $ is a differential on $ E $ with no zeros or poles, so $ \g\br{E} = 1 $. In particular the $ K $-vector space of regular differentials on $ E $ is one-dimensional, spanned by $ \omega $.
\end{lemma}

\begin{proof}
Let $ T_i = \br{e_i, 0} $, so $ E\sbr{2} = \cbr{\OOO, T_1, T_2, T_3} $. Then
\begin{equation}
\label{eq:4}
\div y = \sbr{T_1} + \sbr{T_2} + \sbr{T_3} - 3\sbr{\OOO}.
\end{equation}
For $ P \in E $, $ \div \br{x - x_P} = \sbr{P} + \sbr{-P} - 2\sbr{\OOO} $.
\begin{itemize}
\item If $ P \in E \setminus E\sbr{2} $ then $ \ord_P \br{x - x_P} = 1 $, so $ \ord_P \br{\d x} = 0 $.
\item If $ P = T_i $ then $ \ord_P \br{x - x_P} = 2 $, so $ \ord_P \br{\d x} = 1 $.
\item If $ P = \OOO $ then $ \ord_P x = -2 $, so $ \ord_P \br{\d x} = -3 $.
\end{itemize}
Then
\begin{equation}
\label{eq:5}
\div \br{\d x} = \sbr{T_1} + \sbr{T_2} + \sbr{T_3} - 3\sbr{\OOO}.
\end{equation}
By $ \br{\ref{eq:4}} $ and $ \br{\ref{eq:5}} $, $ \div \br{\d x / y} = 0 $.
\end{proof}

\pagebreak

\subsection{The invariant differential}

\begin{definition*}
If $ \phi : C_1 \to C_2 $ is a nonconstant morphism
$$ \function[\phi^*]{\Omega_{C_2}}{\Omega_{C_1}}{f\d g}{\phi^*f\d\br{\phi^*g}}. $$
\end{definition*}

\begin{lemma}
\label{lem:6.2}
Let $ P \in E $, let $ \omega = \d x / y $ as above, and let
$$ \function[\tau_P]{E}{E}{X}{P + X}. $$
Then $ \tau_P^*\omega = \omega $, so $ \omega $ is called the \textbf{invariant differential}.
\end{lemma}

\begin{proof}
$ \tau_P^*\omega $ is a regular differential on $ E $, so $ \tau_P^*\omega = \lambda_P\omega $ for some $ \lambda_P \in K^* $. The map
$$ \function{E}{\PP^1}{P}{\lambda_P} $$
is a morphism of smooth projective curves but not surjective, since it misses zero and $ \infty $, so it is constant, by Theorem \ref{thm:2.8}, that is there exists $ \lambda \in K^* $ such that $ \tau_P^*\omega = \lambda\omega $ for all $ P \in E $. Taking $ P = \OOO_E $ shows $ \lambda = 1 $.
\end{proof}

\begin{remark*}
If $ K = \CC $, there is an isomorphism
$$ \function{\CC / \Lambda}{E\br{\CC}}{z}{\br{\wp\br{z}, \wp'\br{z}}}, $$
so $ \d x / y = \wp'\br{z}\d z / \wp'\br{z} = \d z $, which is invariant under $ z \mapsto z + c $.
\end{remark*}

\begin{lemma}
\label{lem:6.3}
Let $ \phi, \psi \in \Hom\br{E_1, E_2} $, and let $ \omega $ be the invariant differential on $ E_2 $. Then
$$ \br{\phi + \psi}^*\omega = \phi^*\omega + \psi^*\omega. $$
\end{lemma}

\begin{proof}
Write $ E = E_2 $. Let
$$ \function[\mu]{E \times E}{E}{\br{P, Q}}{P + Q}, \qquad \function[\pi_1]{E \times E}{E}{\br{P, Q}}{P}, \qquad \function[\pi_2]{E \times E}{E}{\br{P, Q}}{Q}. $$
A fact is that $ \Omega_{E \times E} $ is a two-dimensional $ K\br{E \times E} $-vector space with basis $ \pi_1^*\omega $ and $ \pi_2^*\omega $, so
\begin{equation}
\label{eq:6}
\mu^*\omega = f\pi_1^*\omega + g\pi_2^*\omega, \qquad f, g \in K\br{E \times E}.
\end{equation}
For $ Q \in E $ let
$$ \function[\iota_Q]{E}{E \times E}{P}{\br{P, Q}}. $$
Applying $ \iota_Q^* $ to $ \br{\ref{eq:6}} $ gives
$$ \tau_Q^*\omega = \br{\mu \circ \iota_Q}^*\omega = \iota_Q^*f\br{\pi_1 \circ \iota_Q}^*\omega + \iota_Q^*g\br{\pi_2 \circ \iota_Q}^*\omega = \iota_Q^*f\omega + 0, $$
which is $ \omega $ by Lemma \ref{lem:6.2}. Then $ \iota_Q^*f = 1 $ for all $ Q \in E $, so $ f\br{P, Q} = 1 $ for all $ P, Q \in E $. Similarly $ g\br{P, Q} = 1 $ for all $ P, Q \in E $. By $ \br{\ref{eq:6}} $, $ \mu^*\omega = \pi_1^*\omega + \pi_2^*\omega $. Now pull back by
$$ \function{E}{E \times E}{P}{\br{\phi\br{P}, \psi\br{P}}}, $$
to get $ \br{\phi + \psi}^*\omega = \phi^*\omega + \psi^*\omega $.
\end{proof}

\pagebreak

\begin{lemma}
Let $ \phi : C_1 \to C_2 $ be a nonconstant morphism. Then $ \phi $ is separable if and only if $ \phi^* : \Omega_{C_2} \to \Omega_{C_1} $ is nonzero.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\lecture{9}{Wednesday}{28/10/20}

\begin{example*}
Let $ \GG_\m = \AA^1 \setminus \cbr{0} = \PP^1 \setminus \cbr{0, \infty} $ be the \textbf{multiplicative group} with group law
$$ \function{\GG_\m \times \GG_\m}{\GG_\m}{\br{x, y}}{xy}. $$
Let $ n \ge 1 $ be an integer, and let
$$ \function[\alpha]{\GG_\m}{\GG_\m}{x}{x^n}. $$
Then $ \alpha^*\br{\d x} = \d\br{x^n} = nx^{n - 1}\d x $. So if $ \ch K \nmid n $ then $ \alpha $ is separable. By Theorem \ref{thm:2.8}, $ \#\alpha^{-1}\br{Q} = \deg \alpha $ for all but finitely many $ Q \in \GG_\m $. Since $ \alpha $ is a group homomorphism, $ \#\alpha^{-1}\br{Q} = \#\ker \alpha $ for all $ Q \in \GG_\m $. Thus $ \#\ker \alpha = \deg \alpha = n $, that is $ K = \overline{K} $ contains exactly $ n $ distinct $ n $-th roots of unity.
\end{example*}

\begin{theorem}
\label{thm:6.5}
If $ \ch K \nmid n $ then $ E\sbr{n} \cong \br{\ZZ / n\ZZ}^2 $.
\end{theorem}

\begin{proof}
By Lemma \ref{lem:6.3} and induction, $ \sbr{n}^*\omega = n\omega $. So if $ \ch K \nmid n $, then $ \sbr{n} $ is separable. By Theorem \ref{thm:2.8}, $ \#\sbr{n}^{-1}Q = \deg \sbr{n} $ for all but finitely many $ Q \in E $. Since $ \sbr{n} $ is a group homomorphism, $ \#\sbr{n}^{-1}Q = \#E\sbr{n} $ for all $ Q \in E $, so $ \#E\sbr{n} = \deg \sbr{n} = n^2 $, by Corollary \ref{cor:5.8}. By group theory,
$$ E\sbr{n} \cong \ZZ / d_1\ZZ \times \dots \times \ZZ / d_t\ZZ, \qquad d_1 \mid \dots \mid d_t \mid n, $$
and $ \prod_{i = 1}^t d_i = n^2 $. If $ p $ is a prime with $ p \mid d_1 $ then $ E\sbr{p} \cong \br{\ZZ / p\ZZ}^t $. But $ \#E\sbr{p} = p^2 $, so $ t = 2 $. Then $ d_1 \mid d_2 \mid n $ and $ d_1d_2 = n^2 $, so $ d_1 = d_2 = n $.
\end{proof}

\begin{remark*}
Not to be used on example sheet. If $ \ch K = p $ then $ \sbr{p} $ is inseparable. It can be shown that either $ E\sbr{p^r} \cong \ZZ / p^r\ZZ $ for all $ r \ge 1 $, where $ E $ is \textbf{ordinary}, or $ E\sbr{p} = 0 $, where $ E $ is \textbf{supersingular}.
\end{remark*}

\pagebreak

\section{Elliptic curves over finite fields}

\subsection{Hasse's theorem}

Recall $ q\br{x} = \tfrac{1}{2}\abr{x, x} $.

\begin{lemma}
\label{lem:7.1}
Let $ A $ be an abelian group and $ q : A \to \ZZ $ a positive definite quadratic form. If $ x, y \in A $ then
$$ \abs{\abr{x, y}} = \abs{q\br{x + y} - q\br{x} - q\br{y}} \le 2\sqrt{q\br{x}q\br{y}}. $$
\end{lemma}

\begin{proof}
We may assume $ x \ne 0 $ otherwise the result is clear. Let $ m, n \in \ZZ $. Then
\begin{align*}
0
& \le q\br{mx + ny}
= \dfrac{1}{2}\abr{mx + ny, mx + ny}
= m^2q\br{x} + mn\abr{x, y} + n^2q\br{y} \\
& = q\br{x}\br{m + \dfrac{\abr{x, y}}{2q\br{x}}n}^2 + n^2\br{q\br{y} - \dfrac{\abr{x, y}^2}{4q\br{x}}}.
\end{align*}
Taking $ m = \abr{x, y} $ and $ n = -2q\br{x} \ne 0 $ we deduce $ \abr{x, y}^2 \le 4q\br{x}q\br{y} $, so $ \abs{\abr{x, y}} \le 2\sqrt{q\br{x}q\br{y}} $.
\end{proof}

Let $ \FF_q $ be the field with $ q $ elements, so $ q = p^m $ and $ \ch \FF_q = p $. Then $ \Gal\br{\FF_{q^r} / \FF_q} $ is cyclic of order $ r $ generated by the Frobenius map $ x \mapsto x^q $.

\begin{theorem}[Hasse]
Let $ E / \FF_q $ be an elliptic curve. Then
$$ \abs{\#E\br{\FF_q} - \br{q + 1}} \le 2\sqrt{q}. $$
\end{theorem}

\begin{proof}
Let $ E $ have a Weierstrass equation with coefficients $ a_1, \dots, a_6 \in \FF_q $, so $ a_i^q = a_i $. Define the Frobenius endomorphism
$$ \function[\phi]{E}{E}{\br{x, y}}{\br{x^q, y^q}}, $$
an isogeny of degree $ q $. Then $ E\br{\FF_q} = \cbr{P \in E \st \phi\br{P} = P} = \ker \br{1 - \phi} $, and
$$ \phi^*\omega = \phi^*\br{\dfrac{\d x}{y}} = \dfrac{\d\br{x^q}}{y^q} = \dfrac{qx^{q - 1}\d x}{y^q} = 0, $$
since $ q \equiv 0 \mod p $. By Lemma \ref{lem:6.3}, $ \br{1 - \phi}^*\omega = \omega - \phi^*\omega \ne 0 $, so $ 1 - \phi $ is separable. By Theorem \ref{thm:2.8} and the fact that $ 1 - \phi $ is a group homomorphism, $ \#\ker \br{1 - \phi} = \deg \br{1 - \phi} $, so $ \#E\br{\FF_q} = \deg \br{1 - \phi} $. By Theorem \ref{thm:5.6}, $ \deg : \End E = \Hom\br{E, E} \to \ZZ $ is a positive definite quadratic form. By Lemma \ref{lem:7.1}, $ \abs{\deg \br{1 - \phi} - 1 - \deg \phi} \le 2\sqrt{\deg \phi} $, so $ \abs{\#E\br{\FF_q} - \br{q + 1}} \le 2\sqrt{q} $.
\end{proof}

\subsection{Zeta functions}

For $ K $ a number field
$$ \zeta_K\br{s} = \sum_{\aaa \subset \OOO_K} \dfrac{1}{\br{\N\aaa}^s} = \prod_{\ppp \subset \OOO_K, \ \ppp \ \text{prime}} \br{1 - \dfrac{1}{\br{\N\ppp}^s}}^{-1}. $$
For $ K $ a \textbf{function field}, that is $ K = \FF_q\br{C} $ where $ C / \FF_q $ is a smooth projective curve,
$$ \zeta_K\br{s} = \prod_{x \in \abs{C}} \br{1 - \dfrac{1}{\br{\N x}^s}}^{-1}, $$
where $ \abs{C} $ are the \textbf{closed points} on $ C $, the orbits for the action of $ \Gal\br{\overline{\FF_q} / \FF_q} $ on $ C\br{\overline{\FF_q}} $, and $ \N x = q^{\deg x} $ where $ \deg x $ is the size of the orbit. We have $ \zeta_K\br{s} = F\br{q^{-s}} $ for some $ F \in \QQ\sbr{\sbr{T}} $, where
$$ F\br{T} = \prod_{x \in \abs{C}} \br{1 - T^{\deg x}}^{-1}. $$

\pagebreak

By $ -\log \br{1 - x} = x + \tfrac{1}{2}x^2 + \dots $,
$$ \log F\br{T} = \sum_{x \in \abs{C}} \sum_{m = 1}^\infty \dfrac{1}{m}T^{m\deg x}. $$
Then
$$ T\dod{}{T}\log F\br{T} = \sum_{x \in \abs{C}} \sum_{m = 1}^\infty \br{\deg x}T^{m\deg x} = \sum_{n = 1}^\infty \br{\sum_{x \in \abs{C}, \ \deg x \mid n} \deg x}T^n = \sum_{n = 1}^\infty \#C\br{\FF_{q^n}}T^n, $$
so
$$ F\br{T} = \exp \sum_{n = 1}^\infty \dfrac{\#C\br{\FF_{q^n}}}{n}T^n. $$

\lecture{10}{Friday}{30/10/20}

For $ \phi, \psi \in \Hom\br{E_1, E_2} $ we put
$$ \abr{\phi, \psi} = \deg \br{\phi + \psi} - \deg \phi - \deg \psi. $$
We define
$$ \function[\Tr]{\End E}{\ZZ}{\psi}{\abr{\psi, 1}}. $$

\begin{lemma}
\label{lem:7.3}
If $ \psi \in \End E $ then
$$ \psi^2 - \sbr{\Tr \psi}\psi + \sbr{\deg \psi} = 0. $$
\end{lemma}

\begin{proof}
See example sheet $ 2 $.
\end{proof}

\begin{definition*}
The \textbf{zeta function} of a variety $ V / \FF_q $ is
$$ \Z_V\br{T} = \exp \sum_{n = 1}^\infty \dfrac{\#V\br{\FF_{q^n}}}{n}T^n. $$
\end{definition*}

\begin{lemma}
Let $ E / \FF_q $ be an elliptic curve such that $ \#E\br{\FF_q} = q + 1 - a $. Then
$$ \Z_E\br{T} = \dfrac{1 - aT + qT^2}{\br{1 - T}\br{1 - qT}}. $$
\end{lemma}

\begin{proof}
Let $ \phi : E \to E $ be the $ q $-power Frobenius map. By the proof of Hasse's theorem $ \#E\br{\FF_q} = \deg \br{1 - \phi} $, so $ \Tr \phi = a $ and $ \deg \phi = q $. By Lemma \ref{lem:7.3}, $ \phi^2 - a\phi + q = 0 $, so $ \phi^{n + 2} - a\phi^{n + 1} + q\phi^n = 0 $ for all $ n \ge 0 $, so
$$ \Tr \phi^{n + 2} - a\Tr \phi^{n + 1} + q\Tr \phi^n = 0. $$
This second order difference equation with initial conditions $ \Tr 1 = 2 $ and $ \Tr \phi = a $ has solution $ \Tr \phi^n = \alpha^n + \beta^n $ where $ \alpha, \beta \in \CC $ are the roots of $ X^2 - aX + q = 0 $, so
$$ \#E\br{\FF_{q^n}} = \deg \br{1 - \phi^n} = 1 + \deg \phi^n - \Tr \phi^n = 1 + q^n - \alpha^n - \beta^n. $$
Thus
$$ \Z_E\br{T} = \exp \sum_{n = 1}^\infty \br{\dfrac{T^n}{n} + \dfrac{\br{qT}^n}{n} - \dfrac{\br{\alpha T}^n}{n} - \dfrac{\br{\beta T}^n}{n}} = \dfrac{\br{1 - \alpha T}\br{1 - \beta T}}{\br{1 - T}\br{1 - qT}} = \dfrac{1 - aT + qT^2}{\br{1 - T}\br{1 - qT}}, $$
using $ -\log \br{1 - x} = \sum_{n = 1}^\infty x^n / n $.
\end{proof}

\begin{remark*}
By Hasse's theorem, $ \abs{a} \le 2\sqrt{q} $. Then $ \alpha = \overline{\beta} $, so
\begin{equation}
\label{eq:7}
\abs{\alpha} = \abs{\beta} = \sqrt{q}.
\end{equation}
Let $ K = \FF_q\br{E} $. If $ \zeta_K\br{s} = 0 $, then $ \Z_E\br{q^{-s}} = 0 $, so $ q^s = \alpha, \beta $. Thus $ \Re s = \tfrac{1}{2} $ by $ \br{\ref{eq:7}} $.
\end{remark*}

\pagebreak

\section{Formal groups}

\subsection{Complete rings}

\begin{definition*}
Let $ R $ be a ring, and let $ I \subset R $ an ideal. The \textbf{$ I $-adic topology} is the topology on $ R $ with basis $ \cbr{r + I^n \st r \in R, \ n \ge 1} $.
\end{definition*}

\begin{definition*}
A sequence $ \br{x_n} $ in $ R $ is \textbf{Cauchy} if for all $ k $ there exists $ N $ such that $ x_m - x_n \in I^k $ for all $ m, n \ge N $.
\end{definition*}

\begin{definition*}
$ R $ is \textbf{complete} if
\begin{itemize}
\item $ \bigcap_{n \ge 0} I^n = \cbr{0} $, and
\item every Cauchy sequence converges.
\end{itemize}
\end{definition*}

\begin{remark*}
If $ x \in I $ then $ 1 / \br{1 - x} = 1 + x + \dots $, so $ 1 - x \in R^\times $.
\end{remark*}

\begin{example*}
\hfill
\begin{itemize}
\item $ R = \ZZ_p $ and $ I = p\ZZ_p $.
\item $ R = \ZZ\sbr{\sbr{t}} $ and $ I = \abr{t} $.
\end{itemize}
\end{example*}

\begin{lemma}[Hensel's lemma]
\label{lem:8.1}
Let $ R $ be an integral domain, complete with respect to an ideal $ I $. Let $ F \in R\sbr{X} $ and $ s \ge 1 $. Suppose $ a \in R $ satisfies $ F\br{a} \equiv 0 \mod I^s $ and $ F'\br{a} \in R^\times $. Then there exists a unique $ b \in R $ such that $ F\br{b} = 0 $ and $ b \equiv a \mod I^s $.
\end{lemma}

\begin{proof}
Let $ u \in R^\times $ with $ F'\br{a} \equiv u \mod I $, for example could take $ u = F'\br{a} $. Replacing $ F\br{X} $ by $ F\br{X + a} / u $ we may assume $ a = 0 $ and $ F'\br{0} \equiv 1 \mod I $. We put $ x_0 = 0 $ and
\begin{equation}
\label{eq:8}
x_{n + 1} = x_n - F\br{x_n}.
\end{equation}
By easy induction,
\begin{equation}
\label{eq:9}
x_n \equiv 0 \mod I^s.
\end{equation}
Then
\begin{equation}
\label{eq:10}
F\br{X} - F\br{Y} = \br{X - Y}\br{F'\br{0} + XG\br{X, Y} + YH\br{X, Y}}, \qquad G, H \in R\sbr{X, Y}.
\end{equation}
Claim that $ x_{n + 1} \equiv x_n \mod I^{n + s} $ for all $ n \ge 0 $. By induction on $ n $.
\begin{itemize}[leftmargin=0.5in]
\item[$ n = 0 $] Clear.
\item[$ n > 0 $] Suppose $ x_n \equiv x_{n - 1} \mod I^{n + s - 1} $. By $ \br{\ref{eq:10}} $, $ F\br{x_n} - F\br{x_{n - 1}} = \br{x_n - x_{n - 1}}\br{1 + c} $ for some $ c \in I $, so $ F\br{x_n} - F\br{x_{n - 1}} \equiv x_n - x_{n - 1} \mod I^{n + s} $. Then $ x_n - F\br{x_n} \equiv x_{n - 1} - F\br{x_{n - 1}} \mod I^{n + s} $, so $ x_{n + 1} \equiv x_n \mod I^{n + s} $.
\end{itemize}
This proves the claim, so $ \br{x_n}_{n \ge 0} $ is Cauchy. Since $ R $ is complete, $ x_n \to b $ as $ n \to \infty $, for some $ b \in R $. Taking the limit as $ n \to \infty $ in $ \br{\ref{eq:8}} $, $ b = b - F\br{b} $, so $ F\br{b} = 0 $. Taking the limit as $ n \to \infty $ in $ \br{\ref{eq:9}} $, $ b \equiv 0 \mod I^s $. Uniqueness is proved using $ \br{\ref{eq:10}} $ and the assumption $ R $ is an integral domain.
\end{proof}

\subsection{A nonstandard affine piece}

Let $ E $ be
$$ Y^2Z + a_1XYZ + a_3YZ^2 = X^3 + a_2X^2Z + a_4XZ^2 + a_6Z^3. $$
In the affine piece $ Y \ne 0 $, let $ t = -X / Y $ and $ w = -Z / Y $. Then
$$ w = f\br{t, w} = t^3 + a_1tw + a_2t^2w + a_3w^2 + a_4tw^2 + a_6w^3. $$
We apply Lemma \ref{lem:8.1} with
$$ R = \ZZ\sbr{a_1, \dots, a_6}\sbr{\sbr{t}}, \qquad I = \abr{t}, \qquad F\br{X} = X - f\br{t, X} \in R\sbr{X}, \qquad s = 3, \qquad a = 0. $$

\pagebreak

Check that $ F\br{0} = -f\br{t, 0} = -t^3 \equiv 0 \mod I^3 $ and $ F'\br{0} = 1 - a_1t - a_2t^2 \in R^\times $. Thus there exists a unique $ w\br{t} \in \ZZ\sbr{a_1, \dots, a_6}\sbr{\sbr{t}} $ such that $ w\br{t} = f\br{t, w\br{t}} $ and $ w\br{t} \equiv 0 \mod t^3 $. Following the proof of Lemma \ref{lem:8.1} with $ u = 1 $ gives
$$ w\br{t} = \lim_{n \to \infty} w_n\br{t}, \qquad
\begin{cases}
w_0\br{t} = 0 \\
w_{n + 1}\br{t} = f\br{t, w_n\br{t}}
\end{cases}.
$$

\lecture{11}{Monday}{02/11/20}

In fact $ w\br{t} = t^3\br{1 + A_1t + A_2t^2 + A_3t^3 + A_4t^4 + \dots} $, where
$$ A_1 = a_1, \qquad A_2 = a_1^2 + a_2, \qquad A_3 = a_1^3 + 2a_1a_2 + a_3, \qquad A_4 = a_1^4 + 3a_1^2a_2 + 3a_1a_3 + a_2^2 + a_4, \qquad \dots. $$

\begin{lemma}
\label{lem:8.2}
Let $ R $ be an integral domain, complete with respect to an ideal $ I $, let $ a_1, \dots, a_6 \in R $, and let $ K = \Frac R $. Then
$$ \widehat{E}\br{I} = \cbr{\br{t, w} \in E\br{K} \st t, w \in I} = \cbr{\br{t, w\br{t}} \in E\br{K} \st t \in I} $$
is a subgroup of $ E\br{K} $.
\end{lemma}

\begin{proof}
The two descriptions of $ \widehat{E}\br{I} $ agree, since given $ t \in I $, Hensel's lemma shows there exists a unique $ w \in I $ such that $ \br{t, w} \in I $. Taking $ \br{t, w} = \br{0, 0} $ shows $ \OOO_E \in \widehat{E}\br{I} $. So it suffices to show that if $ P_1, P_2 \in \widehat{E}\br{I} $ then $ P_3 = -P_1 - P_2 \in \widehat{E}\br{I} $. Let $ w = \lambda t + \nu $ be the line through $ P_1 = \br{t_1, w_1} $, $ P_2 = \br{t_2, w_2} $, and $ P_3 = \br{t_3, w_3} $. Then
$$ w\br{t} = \sum_{n = 2}^\infty A_{n - 2}t^{n + 1}, \qquad \lambda =
\begin{cases}
\dfrac{w\br{t_2} - w\br{t_1}}{t_2 - t_1} & t_1 \ne t_2 \\
w'\br{t_1} & t_1 = t_2
\end{cases},
$$
where $ A_0 = 1 $. If $ P_1, P_2 \in \widehat{E}\br{I} $, then $ t_1, t_2 \in I $, so
$$ \lambda = \sum_{n = 2}^\infty A_{n - 2}\br{t_1^n + t_1^{n - 1}t_2 + \dots + t_1t_2^{n - 1} + t_2^n} \in I, \qquad \nu = w_1 - \lambda t_1 \in I. $$
Substituting $ w = \lambda t + \nu $ into $ w = f\br{t, w} $ gives
$$ \lambda t + \nu = t^3 + a_1t\br{\lambda t + \nu} + a_2t^2\br{\lambda t + \nu} + a_3\br{\lambda t + \nu}^2 + a_4t\br{\lambda t + \nu}^2 + a_6\br{\lambda t + \nu}^3. $$
Let
$$ A = 1 + a_2\lambda + a_4\lambda^2 + a_6\lambda^3 $$
be the coefficient of $ t^3 $, and let
$$ B = a_1\lambda + a_2\nu + a_3\lambda^2 + 2a_4\lambda\nu + 3a_6\lambda^2\nu $$
be the coefficient of $ t^2 $. We have $ A \in R^\times $ and $ B \in I $, so $ t_3 = -B / A - t_1 - t_2 \in I $ and $ w_3 = \lambda t_3 + \nu \in I $.
\end{proof}

Taking $ R = \ZZ\sbr{a_1, \dots, a_6}\sbr{\sbr{t}} $ and $ I = \abr{t} $, by Lemma \ref{lem:8.2}, there exists $ \iota \in \ZZ\sbr{a_1, \dots, a_6}\sbr{\sbr{t}} $ with $ \iota\br{0} = 0 $ such that
$$ \sbr{-1}\br{t, w\br{t}} = \br{\iota\br{t}, w\br{\iota\br{t}}}. $$
Taking $ R = \ZZ\sbr{a_1, \dots, a_6}\sbr{\sbr{t_1, t_2}} $ and $ I = \abr{t_1, t_2} $ there exists $ F \in \ZZ\sbr{a_1, \dots, a_6}\sbr{\sbr{t_1, t_2}} $ with $ F\br{0, 0} = 0 $ such that
$$ \br{t_1, w\br{t_1}} + \br{t_2, w\br{t_2}} = \br{F\br{t_1, t_2}, w\br{F\br{t_1, t_2}}}. $$
In fact
$$ \iota\br{X} = -X - a_1X^2 - a_2X^3 - \br{a_1^3 + a_3}X^4 + \dots, \qquad F\br{X, Y} = X + Y - a_1XY - a_2\br{X^2Y + XY^2} + \dots. $$

\pagebreak

By properties of the group law we deduce
\begin{enumerate}
\item $ F\br{X, Y} = F\br{Y, X} $,
\item $ F\br{X, 0} = X $ and $ F\br{0, Y} = Y $,
\item $ F\br{X, F\br{Y, Z}} = F\br{F\br{X, Y}, Z} $, and
\item $ F\br{X, \iota\br{X}} = 0 $.
\end{enumerate}

\subsection{Formal groups}

\begin{definition*}
Let $ R $ be a ring. A \textbf{formal group} over $ R $ is a power series $ F\br{X, Y} \in R\sbr{\sbr{X, Y}} $ satisfying $ 1 $, $ 2 $, and $ 3 $.
\end{definition*}

\begin{exercise*}
Show that for any formal group there exists a unique $ \iota\br{X} = -X + \dots \in R\sbr{\sbr{X}} $ such that $ F\br{X, \iota\br{X}} = 0 $.
\end{exercise*}

\begin{example*}
\hfill
\begin{itemize}
\item $ F\br{X, Y} = X + Y $ is $ \widehat{\GG_\a} $.
\item $ F\br{X, Y} = X + Y + XY = \br{1 + X}\br{1 + Y} - 1 $ is $ \widehat{\GG_\m} $.
\item $ F $ as above is $ \widehat{E} $.
\end{itemize}
\end{example*}

\begin{definition*}
Let $ \FFF $ and $ \GGG $ be formal groups over $ R $ given by power series $ F $ and $ G $.
\begin{itemize}
\item A \textbf{morphism} $ f : \FFF \to \GGG $ is a power series $ f \in R\sbr{\sbr{T}} $ such that $ f\br{0} = 0 $ satisfying $ f\br{F\br{X, Y}} = G\br{f\br{X}, f\br{Y}} $.
\item $ \FFF \cong \GGG $ if there exist $ f : \FFF \to \GGG $ and $ g : \GGG \to \FFF $ morphisms such that $ f\br{g\br{X}} = g\br{f\br{X}} = X $.
\end{itemize}
\end{definition*}

\begin{theorem}
\label{thm:8.3}
If $ \ch R = 0 $ then any formal group $ \FFF $ over $ R $ is isomorphic to $ \widehat{\GG_\a} $ over $ R \otimes \QQ $. More precisely
\begin{enumerate}
\item there is a unique power series
$$ \log T = T + \dfrac{a_2}{2}T^2 + \dfrac{a_3}{3}T^3 + \dots, \qquad a_i \in R, $$
such that
\begin{equation}
\label{eq:11}
\log F\br{X, Y} = \log X + \log Y,
\end{equation}
\item there is a unique power series
$$ \exp T = T + \dfrac{b_2}{2!}T^2 + \dfrac{b_3}{3!}T^3 + \dots, \qquad b_i \in R, $$
such that $ \exp \log T = \log \exp T = T $.
\end{enumerate}
\end{theorem}

\lecture{12}{Wednesday}{04/11/20}

We use the following.

\begin{lemma}
\label{lem:8.4}
Let $ f\br{T} = aT + \dots \in R\sbr{\sbr{T}} $ with $ a \in R^\times $. Then there exists a unique $ g\br{T} = a^{-1}T + \dots \in R\sbr{\sbr{T}} $ such that $ f\br{g\br{T}} = g\br{f\br{T}} = T $.
\end{lemma}

\begin{proof}
We construct polynomials $ g_n\br{T} \in R\sbr{T} $ such that
$$ f\br{g_n\br{T}} \equiv T \mod T^{n + 1}, \qquad g_{n + 1}\br{T} \equiv g_n\br{T} \mod T^{n + 1}. $$
Then $ g\br{T} = \lim_{n \to \infty} g_n\br{T} $ satisfies $ f\br{g\br{T}} = T $. To start the induction set $ g_1\br{T} = a^{-1}T $. Now suppose $ n \ge 2 $ and $ g_{n - 1}\br{T} $ exists, so $ f\br{g_{n - 1}\br{T}} \equiv T + bT^n \mod T^{n + 1} $. We put $ g_n\br{T} = g_{n - 1}\br{T} + \lambda T^n $ for $ \lambda \in R $ to be chosen later. Then
$$ f\br{g_n\br{T}} = f\br{g_{n - 1}\br{T} + \lambda T^n} \equiv f\br{g_{n - 1}\br{T}} + \lambda aT^n \equiv T + \br{b + \lambda a}T^n \mod T^{n + 1}. $$
We take $ \lambda = -b / a $, using again that $ a \in R^\times $. We get $ g\br{T} = a^{-1}T + \dots \in R\sbr{\sbr{T}} $ such that $ f\br{g\br{T}} = T $. Applying the same argument to $ g $ gives $ h\br{T} = aT + \dots \in R\sbr{\sbr{T}} $ such that $ g\br{h\br{T}} = T $. Then $ f\br{T} = f\br{g\br{h\br{T}}} = h\br{T} $.
\end{proof}

\pagebreak

\begin{proof}[Proof of Theorem \ref{thm:8.3}]
\hfill
\begin{enumerate}
\item The notation is $ F_1\br{X, Y} = \tpd{F}{X}\br{X, Y} $.
\begin{itemize}
\item Uniqueness. Let
$$ p\br{T} = \dod{}{T}\br{\log T} = 1 + a_2T + a_3T^2 + \dots. $$
Differentiating $ \br{\ref{eq:11}} $ with respect to $ X $ gives
$$ p\br{F\br{X, Y}}F_1\br{X, Y} = p\br{X} + 0. $$
Putting $ X = 0 $ gives
$$ p\br{Y}F_1\br{0, Y} = 1. $$
Then $ p\br{Y} = F_1\br{0, Y}^{-1} $, so $ p $, and hence $ \log $, is unique.
\item Existence. Let $ p\br{T} = F_1\br{0, T}^{-1} = 1 + a_2T + a_3T^2 + \dots $ for some $ a_i \in R $. Let
$$ \log T = T + \dfrac{a_2}{2}T^2 + \dfrac{a_3}{3}T^3 + \dots. $$
Differentiating $ F\br{F\br{X, Y}, Z} = F\br{X, F\br{Y, Z}} $ with respect to $ X $,
$$ F_1\br{F\br{X, Y}, Z}F_1\br{X, Y} = F_1\br{X, F\br{Y, Z}}. $$
Putting $ X = 0 $,
$$ F_1\br{Y, Z}F_1\br{0, Y} = F_1\br{0, F\br{Y, Z}}. $$
Then $ F_1\br{Y, Z}p\br{Y}^{-1} = p\br{F\br{Y, Z}}^{-1} $, so $ F_1\br{Y, Z}p\br{F\br{Y, Z}} = p\br{Y} $. Integrating with respect to $ Y $,
$$ \log F\br{Y, Z} = \log Y + h\br{Z}, $$
for some power series $ h $. By symmetry of $ Y $ and $ Z $ we see $ h\br{Z} = \log Z $.
\end{itemize}
\item Theorem \ref{thm:8.3}.$ 2 $ now follows from Lemma \ref{lem:8.4}, except for showing $ b_n \in R $, not just in $ R \otimes \QQ $. See example sheet $ 2 $.
\end{enumerate}
\end{proof}

\begin{notation*}
Let $ \FFF $, such as $ \widehat{\GG_\a}, \widehat{\GG_\m}, \widehat{E} $, be a formal group, given by $ F \in R\sbr{\sbr{X, Y}} $. Suppose $ R $ is complete with respect to an ideal $ I $. For $ x, y \in I $ put $ x \oplus_\FFF y = F\br{x, y} \in I $. Then $ \FFF\br{I} = \br{I, \oplus_\FFF} $ is an abelian group.
\end{notation*}

\begin{example*}
\hfill
\begin{itemize}
\item $ \widehat{\GG_\a}\br{I} = \br{I, +} $.
\item $ \widehat{\GG_\m}\br{I} = \br{1 + I, \times} $.
\item By Lemma \ref{lem:8.2} $ \widehat{E}\br{I} \subset E\br{K} $, which explains the earlier notation.
\end{itemize}
\end{example*}

\begin{corollary}
\label{cor:8.5}
Let $ \FFF $ be a formal group over $ R $, and $ n \in \ZZ $. Suppose $ n \in R^\times $. Then
\begin{itemize}
\item $ \sbr{n} : \FFF \to \FFF $ is an isomorphism, and
\item If $ R $ is complete with respect to an ideal $ I $ then $ \cdot n : \FFF\br{I} \to \FFF\br{I} $ is an isomorphism.
\end{itemize}
In particular $ \FFF\br{I} $ has no $ n $-torsion.
\end{corollary}

\begin{proof}
We have $ \sbr{1}\br{T} = T $ and $ \sbr{n}\br{T} = F\br{\sbr{n - 1}T, T} $ for all $ n \ge 2 $. For $ n < 0 $ use $ \sbr{-1}\br{T} = \iota\br{T} $. By induction, $ \sbr{n}\br{T} = nT + \dots \in R\sbr{\sbr{T}} $. Lemma \ref{lem:8.4} shows that if $ n \in R^\times $ then $ \sbr{n} $ is an isomorphism.
\end{proof}

\pagebreak

\section{Elliptic curves over local fields}

Let $ K $ be a field, complete with respect to a discrete valuation $ v : K^* \to \ZZ $. The \textbf{valuation ring}, or \textbf{ring of integers}, is
$$ \OOO_K = \cbr{x \in K^* \st v\br{x} \ge 0} \cup \cbr{0}. $$
with unit group $ \OOO_K^\times $ where $ v\br{x} = 0 $ and maximal ideal $ \pi\OOO_K $ where $ v\br{\pi} = 1 $. The residue field is $ \kappa = \OOO_K / \pi\OOO_K $. We assume $ \ch K = 0 $ and $ \ch \kappa = p $.

\begin{example*}
$ K = \QQ_p $, $ \OOO_K = \ZZ_p $, and $ \kappa = \FF_p $.
\end{example*}

\subsection{Integral Weierstrass equations}

Let $ E / K $ be an elliptic curve.

\begin{definition*}
A Weierstrass equation for $ E $ with coefficients $ a_1, \dots, a_6 \in K $ is \textbf{integral} if $ a_1, \dots, a_6 \in \OOO_K $, and \textbf{minimal} if $ v\br{\Delta} $ is minimal among all integral Weierstrass equations for $ E $.
\end{definition*}

\begin{remark*}
\hfill
\begin{itemize}
\item Putting $ x = u^2x' $ and $ y = u^3y' $ gives $ a_i = u^ia_i' $, so integral Weierstrass equations exist.
\item If $ a_1, \dots, a_6 \in \OOO_K $, then $ \Delta \in \OOO_K $, so $ v\br{\Delta} \ge 0 $, so minimal Weierstrass equations exist.
\item If $ \ch \kappa \ne 2, 3 $ then there exists a minimal Weierstrass equation of the form $ y^2 = x^3 + ax + b $.
\end{itemize}
\end{remark*}

\begin{lemma}
\label{lem:9.1}
Let $ E / K $ have an integral Weierstrass equation
$$ y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6. $$
Let $ \OOO \ne P = \br{x, y} \in E\br{K} $. Then either $ x, y \in \OOO_K $ or $ v\br{x} = -2s $ and $ v\br{y} = -3s $ for some $ s \ge 1 $.
\end{lemma}

Compare to example sheet $ 1 $, question $ 5 $.

\begin{proof}
\hfill
\begin{itemize}[leftmargin=0.5in]
\item[$ v\br{x} \ge 0 $.] If $ v\br{y} < 0 $ then $ v\br{\text{LHS}} < 0 $ and $ v\br{\text{RHS}} \ge 0 $, a contradiction, so $ x, y \in \OOO_K $.
\item[$ v\br{x} < 0 $.] $ v\br{\text{LHS}} \ge \min\br{2v\br{y}, v\br{x} + v\br{y}, v\br{y}} $ and $ v\br{\text{RHS}} = 3v\br{x} $, so $ v\br{y} < v\br{x} $. But $ v\br{\text{LHS}} = 2v\br{y} $. Thus $ 3v\br{x} = 2v\br{y} $, so $ v\br{x} = -2s $ and $ v\br{y} = -3s $ for some $ s \ge 1 $.
\end{itemize}
\end{proof}

\subsection{A filtration of formal groups}

Since $ K $ complete, $ \OOO_K $ is complete with respect to the ideal $ \pi^r\OOO_K $, for any $ r \ge 1 $. Fix a minimal Weierstrass equation for $ E / K $, which gives a formal group $ \widehat{E} $ over $ \OOO_K $. Taking $ I = \pi^r\OOO_K $ in Lemma \ref{lem:8.2}
\begin{align*}
\widehat{E}\br{\pi^r\OOO_K}
& = \cbr{\br{x, y} \in E\br{K} \st -\dfrac{x}{y}, -\dfrac{1}{y} \in \pi^r\OOO_K} \cup \cbr{\OOO} \\
& = \cbr{\br{x, y} \in E\br{K} \st v\br{\dfrac{x}{y}} \ge r, \ v\br{\dfrac{1}{y}} \ge r} \cup \cbr{\OOO} \\
& = \cbr{\br{x, y} \in E\br{K} \st \exists s \ge r, \ v\br{x} = -2s, \ v\br{y} = -3s} \cup \cbr{\OOO} \\
& = \cbr{\br{x, y} \in E\br{K} \st v\br{x} \le -2r, \ v\br{y} \le -3r} \cup \cbr{\OOO},
\end{align*}
using Lemma \ref{lem:9.1}. By Lemma \ref{lem:8.2} this is a subgroup of $ E\br{K} $, say $ E_r\br{K} $, so
$$ \dots \subset E_2\br{K} \subset E_1\br{K}. $$
More generally for $ \FFF $ a formal group over $ \OOO_K $
$$ \dots \subset \FFF\br{\pi^2\OOO_K} \subset \FFF\br{\pi\OOO_K}. $$

\pagebreak

We show that $ \FFF\br{\pi^r\OOO_K} \cong \br{\OOO_K, +} $ for $ r $ sufficiently large and $ \FFF\br{\pi^r\OOO_K} / \FFF\br{\pi^{r + 1}\OOO_K} \cong \br{\kappa, +} $ for all $ r \ge 1 $.

\lecture{13}{Friday}{06/11/20}

\begin{theorem}
\label{thm:9.2}
Let $ \FFF $ be a formal group over $ \OOO_K $. Let $ e = v\br{p} $. If $ r > e / \br{p - 1} $ then $ \log : \FFF\br{\pi^r\OOO_K} \xrightarrow{\sim} \widehat{\GG_\a}\br{\pi^r\OOO_K} $ is an isomorphism with inverse $ \exp : \widehat{\GG_\a}\br{\pi^r\OOO_K} \xrightarrow{\sim} \FFF\br{\pi^r\OOO_K} $.
\end{theorem}

\begin{remark*}
$ \widehat{\GG_\a}\br{\pi^r\OOO_K} = \br{\pi^r\OOO_K, +} \cong \br{\OOO_K, +} $.
\end{remark*}

\begin{proof}
For $ x \in \pi^r\OOO_K $ we must check the power series $ \exp x $ and $ \log x $ converge. Recall $ \exp T = T + \br{b_2 / 2!}T^2 + \br{b_3 / 3!}T^3 + \dots $ for $ b_i \in \OOO_K $. Claim that $ \v_p\br{n!} \le \br{n - 1} / \br{p - 1} $, since
$$ \v_p\br{n!} = \sum_{r = 1}^\infty \fbr{\dfrac{n}{p^r}} < \sum_{r = 1}^\infty \dfrac{n}{p^r} = n\br{\dfrac{\tfrac{1}{p}}{1 - \tfrac{1}{p}}} = \dfrac{n}{p - 1}, $$
so $ \br{p - 1}\v_p\br{n!} < n $, so $ \br{p - 1}\v_p\br{n!} \le n - 1 $, since the left hand side is in $ \ZZ $. Now
$$ v\br{\dfrac{b_nx^n}{n!}} \ge nr - e\br{\dfrac{n - 1}{p - 1}} = \br{n - 1}\br{r - \dfrac{e}{p - 1}} + r. $$
This is always at least $ r $ and tends to infinity as $ n \to \infty $, so $ \exp x $ converges and belongs to $ \pi^r\OOO_K $. The same method works for $ \log $.
\end{proof}

\begin{lemma}
We have $ \FFF\br{\pi^r\OOO_K} / \FFF\br{\pi^{r + 1}\OOO_K} \cong \br{\kappa, +} $ for all $ r \ge 1 $.
\end{lemma}

\begin{proof}
By definition of formal groups $ F\br{X, Y} = X + Y + XY\br{\dots} $. So if $ x, y \in \OOO_K $ then $ F\br{\pi^rx, \pi^ry} \equiv \pi^r\br{x + y} \mod \pi^{r + 1} $. Therefore
$$ \function{\FFF\br{\pi^r\OOO_K}}{\br{\kappa, +}}{\pi^rx}{x \mod \pi} $$
is a surjective group homomorphism, with kernel $ \FFF\br{\pi^{r + 1}\OOO_K} $.
\end{proof}

Thus for $ r > e / \br{p - 1} $,
$$ \br{\OOO_K, +} \cong \FFF\br{\pi^r\OOO_K} \subset \dots \subset \FFF\br{\pi^2\OOO_K} \subset \FFF\br{\pi\OOO_K}, $$
where the quotients are isomorphic to $ \br{\kappa, +} $, so if $ \abs{\kappa} < \infty $ then $ \FFF\br{\pi\OOO_K} $ has a subgroup of finite index isomorphic to $ \br{\OOO_K, +} $.

\subsection{Reduction modulo \texorpdfstring{$ \pi $}{p}}

\begin{notation*}
\textbf{Reduction modulo $ \pi $} is
$$ \function{\OOO_K}{\OOO_K / \pi\OOO_K = \kappa}{x}{\widetilde{x}}. $$
\end{notation*}

\begin{proposition}
Let $ E / K $ be an elliptic curve. The reduction modulo $ \pi $ of any two minimal Weierstrass equations for $ E $ define isomorphic curves over $ \kappa $.
\end{proposition}

\begin{proof}
Say Weierstrass equations are related by $ \sbr{u; r, s, t} $ for $ u \in K^* $ and $ r, s, t \in K $. Then $ \Delta_1 = u^{12}\Delta_2 $. Since both equations are minimal, $ v\br{\Delta_1} = v\br{\Delta_2} $, so $ u \in \OOO_K^\times $. By the transformation formulae for $ a_i $ and $ b_i $ and since $ \OOO_K $ is integrally closed, $ r, s, t \in \OOO_K $. The Weierstrass equations for the reduction modulo $ \pi $ are related by $ \sbr{\widetilde{u}; \widetilde{r}, \widetilde{s}, \widetilde{t}} $ for $ \widetilde{u} \in \kappa^* $ and $ \widetilde{r}, \widetilde{s}, \widetilde{t} \in \kappa $.
\end{proof}

\begin{definition*}
The \textbf{reduction} $ \widetilde{E} / \kappa $ of $ E / K $ is defined by the reduction of a minimal Weierstrass equation. Then $ E $ has \textbf{good reduction} if $ \widetilde{E} $ is nonsingular, and so an elliptic curve, otherwise it has \textbf{bad reduction}.
\end{definition*}

For an integral Weierstrass equation
\begin{itemize}
\item if $ v\br{\Delta} = 0 $, then good reduction,
\item if $ 0 < v\br{\Delta} < 12 $, then bad reduction, and
\item if $ v\br{\Delta} \ge 12 $, then beware the equation might not be minimal.
\end{itemize}

\pagebreak

There is a well-defined map
$$ \function{\PP^2\br{K}}{\PP^2\br{\kappa}}{\br{x : y : z}}{\br{\widetilde{x} : \widetilde{y} : \widetilde{z}}}, $$
choosing the representative of $ \br{x : y : z} $ with $ \min\br{v\br{x}, v\br{y}, v\br{z}} = 0 $. We restrict to give
$$ \function{E\br{K}}{\widetilde{E}\br{\kappa}}{P}{\widetilde{P}}. $$
If $ P = \br{x, y} \in E\br{K} $ then by Lemma \ref{lem:9.1} either $ x, y \in \OOO_K $, so $ \widetilde{P} = \br{\widetilde{x}, \widetilde{y}} $, or $ v\br{x} = -2s $ and $ v\br{y} = -3s $, so $ P = \br{\pi^{3s}x : \pi^{3s}y : \pi^{3s}} $ and $ \widetilde{P} = \br{0 : 1 : 0} $. Thus
$$ \widehat{E}\br{\pi\OOO_K} = E_1\br{K} = \cbr{P \in E\br{K} \st \widetilde{P} = \OOO}, $$
the \textbf{kernel of reduction}. Let
$$ \widetilde{E}_{\ns} =
\begin{cases}
\widetilde{E} & E \ \text{has good reduction} \\
\widetilde{E} \setminus \cbr{\text{singular point}} & E \ \text{has bad reduction}
\end{cases}.
$$
The chord and tangent process still defines a group law on $ \widetilde{E}_{\ns} $. In cases of bad reduction
\begin{itemize}
\item $ \widetilde{E}_{\ns} \cong \GG_\a $, an \textbf{additive reduction}, or
\item $ \widetilde{E}_{\ns} \cong \GG_\m $, a \textbf{multiplicative reduction}.
\end{itemize}
The isomorphism is over $ \kappa $, or possibly a quadratic extension of $ \kappa $. For simplicity suppose $ \ch \kappa \ne 2 $. Then $ \widetilde{E} $ is $ y^2 = f\br{x} $ for $ \deg f = 3 $, so $ \widetilde{E} $ is singular if and only if $ f $ has a repeated root.
\begin{itemize}
\item A double root gives a curve $ y^2 = x^2\br{x + 1} $ with a \textbf{node}, which leads to multiplicative reduction. See example sheet $ 3 $.
\item A triple root gives a curve $ y^2 = x^3 $ with a \textbf{cusp}, which leads to additive reduction. Let
$$ \bijection{\widetilde{E}_{\ns}}{\GG_\a}{\br{x, y}}{\dfrac{x}{y}}{\br{\dfrac{1}{t^2}, \dfrac{1}{t^3}}}{t}. $$
We check this is a group homomorphism. Let $ P_1, P_2, P_3 $ lie on the line $ ax + by = 1 $. Write $ P_i = \br{x_i, y_i} $ and $ t_i = x_i / y_i $. Then $ x_i^3 = y_i^2 = y_i^2\br{ax_i + by_i} $, so $ t_1, t_2, t_3 $ are the roots of $ X^3 - aX - b = 0 $. Looking at the coefficient of $ X^2 $ gives $ t_1 + t_2 + t_3 = 0 $.
\end{itemize}

\subsection{The subgroup of nonsingular reduction}

\lecture{14}{Monday}{09/11/20}

\begin{definition*}
$$ E_0\br{K} = \cbr{P \in E\br{K} \st \widetilde{P} \in \widetilde{E}_{\ns}\br{\kappa}}. $$
\end{definition*}

\begin{proposition}
\label{prop:9.5}
$ E_0\br{K} $ is a subgroup of $ E\br{K} $, and reduction modulo $ \pi $ is a surjective group homomorphism $ E_0\br{K} \to \widetilde{E}_{\ns}\br{\kappa} $.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item A line $ l $ in $ \PP^2 $ defined over $ K $ has equation $ aX + bY + cZ = 0 $ for $ a, b, c \in K $. We may assume $ \min\br{v\br{a}, v\br{b}, v\br{c}} = 0 $. Reduction modulo $ \pi $ gives the line $ \widetilde{l} $, $ \widetilde{a}X + \widetilde{b}Y + \widetilde{c}Z = 0 $. If $ P_1, P_2, P_3 \in E\br{K} $ with $ P_1 + P_2 + P_3 = \OOO $ then these points lie on a line $ l $, so $ \widetilde{P_1}, \widetilde{P_2}, \widetilde{P_3} \in \widetilde{E}\br{\kappa} $ lie on the line $ \widetilde{l} $. If $ \widetilde{P_1}, \widetilde{P_2} \in \widetilde{E}_{\ns}\br{\kappa} $ then $ \widetilde{P_3} \in \widetilde{E}_{\ns}\br{\kappa} $. So if $ P_1, P_2 \in E_0\br{K} $ then $ P_3 \in E_0\br{K} $ and $ \widetilde{P_1} + \widetilde{P_2} + \widetilde{P_3} = \OOO $. Check this still works if $ \#\cbr{\widetilde{P_1}, \widetilde{P_2}, \widetilde{P_3}} < 3 $. \footnote{Exercise}

\pagebreak

\item For surjectivity, let
$$ f\br{x, y} = y^2 + a_1xy + a_3y - \br{x^3 + a_2x^2 + a_4x + a_6}. $$
Let $ \widetilde{P} \in \widetilde{E}_{\ns}\br{\kappa} \setminus \cbr{\OOO} $ say $ \widetilde{P} = \br{\widetilde{x_0}, \widetilde{y_0}} $ for some $ x_0, y_0 \in \OOO_K $. Since $ \widetilde{P} $ is nonsingular, either
\begin{enumerate}
\item $ \tpd{f}{x}\br{x_0, y_0} \not\equiv 0 \mod \pi $, or
\item $ \tpd{f}{y}\br{x_0, y_0} \not\equiv 0 \mod \pi $.
\end{enumerate}
If $ 1 $ we put $ g\br{t} = f\br{t, y_0} \in \OOO_K\sbr{t} $. Then $ g\br{x_0} \equiv 0 \mod \pi $ and $ g'\br{x_0} \in \OOO_K^\times $. By Hensel's lemma, there exists $ b \in \OOO_K $ such that $ g\br{b} = 0 $ and $ b \equiv x_0 \mod \pi $. Then $ P = \br{b, y_0} \in E\br{K} $ has reduction $ \widetilde{P} $. Case $ 2 $ is similar.
\end{itemize}
\end{proof}

Recall for $ r \ge 1 $ we have
$$ E_r\br{K} = \cbr{\br{x, y} \in E\br{K} \st v\br{x} \le -2r, \ v\br{y} \le -3r} \cup \cbr{\OOO}. $$
If $ r > e / \br{p - 1} $,
$$
\begin{tikzcd}[column sep=small, row sep=tiny]
E_r\br{K} \arrow[subset]{r} \arrow[cong]{d} & \dots \arrow[subset]{r} & E_2\br{K} \arrow[cong]{d} & \subset \arrow[dash]{dd}{\cdot / \cdot} & E_1\br{K} \arrow[cong]{d} & \subset \arrow[dash]{dd}{\cdot / \cdot} & E_0\br{K} & \subset \arrow[dash]{dd}{\cdot / \cdot} & E\br{K}, \\
\br{\OOO_K, +} & & \widehat{E}\br{\pi^2\OOO_K} & & \widehat{E}\br{\pi\OOO_K} & & & & \\
& & & \br{\kappa, +} & & \widetilde{E}_{\ns}\br{\kappa} & & ? &
\end{tikzcd}.
$$

\begin{lemma}
\label{lem:9.6}
If $ \abs{\kappa} < \infty $ then $ E_0\br{K} \subset E\br{K} $ has finite index.
\end{lemma}

The proof is a compactness argument. See below.

\begin{theorem}
\label{thm:9.7}
If $ \sbr{K : \QQ_p} < \infty $ then $ E\br{K} $ contains a subgroup of finite index isomorphic to $ \br{\OOO_K, +} $.
\end{theorem}

\begin{proof}
$ \abs{\kappa} < \infty $, so this follows from the above.
\end{proof}

\begin{lemma}
If $ \abs{\kappa} < \infty $ then $ \PP^n\br{K} $ is compact, with respect to the $ \pi $-adic topology.
\end{lemma}

\begin{proof}
Since $ \abs{\kappa} < \infty $, $ \OOO_K / \pi^r\OOO_K $ is finite for all $ r \ge 1 $, so
$$ \OOO_K \xrightarrow{\sim} \varprojlim_r \OOO_K / \pi^r\OOO_K $$
is compact. Then $ \PP^n\br{K} $ is the union of compact sets
$$ \cbr{\br{a_0 : \dots : a_{i - 1} : 1 : a_{i + 1} : \dots : a_n} \st a_j \in \OOO_K}, $$
and hence compact.
\end{proof}

\begin{proof}[Proof of Lemma \ref{lem:9.6}]
$ E\br{K} \subset \PP^2\br{K} $ is closed subset, so $ \br{E\br{K}, +} $ is a compact topological group. If $ \widetilde{E} $ has singular point $ \br{\widetilde{x_0}, \widetilde{y_0}} $ then
$$ E\br{K} \setminus E_0\br{K} = \cbr{\br{x, y} \in E\br{K} \st v\br{x - x_0} \ge 1, \ v\br{y - y_0} \ge 1} $$
is a closed subset of $ E\br{K} $, so $ E_0\br{K} $ is an open subgroup of $ E\br{K} $. The cosets of $ E_0\br{K} $ are an open cover of $ E\br{K} $, so $ \sbr{E\br{K} : E_0\br{K}} < \infty $.
\end{proof}

The \textbf{Tamagawa number} is
$$ \c_K\br{E} = \sbr{E\br{K} : E_0\br{K}}. $$

\begin{remark*}
\hfill
\begin{itemize}
\item If good reduction, then $ \c_K\br{E} = 1 $, but the converse is false.
\item It can be shown that either $ \c_K\br{E} = v\br{\Delta} $ or $ \c_K\br{E} \le 4 $. Essential we work with a minimal Weierstrass equation.
\end{itemize}
\end{remark*}

\pagebreak

\subsection{Unramified extensions of local fields}

Let $ \sbr{K : \QQ_p} < \infty $ and let $ L / K $ be a finite extension with residue fields $ \kappa' $ and $ \kappa $. Let $ f = \sbr{\kappa' : \kappa} $. Then
$$
\begin{tikzcd}
K^* \arrow[twoheadrightarrow]{r}{\v_K} \arrow[subset]{d} & \ZZ \arrow{d}{\cdot e} \\
L^* \arrow[twoheadrightarrow]{r}[swap]{\v_L} & \ZZ
\end{tikzcd}.
$$

\begin{fact*}
$ \sbr{L : K} = ef $. If $ L / K $ is Galois then there is a natural group homomorphism $ \Gal\br{L / K} \to \Gal\br{\kappa' / \kappa} $. This map is surjective with kernel of order $ e $.
\end{fact*}

\begin{definition*}
$ L / K $ is \textbf{unramified} if $ e = 1 $.
\end{definition*}

\begin{fact*}
For each integer $ m \ge 1 $
\begin{itemize}
\item $ \kappa $ has a unique extension of degree $ m $, say $ \kappa_m $, and
\item $ K $ has a unique unramified extension of degree $ m $, say $ K_m $.
\end{itemize}
These extensions are Galois with cyclic Galois group.
\end{fact*}

\begin{definition*}
The \textbf{maximal unramified extension} is
$$ K^{\ur} = \bigcup_{m \ge 1} K_m \subset \overline{K}. $$
\end{definition*}

\begin{notation*}
\hfill
\begin{itemize}
\item $ \sbr{n}^{-1}P = \cbr{Q \in E\br{\overline{K}} \st nQ = P} $.
\item $ K\br{\cbr{P_1, \dots, P_r}} = K\br{x_1, \dots, x_r, y_1, \dots, y_r} $ with $ P_i = \br{x_i, y_i} $.
\end{itemize}
\end{notation*}

\begin{theorem}
\label{thm:9.9}
Let $ \sbr{K : \QQ_p} < \infty $. Suppose $ E / K $ has good reduction and $ p \nmid n $. If $ P \in E\br{K} $ then $ K\br{\sbr{n}^{-1}P} / K $ is unramified.
\end{theorem}

\begin{proof}
For each $ m \ge 1 $ there is a short exact sequence
$$ 0 \to E_1\br{K_m} \to E\br{K_m} \to \widetilde{E}\br{\kappa_m} \to 0. $$
Taking union over $ m \ge 1 $ gives a commutative diagram
$$
\begin{tikzcd}
0 \arrow{r} & E_1\br{K^{\ur}} \arrow{r} \arrow{d}{\cdot n} & E\br{K^{\ur}} \arrow{r} \arrow{d}{\cdot n} & \widetilde{E}\br{\overline{\kappa}} \arrow{r} \arrow{d}{\cdot n} & 0 \\
0 \arrow{r} & E_1\br{K^{\ur}} \arrow{r} & E\br{K^{\ur}} \arrow{r} & \widetilde{E}\br{\overline{\kappa}} \arrow{r} & 0
\end{tikzcd}.
$$
The left map is an isomorphism by Corollary \ref{cor:8.5}, noting that $ p \nmid n $, so $ n \in \OOO_K^\times $. Since $ K^{\ur} $ is not complete we must apply Corollary \ref{cor:8.5} over each $ K_m $. The right map is surjective by Theorem \ref{thm:2.8} with kernel isomorphic to $ \br{\ZZ / n\ZZ}^2 $ by Theorem \ref{thm:6.5}, noting that $ p \nmid n $. By the snake lemma,
$$ E\br{K^{\ur}}\sbr{n} = \br{\ZZ / n\ZZ}^2, \qquad E\br{K^{\ur}} / nE\br{K^{\ur}} = 0. $$
So if $ P \in E\br{K} $ then there exists $ Q \in E\br{K^{\ur}} $ such that $ nQ = P $ and $ \sbr{n}^{-1}P = \cbr{Q + T \st T \in E\sbr{n}} \subset E\br{K^{\ur}} $, so $ K\br{\sbr{n}^{-1}P} \subset K^{\ur} $. Thus $ K\br{\sbr{n}^{-1}P} / K $ is unramified.
\end{proof}

\lecture{15}{Wednesday}{11/11/20}

\begin{corollary}
\label{cor:9.10}
Let $ E / K $ be an elliptic curve with $ \sbr{K : \QQ_p} < \infty $. Then $ E\br{K}_{\tors} $ is finite.
\end{corollary}

\begin{proof}
In Theorem \ref{thm:9.7} we saw there exists a finite index subgroup $ E_r\br{K} \subset E\br{K} $ with $ E_r\br{K} \cong \br{\OOO_K, +} $. Since $ E_r\br{K} $ is torsion free $ E\br{K}_{\tors} \hookrightarrow E\br{K} / E_r\br{K} $, which is finite.
\end{proof}

\pagebreak

\section{Elliptic curves over number fields I: the torsion subgroup}

Let $ \sbr{K : \QQ} < \infty $, and let $ E / K $ be an elliptic curve.

\subsection{Primes of good and bad reduction}

\begin{notation*}
If $ \ppp $ is a prime of $ K $, that is of $ \OOO_K $, then $ K_\ppp $ is the $ \ppp $-adic completion of $ K $ and $ \kappa_\ppp = \OOO_K / \ppp $.
\end{notation*}

\begin{definition*}
$ \ppp $ is a \textbf{prime of good reduction} for $ E / K $ if $ E / K_\ppp $ has good reduction.
\end{definition*}

\begin{lemma}
$ E / K $ has only finitely many primes of bad reduction.
\end{lemma}

\begin{proof}
Take a Weierstrass equation for $ E $ with $ a_1, \dots, a_6 \in \OOO_K $. Since $ E $ is nonsingular, $ 0 \ne \Delta \in \OOO_K $. Write $ \abr{\Delta} = \ppp_1^{\alpha_1} \dots \ppp_r^{\alpha_r} $, a factorisation into prime ideals. Let $ S = \cbr{\ppp_1, \dots, \ppp_r} $. If $ \ppp \notin S $ then $ \v_\ppp\br{\Delta} = 0 $, so $ E / K_\ppp $ has good reduction. Thus the set of bad primes for $ E $ is in $ S $.
\end{proof}

\begin{remark*}
If $ K $ has class number one, such as $ K = \QQ $, then we can always find a Weierstrass equation for $ E $ with $ a_1, \dots, a_6 \in \OOO_K $ which is minimal at all primes $ \ppp $.
\end{remark*}

\begin{lemma}
$ E\br{K}_{\tors} $ is finite.
\end{lemma}

\begin{proof}
Take any prime $ \ppp $. Then $ K \subset K_\ppp $, so $ E\br{K}_{\tors} \subset E\br{K_\ppp}_{\tors} $, which is finite by Corollary \ref{cor:9.10}.
\end{proof}

\subsection{Reduction modulo \texorpdfstring{$ \ppp $}{p}}

\begin{lemma}
\label{lem:10.3}
Let $ \ppp $ be a prime of good reduction with $ \ppp \nmid n $. Then reduction modulo $ \ppp $ gives an injective group homomorphism $ E\br{K}\sbr{n} \hookrightarrow \widetilde{E}\br{\kappa_\ppp}\sbr{n} $.
\end{lemma}

\begin{proof}
By Proposition \ref{prop:9.5}, $ E\br{K_\ppp} \to \widetilde{E}\br{\kappa_\ppp} $ is a group homomorphism with kernel $ E_1\br{K_\ppp} $. By Corollary \ref{cor:8.5} and $ \ppp \nmid n $, $ E_1\br{K_\ppp} $ has no $ n $-torsion.
\end{proof}

\begin{example*}
Let $ E / \QQ $ be $ y^2 + y = x^3 - x^2 $. Then $ \Delta = -11 $, so $ E $ has good reduction at all $ p \nmid 11 $, and
$$
\begin{array}{c|cccccc}
p & 2 & 3 & 5 & 7 & 11 & 13 \\
\hline
\#\widetilde{E}\br{\FF_p} & 5 & 5 & 5 & 10 & - & 10
\end{array}.
$$
By Lemma \ref{lem:10.3}, $ \#E\br{\QQ}_{\tors} \mid 5 \cdot 2^a $ for some $ a \ge 0 $ and $ \#E\br{\QQ}_{\tors} \mid 5 \cdot 3^b $ for some $ b \ge 0 $, so $ \#E\br{\QQ}_{\tors} \mid 5 $. Let $ T = \br{0, 0} \in E\br{\QQ} $. By calculation, $ 5T = \OOO $, so $ E\br{\QQ}_{\tors} \cong \ZZ / 5\ZZ $.
\end{example*}

\begin{example*}
Let $ E / \QQ $ be $ y^2 + y = x^3 + x^2 $. Then $ \Delta = -43 $, so $ E $ has good reduction at all $ p \ne 43 $, and
$$
\begin{array}{c|cccccc}
p & 2 & 3 & 5 & 7 & 11 & 13 \\
\hline
\#\widetilde{E}\br{\FF_p} & 5 & 6 & 10 & 8 & 9 & 19
\end{array}.
$$
So $ \#E\br{\QQ}_{\tors} \mid 5 \cdot 2^a $ for some $ a \ge 0 $ and $ \#E\br{\QQ}_{\tors} \mid 9 \cdot 11^b $ for some $ b \ge 0 $, so $ E\br{\QQ}_{\tors} = \cbr{\OOO} $. Thus $ P = \br{0, 0} \in E\br{\QQ} $ is a point of infinite order, so $ \rk E\br{\QQ} \ge 1 $.
\end{example*}

\begin{example*}
Let $ E_D $ be $ y^2 = x^3 - D^2x $ for $ D \in \ZZ $ a squarefree integer. Then $ \Delta = 2^6D^6 $, and $ E_D\br{\QQ}_{\tors} \supset \cbr{\OOO, \br{0, 0}, \br{\pm D, 0}} \cong \br{\ZZ / 2\ZZ}^2 $. Let $ f\br{x} = x^3 - D^2x $. If $ p \nmid 2D $ then
$$ \#\widetilde{E_D}\br{\FF_p} = 1 + \sum_{x \in \FF_p} \br{\br{\dfrac{f\br{x}}{p}} + 1}. $$
If $ p \equiv 3 \mod 4 $ then since $ f\br{x} $ is an odd function
$$ \br{\dfrac{f\br{-x}}{p}} = \br{\dfrac{-f\br{x}}{p}} = \br{\dfrac{-1}{p}}\br{\dfrac{f\br{x}}{p}} = -\br{\dfrac{f\br{x}}{p}}, $$
so $ \#\widetilde{E_D}\br{\FF_p} = p + 1 $. Let $ m = \#E_D\br{\QQ}_{\tors} $. We have $ 4 \mid m \mid p + 1 $ for all sufficiently large primes $ p $ with $ p \equiv 3 \mod 4 $, where $ p \nmid 2D $ and $ p \nmid m $. Then $ m = 4 $, since otherwise this contradicts Dirichlet's theorem on primes in arithmetic progressions, so $ E_D\br{\QQ}_{\tors} \cong \br{\ZZ / 2\ZZ}^2 $. Thus $ \rk E_D\br{\QQ} \ge 1 $ if and only if there exist $ x, y \in \QQ $ with $ y \ne 0 $ such that $ y^2 = x^3 - D^2x $, if and only if $ D $ is a congruent number.
\end{example*}

\pagebreak

\subsection{The Lutz-Nagell theorem}

\begin{lemma}
\label{lem:10.4}
Let $ E / \QQ $ be given by a Weierstrass equation with $ a_1, \dots, a_6 \in \ZZ $. Suppose $ \OOO \ne T = \br{x, y} \in E\br{\QQ}_{\tors} $. Then
\begin{enumerate}
\item $ 4x, 8y \in \ZZ $, and
\item if $ 2 \mid a_1 $ or $ 2T \ne \OOO $ then $ x, y \in \ZZ $.
\end{enumerate}
\end{lemma}

\begin{proof}
\hfill
\begin{enumerate}
\item The Weierstrass equation defines a formal group $ \widehat{E} $ over $ \ZZ $. For $ r \ge 1 $ we have
$$ \widehat{E}\br{p^r\ZZ_p} = \cbr{\br{x, y} \in E\br{\QQ_p} \st \v_p\br{x} \le -2r, \ \v_p\br{y} \le -3r} \cup \cbr{\OOO}. $$
By Theorem \ref{thm:9.2}, $ \widehat{E}\br{p^r\ZZ_p} \cong \br{\ZZ_p, +} $ if $ r > 1 / \br{p - 1} $, so $ \widehat{E}\br{4\ZZ_2} $ and $ \widehat{E}\br{p\ZZ_p} $ for $ p $ odd are torsion free. Since $ \OOO \ne T \in E\br{\QQ}_{\tors} $ it follows that $ \v_2\br{x} \ge -2 $ and $ \v_2\br{y} \ge -3 $, and $ \v_p\br{x} \ge 0 $ and $ \v_p\br{y} \ge 0 $ for all odd primes $ p $. This proves $ 1 $.
\item Suppose $ T \in \widehat{E}\br{2\ZZ_2} $, that is $ \v_2\br{x} = -2 $ and $ \v_2\br{y} = -3 $. Since $ \widehat{E}\br{2\ZZ_2} / \widehat{E}\br{4\ZZ_2} \cong \br{\FF_2, +} $ and $ \widehat{E}\br{4\ZZ_2} $ is torsion free we get $ 2T = \OOO $. Also $ \br{x, y} = T = -T = \br{x, -y - a_1x - a_3} $, so $ 2y + a_1x + a_3 = 0 $, so $ 8y + 4xa_1 + 4a_3 = 0 $. Then $ 8y $ is odd, $ 4x $ is odd, and $ 4a_3 $ is even, so $ a_1 $ is odd. So if $ 2T \ne \OOO $ or $ a_1 $ is even then $ T \notin \widehat{E}\br{2\ZZ_2} $, so $ x, y \in \ZZ $.
\end{enumerate}
\end{proof}

\begin{example*}
$ y^2 + xy = x^3 + 4x + 1 $ has $ \br{-\tfrac{1}{4}, \tfrac{1}{8}} \in E\br{\QQ}\sbr{2} $.
\end{example*}

\lecture{16}{Friday}{13/11/20}

\begin{theorem}[Lutz-Nagell]
Let $ E / \QQ $ be $ y^2 = f\br{x} = x^3 + ax + b $ for $ a, b \in \ZZ $. Suppose $ \OOO \ne T = \br{x, y} \in E\br{\QQ}_{\tors} $. Then $ x, y \in \ZZ $ and either $ y = 0 $ or $ y^2 \mid 4a^3 + 27b^2 $.
\end{theorem}

\begin{proof}
By Lemma \ref{lem:10.4}, $ x, y \in \ZZ $. If $ 2T = \OOO $ then $ y = 0 $. Otherwise $ \OOO \ne 2T = \br{x_2, y_2} \in E\br{\QQ}_{\tors} $. By Lemma \ref{lem:10.4}, $ x_2, y_2 \in \ZZ $. But $ x_2 = \br{f'\br{x} / 2y}^2 - 2x $, so $ y \mid f'\br{x} $. Since $ E $ is nonsingular, $ f\br{X} $ and $ f'\br{X} $ are coprime, so $ f\br{X} $ and $ f'\br{X}^2 $ are coprime. Then there exist $ g, h \in \QQ\sbr{X} $ such that $ g\br{X}f\br{X} + h\br{X}f'\br{X}^2 = 1 $. Doing this calculation and clearing denominators gives
$$ \br{3X^2 + 4a}f'\br{X}^2 - 27\br{X^3 + aX - b}f\br{X} = 4a^3 + 27b^2. $$
Since $ y \mid f'\br{x} $ and $ y^2 = f\br{x} $ we get $ y^2 \mid 4a^3 + 27b^2 $.
\end{proof}

\begin{remark*}
Mazur showed that if $ E / \QQ $ is an elliptic curve
$$ E\br{\QQ}_{\tors} \cong
\begin{cases}
\ZZ / n\ZZ & 1 \le n \le 12, \ n \ne 11 \\
\ZZ / 2\ZZ \times \ZZ / 2n\ZZ & 1 \le n \le 4
\end{cases}.
$$
Moreover all fifteen possibilities occur.
\end{remark*}

\pagebreak

\section{Kummer theory}

Let $ K $ be a field, and let $ \ch K \nmid n $. Assume $ \mu_n \subset K $.

\subsection{The Kummer theorem}

\begin{lemma}
\label{lem:11.1}
Let $ \Delta \subset K^* / \br{K^*}^n $ be a finite subgroup. Let $ L = K\br{\sqrt[n]{\Delta}} $. Then $ L / K $ is Galois and
$$ \Gal\br{L / K} \cong \Hom\br{\Delta, \mu_n}. $$
\end{lemma}

\begin{proof}
$ L / K $ is Galois since $ \mu_n \subset K $ and $ \ch K \nmid n $. Define the \textbf{Kummer pairing}
$$ \function[\abr{,}]{\Gal\br{L / K} \times \Delta}{\mu_n}{\br{\sigma, x}}{\dfrac{\sigma\br{\sqrt[n]{x}}}{\sqrt[n]{x}}}. $$
\begin{itemize}
\item Well-defined. If $ \alpha, \beta \in L $ with $ \alpha^n = \beta^n = x $, then $ \br{\alpha / \beta}^n = 1 $. Then $ \alpha / \beta \in \mu_n \subset K $, so $ \sigma\br{\alpha} / \alpha = \sigma\br{\beta} / \beta $.
\item Bilinear, since
$$ \abr{\sigma\tau, x} = \dfrac{\sigma\br{\tau\br{\sqrt[n]{x}}}\tau\br{\sqrt[n]{x}}}{\tau\br{\sqrt[n]{x}}\sqrt[n]{x}} = \abr{\sigma, x}\abr{\tau, x}, \qquad \abr{\sigma, xy} = \dfrac{\sigma\br{\sqrt[n]{xy}}}{\sqrt[n]{xy}} = \dfrac{\sigma\br{\sqrt[n]{x}}\sigma\br{\sqrt[n]{y}}}{\sqrt[n]{x}\sqrt[n]{y}} = \abr{\sigma, x}\abr{\sigma, y}. $$
\item Nondegenerate. Let $ \sigma \in \Gal\br{L / K} $. If $ \abr{\sigma, x} = 1 $ for all $ x \in \Delta $ then $ \sigma\br{\sqrt[n]{x}} = \sqrt[n]{x} $ for all $ x \in \Delta $, so $ \sigma $ fixes $ L $ pointwise, that is $ \sigma = \id $. Let $ x \in \Delta $. If $ \abr{\sigma, x} = 1 $ for all $ \sigma \in \Gal\br{L / K} $ then $ \sigma\br{\sqrt[n]{x}} = \sqrt[n]{x} $ for all $ \sigma \in \Gal\br{L / K} $, so $ \sqrt[n]{x} \in K^* $, so $ x \in \br{K^*}^n $, that is $ x\br{K^*}^n $ is trivial in $ \Delta $.
\end{itemize}
We get injective group homomorphisms
\begin{enumerate}
\item $ \Gal\br{L / K} \hookrightarrow \Hom\br{\Delta, \mu_n} $, and
\item $ \Delta \hookrightarrow \Hom\br{\Gal\br{L / K}, \mu_r} $.
\end{enumerate}
By $ 1 $, $ \Gal\br{L / K} $ is abelian and of exponent dividing $ n $, where the exponent is the least integer $ m $ such that $ g^m = 1 $ for all $ g $. Note that if $ G $ is a finite abelian group of exponent dividing $ n $ then $ \Hom\br{G, \mu_n} \cong G $, noncanonically. So $ \abs{\Gal\br{L / K}} \le \abs{\Delta} \le \abs{\Gal\br{L / K}} $ by $ 1 $ and $ 2 $, so $ 1 $ and $ 2 $ are isomorphisms.
\end{proof}

\begin{example*}
$ \Gal\br{\QQ\br{\sqrt{2}, \sqrt{3}, \sqrt{5}} / \QQ} \cong \br{\ZZ / 2\ZZ}^3 $.
\end{example*}

\begin{theorem}
\label{thm:11.2}
There is a bijection
$$ \bijection{\cbr{\text{finite subgroups} \ \Delta \subset K^* / \br{K^*}^n}}{\cbr{\text{finite abelian extensions} \ L / K \ \text{of exponent dividing} \ n}}{\Delta}{K\br{\sqrt[n]{\Delta}}}{\br{\br{L^*}^n \cap K^*} / \br{K^*}^n}{L}. $$
\end{theorem}

\begin{proof}
\hfill
\begin{itemize}
\item Let $ L / K $ be a finite abelian extension of exponent dividing $ n $. Let $ \Delta = \br{\br{L^*}^n \cap K^*} / \br{K^*}^n $. Then $ K\br{\sqrt[n]{\Delta}} \subset L $ and we aim to show equality. Let $ G = \Gal\br{L / K} $. The Kummer pairing gives an injection $ \Delta \hookrightarrow \Hom\br{G, \mu_n} $. Claim that this is a surjection. Given the claim $ \Delta \cong \Hom\br{G, \mu_n} $, so by Lemma \ref{lem:11.1} $ \sbr{K\br{\sqrt[n]{\Delta}} : K} = \abs{\Delta} = \abs{G} = \sbr{L : K} $. But $ K\br{\sqrt[n]{\Delta}} \subset L $, so $ L = K\br{\sqrt[n]{\Delta}} $. To prove the claim, let $ \chi : G \to \mu_n $ be a group homomorphism. Distinct automorphisms are linearly independent, so there exists $ a \in L $ such that
$$ y = \sum_{\tau \in G} \chi\br{\tau}^{-1}\tau\br{a} \ne 0. $$

\pagebreak

Let $ \sigma \in G $. Then
\begin{equation}
\label{eq:12}
\sigma\br{y} = \sum_{\tau \in G} \chi\br{\tau}^{-1}\sigma\br{\tau\br{a}} = \sum_{\tau \in G} \chi\br{\sigma^{-1}\tau}^{-1}\tau\br{a} = \chi\br{\sigma}\sum_{\tau \in G} \chi\br{\tau}^{-1}\tau\br{a} = \chi\br{\sigma}y,
\end{equation}
so $ \sigma\br{y^n} = y^n $ for all $ \sigma \in G $. Let $ x = y^n $. Then $ x \in K^* \cap \br{L^*}^n $, that is $ x \in \Delta $. Also by $ \br{\ref{eq:12}} $, $ \chi : \sigma \mapsto \sigma\br{y} / y = \sigma\br{\sqrt[n]{x}} / \sqrt[n]{x} $, so
$$ \function{\Delta}{\Hom\br{G, \mu_n}}{x}{\chi}. $$
This proves the claim.
\item Let $ \Delta \subset K^* / \br{K^*}^n $ be a finite subgroup. Let $ L = K\br{\sqrt[n]{\Delta}} $ and $ \Delta' = \br{\br{L^*}^n \cap K^*} / \br{K^*}^n $. We must show $ \Delta' = \Delta $. Clearly $ \Delta \subset \Delta' $, so $ L = K\br{\sqrt[n]{\Delta}} \subset K\br{\sqrt[n]{\Delta'}} \subset L $. Then $ K\br{\sqrt[n]{\Delta}} = K\br{\sqrt[n]{\Delta'}} $, so by Lemma \ref{lem:11.1}, $ \abs{\Delta} = \abs{\Delta'} $. Since $ \Delta \subset \Delta' $ it follows that $ \Delta = \Delta' $.
\end{itemize}
\end{proof}

\subsection{Unramified Kummer extensions of number fields}

\lecture{17}{Monday}{16/11/20}

\begin{proposition}
\label{prop:11.3}
Let $ K $ be a number field such that $ \mu_n \subset K $. Let $ S $ be a finite set of primes of $ K $. There are only finitely many extensions $ L / K $ such that
\begin{itemize}
\item $ L / K $ is abelian of exponent dividing $ n $, and
\item $ L / K $ is unramified at all primes $ \ppp \notin S $.
\end{itemize}
\end{proposition}

\begin{proof}
By Theorem \ref{thm:11.2}, $ L = K\br{\sqrt[n]{\Delta}} $ for some $ \Delta \subset K^* / \br{K^*}^n $ a finite subgroup. Let $ \ppp $ be a prime of $ K $ such that $ \ppp\OOO_L = \pp_1^{e_1} \dots \pp_r^{e_r} $ for $ \pp_i $ a prime in $ \OOO_L $. If $ x \in K^* $ represents an element of $ \Delta $ then $ n\v_{\pp_i}\br{\sqrt[n]{x}} = \v_{\pp_i}\br{x} = e_i\v_\ppp\br{x} $. If $ \ppp \notin S $ then all $ e_i = 1 $, so $ \v_\ppp\br{x} \equiv 0 \mod n $. Thus $ \Delta \subset K\br{S, n} $ where
$$ K\br{S, n} = \cbr{x \in K^* / \br{K^*}^n \st \forall \ppp \notin S, \ \v_\ppp\br{x} \equiv 0 \mod n}, $$
and the proof is completed by Lemma \ref{lem:11.4}.
\end{proof}

\begin{lemma}
\label{lem:11.4}
$ K\br{S, n} $ is finite.
\end{lemma}

\begin{proof}
The map
$$ \function{K\br{S, n}}{\br{\ZZ / n\ZZ}^{\abs{S}}}{x}{\br{\v_\ppp\br{x} \mod n}_{\ppp \in S}} $$
is a group homomorphism with kernel $ K\br{\emptyset, n} $. Since $ \abs{S} < \infty $, it suffices to prove Lemma \ref{lem:11.4} with $ S = \emptyset $. If $ x \in K^* $ represents an element of $ K\br{\emptyset, n} $ then $ \abr{x} = \aaa^n $ for some ideal $ \aaa $. There is an exact sequence
$$ 0 \to \OOO_K^\times / \br{\OOO_K^\times}^n \to K\br{\emptyset, n} \xrightarrow{x\br{K^*}^n \mapsto \sbr{\aaa}} \Cl\br{K}\sbr{n} \to 0. $$
Since $ \abs{\Cl\br{K}} < \infty $ and $ \OOO_K^\times $ is finitely generated, by Dirichlet's unit theorem, $ K\br{\emptyset, n} $ is finite.
\end{proof}

\pagebreak

\section{Elliptic curves over number fields II: the Mordell-Weil theorem}

\subsection{The weak Mordell-Weil theorem}

\begin{lemma}
\label{lem:12.1}
Let $ E / K $ be an elliptic curve, and let $ L / K $ be a finite Galois extension. Then the map $ E\br{K} / nE\br{K} \to E\br{L} / nE\br{L} $ has finite kernel.
\end{lemma}

\begin{proof}
For each element in the kernel we pick a coset representative $ P \in E\br{K} $ and then $ Q \in E\br{L} $ with $ nQ = P $. Note that for any $ \sigma \in \Gal\br{L / K} $, $ n\br{\sigma\br{Q} - Q} = \sigma\br{P} - P = 0 $. Since $ \Gal\br{L / K} $ is finite and $ E\sbr{n} $ is finite, there are only finitely many possibilities for the map
$$ \function{\Gal\br{L / K}}{E\sbr{n}}{\sigma}{\sigma\br{Q} - Q}. $$
But if $ P_1, P_2 \in E\br{K} $ such that $ P_i = nQ_i $ for $ Q_1, Q_2 \in E\br{L} $ and $ \sigma\br{Q_1} - Q_1 = \sigma\br{Q_2} - Q_2 $ for all $ \sigma \in \Gal\br{L / K} $, then $ \sigma\br{Q_1 - Q_2} = Q_1 - Q_2 $ for all $ \sigma \in \Gal\br{L / K} $. Then $ Q_1 - Q_2 \in E\br{K} $, so $ P_1 - P_2 \in nE\br{K} $.
\end{proof}

\begin{theorem}[Weak Mordell-Weil]
Let $ K $ be a number field, let $ E / K $ be an elliptic curve, and let $ n \ge 2 $ be an integer. Then $ E\br{K} / nE\br{K} $ is finite.
\end{theorem}

\begin{proof}
By Lemma \ref{lem:12.1}, we may replace $ K $ by a finite Galois extension. So without loss of generality $ \mu_n \subset K $ and $ E\sbr{n} \subset E\br{K} $. Let
$$ S = \cbr{\ppp \mid n} \cup \cbr{\text{primes of bad reduction for} \ E / K}. $$
For each $ P \in E\br{K} $ the extension $ K\br{\sbr{n}^{-1}P} / K $ is unramified outside $ S $, by Theorem \ref{thm:9.9}. Let $ Q \in \sbr{n}^{-1}P $. Since $ E\sbr{n} \subset E\br{K} $, $ K\br{Q} = K\br{\sbr{n}^{-1}P} $. This is a Galois extension of $ K $. Let
$$ \function{\Gal\br{K\br{Q} / K}}{E\sbr{n} \cong \br{\ZZ / n\ZZ}^2}{\sigma}{\sigma\br{Q} - Q}, $$
which is
\begin{itemize}
\item a group homomorphism, since
$$ \sigma\tau\br{Q} - Q = \sigma\br{\tau\br{Q} - Q} + \sigma\br{Q} - Q = \tau\br{Q} - Q + \sigma\br{Q} - Q, $$
\item injective, since if $ \sigma\br{Q} = Q $ then $ \sigma $ fixes $ K\br{Q} $ pointwise, that is $ \sigma = \id $.
\end{itemize}
Then $ K\br{Q} / K $ is an abelian extension of exponent dividing $ n $, unramified outside $ S $. By Proposition \ref{prop:11.3}, there are only finitely many possibilities for $ K\br{Q} $, as we vary $ P \in E\br{K} $. Let $ L $ be the composite of all such extensions of $ K $, that is for all $ P \in E\br{K} $. Then $ L / K $ is finite, and Galois, and $ E\br{K} / nE\br{K} \to E\br{L} / nE\br{L} $ is the zero map. By Lemma \ref{lem:12.1}, $ \abs{E\br{K} / nE\br{K}} < \infty $.
\end{proof}

\begin{remark*}
If $ K = \RR, \CC $ or $ \sbr{K : \QQ_p} < \infty $ then $ \abs{E\br{K} / nE\br{K}} < \infty $, yet $ E\br{K} $ is not finitely generated, indeed uncountable.
\end{remark*}

\pagebreak

\subsection{The Mordell-Weil theorem}

Let $ E / K $ be an elliptic curve over a number field.

\begin{fact*}
There exists a quadratic form, the canonical height, $ \widehat{\h} : E\br{K} \to \RR_{\ge 0} $ with the property that
\begin{equation}
\label{eq:13}
\#\cbr{P \in E\br{K} \st \widehat{\h}\br{P} \le B} < \infty, \qquad B \ge 0.
\end{equation}
\end{fact*}

\begin{theorem}[Mordell-Weil]
Let $ K $ be a number field, and let $ E / K $ be an elliptic curve. Then $ E\br{K} $ is a finitely generated abelian group.
\end{theorem}

\begin{proof}
Fix any integer $ n \ge 2 $. By weak Mordell-Weil, $ \abs{E\br{K} / nE\br{K}} < \infty $. Pick coset representatives $ P_1, \dots, P_m $. Let
$$ \Sigma = \cbr{P \in E\br{K} \st \widehat{\h}\br{P} \le \max_{1 \le i \le m} \widehat{\h}\br{P_i}}. $$
Claim that $ \Sigma $ generates $ E\br{K} $. If not there exists $ P \in E\br{K} \setminus \cbr{\text{subgroup generated by} \ \Sigma} $ of minimal height, which exists by $ \br{\ref{eq:13}} $. Then $ P = P_i + nQ $ for some $ 1 \le i \le m $ and $ Q \in E\br{K} $. Note that $ Q \in E\br{K} \setminus \cbr{\text{subgroup generated by} \ \Sigma} $. By the minimal choice of $ P $,
$$ 4\widehat{\h}\br{P} \le 4\widehat{\h}\br{Q} \le n^2\widehat{\h}\br{Q} = \widehat{\h}\br{nQ} = \widehat{\h}\br{P - P_i} \le \widehat{\h}\br{P - P_i} + \widehat{\h}\br{P + P_i} = 2\widehat{\h}\br{P} + 2\widehat{\h}\br{P_i}, $$
by the parallelogram law, so $ \widehat{\h}\br{P} \le \widehat{\h}\br{P_i} $. By definition of $ \Sigma $, $ P \in \Sigma $, a contradiction to the choice of $ P $. This proves the claim. But by $ \br{\ref{eq:13}} $, $ \Sigma $ is finite.
\end{proof}

\lecture{18}{Wednesday}{18/11/20}

\begin{remark*}
The structure theorem for finitely generated abelian groups shows
$$ E\br{K} \cong E\br{K}_{\tors} \times \ZZ^r, \qquad r \ge 0, $$
where $ r $ is called the \textbf{rank}. There is no known algorithm proven to compute $ \rk E\br{K} $ in all cases.
\end{remark*}

\pagebreak

\section{Heights}

For simplicity take $ K = \QQ $.

\subsection{Naive heights}

Write $ P \in \PP^n\br{\QQ} $ as $ P = \br{a_0 : \dots : a_n} $ where $ a_0, \dots, a_n \in \ZZ $ such that $ \gcd\br{a_0, \dots, a_n} = 1 $.

\begin{definition*}
The \textbf{height} is
$$ \H\br{P} = \max_{0 \le i \le n} \abs{a_i}. $$
\end{definition*}

\begin{lemma}
\label{lem:13.1}
Let $ f_1, f_2 \in \QQ\sbr{X_1, X_2} $ be coprime homogeneous polynomials of degree $ d $. Let
$$ \function[F]{\PP^1}{\PP^1}{\br{x_1 : x_2}}{\br{f_1\br{x_1, x_2} : f_2\br{x_1, x_2}}}. $$
Then there exist $ c_1, c_2 > 0 $ such that
$$ c_1\H\br{P}^d \le \H\br{F\br{P}} \le c_2\H\br{P}^d, \qquad P \in \PP^1\br{\QQ}. $$
\end{lemma}

\begin{proof}
Without loss of generality $ f_1, f_2 \in \ZZ\sbr{X_1, X_2} $.
\begin{itemize}
\item Upper bound. Write $ P = \br{a : b} $ for $ a, b \in \ZZ $ coprime. Then
$$ \H\br{F\br{P}} \le \max\br{\abs{f_1\br{a, b}}, \abs{f_2\br{a, b}}} \le c_2\max\br{\abs{a}^d, \abs{b}^d}, $$
where $ c_2 $ is the maximum of the sum of absolute values of coefficients of $ f_1 $ and $ f_2 $, so $ \H\br{F\br{P}} \le c_2\H\br{P}^d $.
\item Lower bound. We claim there exist $ g_{ij} \in \ZZ\sbr{X_1, X_2} $ homogeneous polynomials of degree $ d - 1 $ and $ \kappa \in \ZZ_{> 0} $ such that
\begin{equation}
\label{eq:14}
\sum_{j = 1}^2 g_{ij}f_j = \kappa X_i^{2d - 1}, \qquad i = 1, 2.
\end{equation}
Indeed running Euclid's algorithm on $ f_1\br{X, 1} $ and $ f_2\br{X, 1} $ gives $ r, s \in \QQ\sbr{X} $ of degree less than $ d $ such that $ r\br{X}f_1\br{X, 1} + s\br{X}f_2\br{X, 1} = 1 $. Homogenising and clearing denominators gives $ \br{\ref{eq:14}} $ with $ i = 2 $. Likewise for $ i = 1 $. Write $ P = \br{a_1 : a_2} $ for $ a_1, a_2 \in \ZZ $ coprime. By $ \br{\ref{eq:14}} $,
$$ \sum_{j = 1}^2 g_{ij}\br{a_1, a_2}f_j\br{a_1, a_2} = \kappa a_i^{2d - 1}, \qquad i = 1, 2, $$
so $ \gcd\br{f_1\br{a_1, a_2}, f_2\br{a_1, a_2}} $ divides $ \gcd\br{\kappa a_1^{2d - 1}, \kappa a_2^{2d - 1}} = \kappa $. But also
$$ \abs{\kappa a_i^{2d - 1}} \le \max_{j = 1, 2} \abs{f_j\br{a_1, a_2}}\sum_{j = 1}^2 \abs{g_{ij}\br{a_1, a_2}} \le \kappa\H\br{F\br{P}}\gamma_i\H\br{P}^{d - 1}, $$
where $ \gamma_i $ is the sum of absolute values of coefficients of $ g_{i1} $ and $ g_{i2} $, so
$$ \kappa\abs{a_i}^{2d - 1} \le \gamma_i\kappa\H\br{F\br{P}}\H\br{P}^{d - 1}, \qquad i = 1, 2. $$
Thus
$$ \H\br{P}^{2d - 1} \le \max\br{\gamma_1, \gamma_2}\H\br{F\br{P}}\H\br{P}^{d - 1}, $$
so
$$ c_1\H\br{P}^d = \dfrac{1}{\max\br{\gamma_1, \gamma_2}}\H\br{P}^d \le \H\br{F\br{P}}. $$
\end{itemize}
\end{proof}

\pagebreak

\begin{notation*}
For $ x \in \QQ $
$$ \H\br{x} = \H\br{\br{x : 1}} = \max\br{\abs{u}, \abs{v}}, \qquad x = \dfrac{u}{v}, \qquad u, v \in \ZZ \ \text{coprime}. $$
\end{notation*}

\begin{definition*}
The \textbf{height} is
$$ \function[\H]{E\br{\QQ}}{\RR_{\ge 1}}{P}{
\begin{cases}
\H\br{x} & P = \br{x, y} \\
1 & P = \OOO_E
\end{cases}
}. $$
The \textbf{logarithmic height} is
$$ \function[\h]{E\br{\QQ}}{\RR_{\ge 0}}{P}{\log \H\br{P}}. $$
\end{definition*}

\begin{lemma}
\label{lem:13.2}
Let $ E $ and $ E' $ be elliptic curves over $ \QQ $, and let $ \phi : E \to E' $ be an isogeny defined over $ \QQ $. Then there exists $ c > 0 $ such that
$$ \abs{\h\br{\phi\br{P}} - \br{\deg \phi}\h\br{P}} \le c, \qquad P \in E\br{\QQ}. $$
\end{lemma}

Note that $ c $ depends on $ E, E', \phi $ but not on $ P $.

\begin{proof}
Recall, by Lemma \ref{lem:5.3},
$$
\begin{tikzcd}
E \arrow{r}{\phi} \arrow{d}[swap]{x} & E' \arrow{d}{x} \\
\PP^1 \arrow{r}[swap]{\xi} & \PP^1
\end{tikzcd},
$$
where $ \deg \phi = \deg \xi = d $, say. By Lemma \ref{lem:13.1}, there exist $ c_1, c_2 \ge 0 $ such that
$$ c_1\H\br{P}^d \le \H\br{\phi\br{P}} \le c_2\H\br{P}^d, \qquad P \in \PP^1\br{\QQ}. $$
Taking logarithms gives
$$ \abs{\h\br{\phi\br{P}} - d\h\br{P}} \le \max\br{\log c_2, -\log c_1} = c. $$
\end{proof}

\begin{example*}
Let $ \phi = \sbr{2} : E \to E $. Then there exists $ c > 0 $ such that
\begin{equation}
\label{eq:15}
\abs{\h\br{2P} - 4\h\br{P}} \le c, \qquad P \in E\br{\QQ}.
\end{equation}
\end{example*}

\subsection{The canonical height quadratic form}

\begin{definition*}
The \textbf{canonical height} is
$$ \widehat{\h}\br{P} = \lim_{n \to \infty} \dfrac{1}{4^n}\h\br{2^nP}. $$
\end{definition*}

We check convergence. Let $ m \ge n $. Then
\begin{align*}
\abs{\dfrac{1}{4^m}\h\br{2^mP} - \dfrac{1}{4^n}\h\br{2^nP}}
& \le \sum_{r = n}^{m - 1} \abs{\dfrac{1}{4^{r + 1}}\h\br{2^{r + 1}P} - \dfrac{1}{4^r}\h\br{2^rP}} \\
& = \sum_{r = n}^{m - 1} \dfrac{1}{4^{r + 1}}\abs{\h\br{2\br{2^rP}} - 4\h\br{2^rP}}
\le c\sum_{r = n}^\infty \dfrac{1}{4^{r + 1}} & \text{by} \ \br{\ref{eq:15}} \\
& = \dfrac{c}{4^{n + 1}} \cdot \dfrac{1}{1 - \tfrac{1}{4}}
= \dfrac{c}{3 \cdot 4^n}
\to 0, & n \to \infty.
\end{align*}
So the sequence is Cauchy and $ \widehat{\h}\br{P} $ exists.

\pagebreak

\begin{lemma}
\label{lem:13.3}
$ \abs{\h\br{P} - \widehat{\h}\br{P}} $ is bounded for $ P \in E\br{\QQ} $.
\end{lemma}

\begin{proof}
Putting $ n = 0 $ in the above calculation
$$ \abs{\dfrac{1}{4^m}\h\br{2^mP} - \h\br{P}} \le \dfrac{c}{3}. $$
Take the limit as $ m \to \infty $.
\end{proof}

\begin{corollary}
For any $ B > 0 $, $ \#\cbr{P \in E\br{\QQ} \st \widehat{\h}\br{P} \le B} $ is finite.
\end{corollary}

\begin{proof}
If $ \widehat{\h}\br{P} $ is bounded, then by Lemma \ref{lem:13.3}, $ \h\br{P} $ is bounded, so there are only finitely many possibilities for $ x $. Each $ x $ leaves at most two choices for $ y $.
\end{proof}

\begin{lemma}
\label{lem:13.5}
Let $ \phi : E \to E' $ be an isogeny over $ \QQ $. Then
$$ \widehat{\h}\br{\phi\br{P}} = \br{\deg \phi}\widehat{\h}\br{P}, \qquad P \in E\br{\QQ}. $$
\end{lemma}

\begin{proof}
By Lemma \ref{lem:13.2} there exists $ c > 0 $ such that $ \abs{\h\br{\phi\br{P}} - \br{\deg \phi}\h\br{P}} \le c $ for all $ P \in E\br{\QQ} $. Replace $ P $ by $ 2^nP $, divide by $ 4^n $, and take the limit as $ n \to \infty $.
\end{proof}

\lecture{19}{Friday}{20/11/20}

\begin{remark*}
\hfill
\begin{itemize}
\item $ \H $ and $ \h $ depend on a choice of Weierstrass equation, but Lemma \ref{lem:13.5}, with $ \deg \phi = 1 $, shows $ \widehat{\h} $ does not.
\item Taking $ \phi = \sbr{n} : E \to E $ shows $ \widehat{\h}\br{nP} = n^2\widehat{\h}\br{P} $ for all $ n \in \ZZ $.
\end{itemize}
\end{remark*}

\begin{lemma}
\label{lem:13.6}
Let $ E / \QQ $ be an elliptic curve $ y^2 = x^3 + ax + b $ for $ a, b \in \ZZ $. Then there exists $ c > 0 $ such that
$$ \H\br{P + Q}\H\br{P - Q} \le c\H\br{P}^2\H\br{Q}^2, \qquad P, Q \in E\br{\QQ}, \qquad P, Q, P \pm Q \ne \OOO_E. $$
\end{lemma}

\begin{proof}
Let $ P, Q, P + Q, P - Q $ have $ x $-coordinates $ x_1, \dots, x_4 $. By Lemma \ref{lem:5.7} there exist $ w_1, w_2, w_3 \in \ZZ\sbr{x_1, x_2} $ of degree at most two in $ x_1 $ and of degree at most two in $ x_2 $ such that $ \br{1 : x_3 + x_4 : x_3x_4} = \br{w_0 : w_1 : w_2} $. Write $ x_i = r_i / s_i $ for $ r_i, s_i \in \ZZ $ coprime. Then
$$ \br{s_3s_4 : r_3s_4 + r_4s_3 : r_3r_4} = \br{\br{r_1s_2 - r_2s_1}^2 : w_1\br{r_1, s_1, r_2, s_2} : w_2\br{r_1, s_1, r_2, s_2}}, $$
where $ s_3s_4, r_3s_4 + r_4s_3, r_3r_4 $ are coprime, so
\begin{align*}
\H\br{P + Q}\H\br{P - Q}
& = \max\br{\abs{r_3}, \abs{s_3}}\max\br{\abs{r_4}, \abs{s_4}}
\le 2\max\br{\abs{s_3s_4}, \abs{r_3s_4 + r_4s_3}, \abs{r_3r_4}} \\
& \le 2\max\br{\abs{r_1s_2 - r_2s_1}^2, \abs{w_1\br{r_1, s_1, r_2, s_2}}, \abs{w_2\br{r_1, s_1, r_2, s_2}}}
\le c\H\br{P}^2\H\br{Q}^2,
\end{align*}
where $ c $ depends on $ E $, but not on $ P $ and $ Q $.
\end{proof}

\begin{theorem}
\label{thm:13.7}
$ \widehat{\h} : E\br{\QQ} \to \RR_{\ge 0} $ is a quadratic form.
\end{theorem}

\begin{proof}
By Lemma \ref{lem:13.6} and since $ \abs{\h\br{2P} - 4\h\br{P}} $ is bounded,
$$ \h\br{P + Q} + \h\br{P - Q} \le 2\h\br{P} + 2\h\br{Q} + c, \qquad P, Q \in E\br{\QQ}. $$
Replacing $ P $ and $ Q $ by $ 2^nP $ and $ 2^nQ $, dividing by $ 4^n $, and taking the limit as $ n \to \infty $ gives
$$ \widehat{\h}\br{P + Q} + \widehat{\h}\br{P - Q} \le 2\widehat{\h}\br{P} + 2\widehat{\h}\br{Q}. $$
Replacing $ P $ and $ Q $ by $ P + Q $ and $ P - Q $ and using $ \widehat{\h}\br{2P} = 4\widehat{\h}\br{P} $ gives the reverse inequality. Thus $ \widehat{\h} $ satisfies the parallelogram law, so $ \widehat{\h} $ is a quadratic form.
\end{proof}

\pagebreak

The \textbf{places} of a number field $ K $ are
\begin{itemize}
\item the \textbf{finite places}, or primes, $ \abs{x}_\ppp = c^{-\v_\ppp\br{x}} $ for some fixed $ c > 1 $, and
\item the \textbf{infinite places}, or real and complex embeddings, $ \abs{x}_\sigma = \abs{\sigma\br{x}}^d $ for some fixed $ d > 0 $.
\end{itemize}
For each place $ v $ we may choose a normalisation $ \abs{\cdot}_v $, that is make a choice of $ c $ and $ d $, such that
$$ \prod_v \abs{\lambda}_v = 1, \qquad \lambda \in K^*, $$
the \textbf{product formula}.

\begin{remark*}
For $ K $ a number field let $ P = \br{a_0 : \dots : a_n} \in \PP^n\br{K} $. Define
$$ \H\br{P} = \prod_v \max_{0 \le i \le n} \abs{a_i}_v. $$
This is well-defined by the product formula. All results in this section generalise from $ \QQ $ to $ K $.
\end{remark*}

\begin{remark*}
Let $ \pi_i : E \times E \times E \to E $ be projection onto the $ i $-th factor. Let $ \pi_{ij} = \pi_i + \pi_j $ and $ \pi_{123} = \pi_1 + \pi_2 + \pi_3 $. The \textbf{theorem of the cube}, proof omitted, says that if $ D \in \Div E $ then
$$ \pi_{123}^*D + \pi_1^*D + \pi_2^*D + \pi_3^*D \sim \pi_{12}^*D + \pi_{13}^*D + \pi_{23}^*D. $$
This can be used to give alternative proofs of Theorem \ref{thm:5.6} and Theorem \ref{thm:13.7}.
\end{remark*}

\pagebreak

\section{Dual isogenies and the Weil pairing}

Let $ K $ be a perfect field, and let $ E / K $ be an elliptic curve.

\subsection{Dual isogenies}

\begin{proposition}
\label{prop:14.1}
Let $ \Phi \subset E\br{\overline{K}} $ be a finite $ \Gal\br{\overline{K} / K} $-stable subgroup. Then there exist an elliptic curve $ E' / K $ and a separable isogeny $ \phi : E \to E' $ defined over $ K $ with kernel $ \Phi $ such that every isogeny $ \psi : E \to E'' $ with $ \Phi \subset \ker \psi $ factors uniquely in $ \phi $, so
$$
\begin{tikzcd}
E \arrow{rr}{\psi} \arrow{dr}[swap]{\phi} & & E'' \\
& E' \arrow[dashed]{ur}[swap]{\exists !} &
\end{tikzcd}.
$$
\end{proposition}

\begin{proof}
Omitted. Silverman, Chapter III, Proposition 4.12.
\end{proof}

\begin{proposition}
Let $ \phi : E \to E' $ be an isogeny of degree $ n $. Then there exists a unique isogeny $ \widehat{\phi} : E' \to E $ such that $ \widehat{\phi} \circ \phi = \sbr{n} $. Then $ \widehat{\phi} $ is called the \textbf{dual isogeny}.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item If $ \phi $ is separable, then $ \abs{\ker \phi} = n $, so $ \ker \phi \subset E\sbr{n} $. Apply Proposition \ref{prop:14.1} with $ \psi = \sbr{n} $.
\item The case $ \phi $ is inseparable is omitted. See Silverman, Chapter III, Theorem 6.1. For uniqueness, if $ \psi_1 \circ \phi = \psi_2 \circ \phi = \sbr{n} $, then $ \br{\psi_1 - \psi_2} \circ \phi = 0 $. Since $ \phi $ is nonconstant, so surjective on $ \overline{K} $ points, $ \psi_1 - \psi_2 = 0 $, so $ \psi_1 = \psi_2 $.
\end{itemize}
\end{proof}

\begin{remark*}
\hfill
\begin{itemize}
\item Let $ E_1 \sim E_2 $ if and only if $ E_1 $ and $ E_2 $ are isogenous. Then $ \sim $ is an equivalence relation.
\item $ \deg \sbr{n} = n^2 $, so $ \deg \phi = \deg \widehat{\phi} $ and $ \widehat{\sbr{n}} = \sbr{n} $.
\item $ \phi \circ \widehat{\phi} \circ \phi = \phi \circ \sbr{n}_E = \sbr{n}_{E'} \circ \phi $, so $ \phi \circ \widehat{\phi} = \sbr{n}_{E'} $. In particular $ \widehat{\widehat{\phi}} = \phi $.
\item If $ \psi : E_1 \to E_2 $ and $ \phi : E_2 \to E_3 $ then $ \widehat{\phi \circ \psi} = \widehat{\psi} \circ \widehat{\phi} $.
\item If $ \phi \in \End E $ then by example sheet $ 2 $, $ \phi^2 - \sbr{\Tr \phi}\phi + \sbr{\deg \phi} = 0 $, so $ \br{\sbr{\Tr \phi} - \phi} \circ \phi = \sbr{\deg \phi} $. Thus $ \sbr{\Tr \phi} = \phi + \widehat{\phi} $.
\end{itemize}
\end{remark*}

\begin{lemma}
\label{lem:14.3}
If $ \phi, \psi \in \Hom\br{E, E'} $ then
$$ \widehat{\phi + \psi} = \widehat{\phi} + \widehat{\psi}. $$
\end{lemma}

\begin{proof}
\hfill
\begin{enumerate}
\item If $ E = E' $ then this follows from $ \Tr \br{\phi + \psi} = \Tr \phi + \Tr \psi $.
\item In general let $ \alpha : E' \to E $ be any isogeny, such as $ \widehat{\phi} $. By $ 1 $, $ \widehat{\alpha \circ \phi + \alpha \circ \psi} = \widehat{\alpha \circ \phi} + \widehat{\alpha \circ \psi} $, so $ \widehat{\alpha \circ \br{\phi + \psi}} = \widehat{\phi} \circ \widehat{\alpha} + \widehat{\psi} \circ \widehat{\alpha} $. Thus $ \widehat{\phi + \psi} \circ \widehat{\alpha} = \br{\widehat{\phi} + \widehat{\psi}} \circ \widehat{\alpha} $, so $ \widehat{\phi + \psi} = \widehat{\phi} + \widehat{\psi} $.
\end{enumerate}
\end{proof}

\begin{remark*}
In Silverman's book he proves Lemma \ref{lem:14.3} first, and uses this to show $ \deg : \Hom\br{E, E'} \to \ZZ $ is a quadratic form.
\end{remark*}

\pagebreak

\subsection{The Weil pairing}

\lecture{20}{Monday}{23/11/20}

\begin{definition*}
The \textbf{sum} is
$$ \function[\Sum]{\Div E}{E}{\sum_P n_P\br{P}}{\sum_P n_PP}, $$
adding up a formal sum using the group law.
\end{definition*}

Recall there is an isomorphism
$$ \functions{E}{\Pic^0 E}{P}{\sbr{\br{P} - \br{\OOO_E}}}{\sum_P n_PP}{\sbr{\sum_P n_P\br{P} - \br{\sum_P n_P}\br{\OOO_E}}}, $$
so $ \Sum D \mapsto \sbr{D} $ for all $ D \in \Div^0 E $.

\begin{lemma}
Let $ D \in \Div E $. Then $ D \sim 0 $ if and only if $ \deg D = 0 $ and $ \Sum D = \OOO_E $.
\end{lemma}

Let $ \phi : E \to E' $ be an isogeny of degree $ n $ with dual isogeny $ \widehat{\phi} : E' \to E $. Assume $ \ch K \nmid n $, so $ \phi $ and $ \widehat{\phi} $ are separable. We define the \textbf{Weil pairing}
$$ \e_\phi : E\sbr{\phi} \times E'\sbr{\widehat{\phi}} \to \mu_n. $$
Let $ T \in E'\sbr{\widehat{\phi}} $. Then $ nT = \OOO $. So there exists $ f \in \overline{K}\br{E'}^* $ such that
$$ \div f = n\br{T} - n\br{\OOO}. $$
Pick $ T_0 \in E\br{K} $ with $ \phi\br{T_0} = T $. Then
$$ \phi^*\br{T} - \phi^*\br{\OOO} = \sum_{P \in E\sbr{\phi}} \br{P + T_0} - \sum_{P \in E\sbr{\phi}} \br{P} $$
has sum $ nT_0 = \widehat{\phi}\br{\phi\br{T_0}} = \widehat{\phi}\br{T} = \OOO $. So there exists $ g \in \overline{K}\br{E}^* $ such that
$$ \div g = \phi^*\br{T} - \phi^*\br{\OOO}. $$
Now
$$ \div \br{\phi^*f} = \phi^*\br{\div f} = n\br{\phi^*\br{T} - \phi^*\br{\OOO}} = \div g^n, $$
so $ \phi^*f = cg^n $ for some $ c \in \overline{K}^* $. Rescaling $ f $, without loss of generality $ c = 1 $, that is $ \phi^*f = g^n $. If $ S \in E\sbr{\phi} $ then $ \phi \circ \tau_S = \phi $, so $ \tau_S^* \circ \phi^* = \phi^* $. Then $ \tau_S^*\br{\div g} = \div g $, so $ \tau_S^*g = \zeta g $ for some $ \zeta \in \overline{K}^* $. Thus
$$ \zeta = \dfrac{g\br{X + S}}{g\br{X}}, \qquad X \in E\br{\overline{K}} \setminus \cbr{\text{zeros and poles of} \ g}. $$
Now
$$ \zeta^n = \dfrac{g\br{X + S}^n}{g\br{X}^n} = \dfrac{f\br{\phi\br{X + S}}}{f\br{\phi\br{X}}} = 1, $$
since $ S \in E\sbr{\phi} $, so $ \zeta \in \mu_n $. We define
$$ \e_\phi\br{S, T} = \dfrac{g\br{X + S}}{g\br{X}}. $$

\begin{proposition}
$ \e_\phi $ is bilinear and nondegenerate.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item Linearity in first argument, since
$$ \e_\phi\br{S_1 + S_2, T} = \dfrac{g\br{X + S_1 + S_2}}{g\br{X + S_2}} \cdot \dfrac{g\br{X + S_2}}{g\br{X}} = \e_\phi\br{S_1, T}\e_\phi\br{S_2, T}. $$

\pagebreak

\item Linearity in second argument. Let $ T_1, T_2 \in E'\sbr{\widehat{\phi}} $, and let
$$ \div f_1 = n\br{T_1} - n\br{\OOO}, \qquad \div f_2 = n\br{T_2} - n\br{\OOO}, \qquad \phi^*f_1 = g_1^n, \qquad \phi^*f_2 = g_2^n. $$
There exists $ h \in \overline{K}\br{E'}^* $ such that
$$ \div h = \br{T_1} + \br{T_2} - \br{T_1 + T_2} - \br{\OOO}. $$
Then put $ f = f_1f_2 / h^n $ and $ g = g_1g_2 / \phi^*h $. Check that
$$ \div f = n\br{T_1 + T_2} - n\br{\OOO}, \qquad \phi^*f = \dfrac{\phi^*f_1\phi^*f_2}{\br{\phi^*h}^n} = \br{\dfrac{g_1g_2}{\phi^*h}}^n = g^n, $$
so
$$ \e_\phi\br{S, T_1 + T_2} = \dfrac{g\br{X + S}}{g\br{X}} = \dfrac{g_1\br{X + S}}{g_1\br{X}} \cdot \dfrac{g_2\br{X + S}}{g_2\br{X}} \cdot \dfrac{h\br{\phi\br{X}}}{h\br{\phi\br{X + S}}} = \e_\phi\br{S, T_1}\e_\phi\br{S, T_2}, $$
since $ S \in E\sbr{\phi} $.
\item $ \e_\phi $ is nondegenerate. Fix $ T \in E'\sbr{\widehat{\phi}} $. Suppose $ \e_\phi\br{S, T} = 1 $ for all $ S \in E\sbr{\phi} $, so $ \tau_S^*g = g $ for all $ S \in E\sbr{\phi} $. Then $ \overline{K}\br{E} / \phi^*\br{\overline{K}\br{E'}} $ is a Galois extension with Galois group $ E\sbr{\phi} $. Note that $ S \in E\sbr{\phi} $ acts as $ \tau_S^* $. Then $ g = \phi^*h $ for some $ h \in \overline{K}\br{E'} $, so $ \phi^*f = g^n = \br{\phi^*h}^n = \phi^*h^n $, so $ f = h^n $, so $ \div h = \br{T} - \br{\OOO} $, so $ T = \OOO $. We have shown the injection
$$ \function{E'\sbr{\widehat{\phi}}}{\Hom\br{E\sbr{\phi}, \mu_n}}{T}{\br{S \mapsto \e_\phi\br{S, T}}}. $$
This map is an isomorphism since $ \#E\sbr{\phi} = \#E'\sbr{\widehat{\phi}} = n $.
\end{itemize}
\end{proof}

\begin{remark*}
\hfill
\begin{itemize}
\item If $ E, E', \phi $ are defined over $ K $ then $ \e_\phi $ is \textbf{Galois equivariant}, that is
$$ \e_\phi\br{\sigma\br{S}, \sigma\br{T}} = \sigma\br{\e_\phi\br{S, T}}, \qquad \sigma \in \Gal\br{\overline{K} / K}, \qquad S \in E\sbr{\phi}, \qquad T \in E'\sbr{\widehat{\phi}}. $$
\item Taking $ \phi = \sbr{n} : E \to E $, so $ \widehat{\phi} = \sbr{n} $, gives
$$ \e_n : E\sbr{n} \times E\sbr{n} \to \mu_n, $$
since $ \e_n $ is bilinear.
\end{itemize}
\end{remark*}

\begin{corollary}
If $ E\sbr{n} \subset E\br{K} $ then $ \mu_n \subset K $.
\end{corollary}

\begin{proof}
Since $ \e_n $ is nondegenerate, there exist $ S, T \in E\sbr{n} $ such that $ \e_n\br{S, T} $ is a primitive $ n $-th root of unity, say $ \zeta_n $. To see this pick $ T \in E\sbr{n} $ of order $ n $. The group homomorphism
$$ \function{E\sbr{n}}{\mu_n}{S}{\e_n\br{S, T}} $$
has image $ \mu_d $ for some $ d \mid n $. Then $ \e_n\br{S, dT} = 1 $ for all $ S \in E\sbr{n} $. Since $ \e_n $ is nondegenerate, $ dT = 0 $, so $ d = n $. Then
$$ \sigma\br{\zeta_n} = \e_n\br{\sigma\br{S}, \sigma\br{T}} = \e_n\br{S, T} = \zeta_n, \qquad \sigma \in \Gal\br{\overline{K} / K}, $$
by Galois equivariance and since $ S, T \in E\br{K} $. Thus $ \zeta_n \in K $.
\end{proof}

\begin{example*}
There does not exist $ E / \QQ $ such that $ E\br{\QQ}_{\tors} \cong \br{\ZZ / 3\ZZ}^2 $.
\end{example*}

\begin{remark*}
In fact the Weil pairing $ \e_n $ is \textbf{alternating}, that is $ \e_n\br{T, T} = 1 $ for all $ T \in E\sbr{n} $. In particular expanding $ \e_n\br{S + T, S + T} $, show $ \e_n\br{S, T} = \e_n\br{T, S}^{-1} $.
\end{remark*}

\pagebreak

\section{Galois cohomology}

\subsection{Group cohomology}

\lecture{21}{Wednesday}{25/11/20}

Let $ G $ be a group, and let $ A $ be a \textbf{$ G $-module}, that is an abelian group with an action of $ G $ via group homomorphisms, or a $ \ZZ\sbr{G} $-module.

\begin{definition*}
The \textbf{zeroth cohomology group} is
$$ \H^0\br{G, A} = A^G = \cbr{a \in A \st \forall \sigma \in G, \ \sigma\br{a} = a}. $$
The \textbf{cochains}
$$ \C^1\br{G, A} = \cbr{\text{maps} \ G \to A} $$
contains the \textbf{cocycles}
$$ \Z^1\br{G, A} = \cbr{\br{a_\sigma}_{\sigma \in G} \st a_{\sigma\tau} = \sigma\br{a_\tau} + a_\sigma}, $$
which contains the \textbf{coboundaries}
$$ \B^1\br{G, A} = \cbr{\br{\sigma\br{b} - b}_{\sigma \in G} \st b \in A}. $$
The \textbf{first cohomology group} is
$$ \H^1\br{G, A} = \Z^1\br{G, A} / \B^1\br{G, A}. $$
\end{definition*}

\begin{remark*}
If $ G $ acts trivially on $ A $ then $ \H^1\br{G, A} = \Hom\br{G, A} $.
\end{remark*}

\begin{theorem}
A short exact sequence of $ G $-modules
$$ 0 \to A \xrightarrow{\phi} B \xrightarrow{\psi} C \to 0 $$
gives rise to a long exact sequence of abelian groups
$$ 0 \to A^G \xrightarrow{\phi} B^G \xrightarrow{\psi} C^G \xrightarrow{\delta} \H^1\br{G, A} \xrightarrow{\phi_*} \H^1\br{G, B} \xrightarrow{\psi_*} \H^1\br{G, C}. $$
\end{theorem}

\begin{proof}
Omitted except the definition of $ \delta $. Let $ c \in C^G $. There exists $ b \in B $ such that $ \psi\br{b} = c $. Then $ \psi\br{\sigma\br{b} - b} = \sigma\br{c} - c = 0 $ for all $ \sigma \in G $, so $ \sigma\br{b} - b = \phi\br{a_\sigma} $ for some $ a_\sigma \in A $. Then
$$ \phi\br{a_{\sigma\tau} - \sigma\br{a_\tau} - a_\sigma} = \sigma\tau\br{b} - b - \sigma\br{\tau\br{b} - b} - \br{\sigma\br{b} - b} = 0, $$
so $ a_{\sigma\tau} = \sigma\br{a_\tau} + a_\sigma $. Thus $ \br{a_\sigma}_{\sigma \in G} \in \Z^1\br{G, A} $. We define
$$ \delta\br{c} = \sbr{\br{a_\sigma}_{\sigma \in G}} \in \H^1\br{G, A}. $$
\end{proof}

\begin{theorem}
Let $ A $ be a $ G $-module and $ H \triangleleft G $ a normal subgroup. There is an \textbf{inflation-restriction} exact sequence
$$ 0 \to \H^1\br{G / H, A^H} \xrightarrow{\inf} \H^1\br{G, A} \xrightarrow{\res} \H^1\br{H, A}. $$
\end{theorem}

\begin{proof}
Omitted.
\end{proof}

\subsection{Galois cohomology}

Let $ K $ be a perfect field. Then $ \Gal\br{\overline{K} / K} $ is a topological group with basis of open subgroups the $ \Gal\br{\overline{K} / L} $ for $ \sbr{L : K} < \infty $. If $ G = \Gal\br{\overline{K} / K} $ we modify the definition of $ \H^1\br{G, A} $ by insisting
\begin{itemize}
\item the stabiliser of each $ a \in A $ is an open subgroup of $ G $, and
\item all cochains $ G \to A $ are continuous where $ A $ is given the discrete topology.
\end{itemize}
Then
$$ \H^1\br{\Gal\br{\overline{K} / K}, A} = \varinjlim_{L / K \ \text{finite Galois extension}} \H^1\br{\Gal\br{L / K}, A^{\Gal\br{\overline{K} / L}}}, $$
where the direct limit is with respect to inflation maps.

\pagebreak

\begin{theorem*}[Hilbert's theorem 90]
Let $ L / K $ be a finite Galois extension. Then
$$ \H^1\br{\Gal\br{L / K}, L^*} = 0. $$
\end{theorem*}

\begin{proof}
Let $ G = \Gal\br{L / K} $. Let $ \br{a_\sigma}_{\sigma \in G} \in \Z^1\br{G, L^*} $. Distinct automorphisms are linearly independent, so there exists $ y \in L $ such that
$$ x = \sum_{\tau \in G} a_\tau^{-1}\tau\br{y} \ne 0. $$
For $ \sigma \in G $, $ a_{\sigma\tau} = \sigma\br{a_\tau}a_\sigma $, so $ \sigma\br{a_\tau}^{-1} = a_\sigma a_{\sigma\tau}^{-1} $. Then
$$ \sigma\br{x} = \sum_{\tau \in G} \sigma\br{a_\tau}^{-1}\sigma\tau\br{y} = a_\sigma\sum_{\tau \in G} a_{\sigma\tau}^{-1}\sigma\tau\br{y} = a_\sigma x, $$
so $ a_\sigma = \sigma\br{x} / x $. Thus $ \br{a_\sigma}_{\sigma \in G} \in \B^1\br{G, L^*} $, so $ \H^1\br{G, L^*} = 0 $.
\end{proof}

A corollary is
$$ \H^1\br{\Gal\br{\overline{K} / K}, \overline{K}^*} = 0. $$

\subsection{Application to Kummer theory}

Assume $ \ch K \nmid n $. There is an exact sequence of $ \Gal\br{\overline{K} / K} $-modules
$$ 0 \to \mu_n \to \overline{K}^* \xrightarrow{x \mapsto x^n} \overline{K}^* \to 0. $$
The long exact sequence is
$$ K^* \xrightarrow{x \mapsto x^n} K^* \to \H^1\br{\Gal\br{\overline{K} / K}, \mu_n} \to \H^1\br{\Gal\br{\overline{K} / K}, \overline{K}^*} = 0, $$
by Hilbert 90, so
$$ \H^1\br{\Gal\br{\overline{K} / K}, \mu_n} \cong K^* / \br{K^*}^n. $$
If $ \mu_n \subset K $ then
\begin{equation}
\label{eq:16}
\Hom_{\cts}\br{\Gal\br{\overline{K} / K}, \mu_n} \cong K^* / \br{K^*}^n.
\end{equation}
If $ L / K $ is a finite Galois extension then $ \pi : \Gal\br{\overline{K} / K} \twoheadrightarrow \Gal\br{L / K} $, so there is an injection
$$ \function{\Hom\br{\Gal\br{L / K}, \mu_n}}{\Hom_{\cts}\br{\Gal\br{\overline{K} / K}, \mu_n}}{\chi}{\chi \circ \pi}. $$
We claim that every finite subgroup $ \Xi $ of $ \Hom_{\cts}\br{\Gal\br{\overline{K} / K}, \mu_n} $ arises uniquely in this way for $ L / K $ a finite abelian extension of exponent dividing $ n $. So from $ \br{\ref{eq:16}} $ we recover Theorem \ref{thm:11.2}. To prove the claim, consider the pairing
$$ \function{\Gal\br{\overline{K} / K} \times \Xi}{\mu_n}{\br{\sigma, \chi}}{\chi\br{\sigma}}. $$
This is bilinear, has trivial right kernel, and left kernel is $ \bigcap_{\chi \in \Xi} \ker \chi \subset \Gal\br{\overline{K} / K} $, an open normal subgroup, so $ \bigcap_{\chi \in \Xi} \ker \chi = \Gal\br{\overline{K} / L} $ for some $ L / K $ finite Galois. We get a nondegenerate pairing
$$ \Gal\br{L / K} \times \Xi \to \mu_n. $$
In particular
$$ \Gal\br{L / K} \hookrightarrow \Hom\br{\Xi, \mu_n}, $$
so $ L / K $ is abelian of exponent dividing $ n $, and
$$ \Xi \hookrightarrow \Hom\br{\Gal\br{L / K}, \mu_n}. $$
This proves the claim.

\pagebreak

\begin{notation*}
$ \H^1\br{K, -} $ means $ \H^1\br{\Gal\br{\overline{K} / K}, -} $.
\end{notation*}

\begin{lemma}
\label{lem:15.3}
Let $ \sbr{K : \QQ_p} < \infty $ with $ p \nmid n $. Then
$$ \ker \br{\H^1\br{K, \mu_n} \to \H^1\br{K^{\ur}, \mu_n}} \cong \OOO_K^\times / \br{\OOO_K^\times}^n. $$
\end{lemma}

\begin{proof}
By Hilbert 90 it suffices to show the sequence
$$ 0 \to \OOO_K^\times / \br{\OOO_K^\times}^n \xrightarrow{\alpha} K^* / \br{K^*}^n \xrightarrow{\beta} \br{K^{\ur}}^* / \br{\br{K^{\ur}}^*}^n $$
is exact.
\begin{itemize}[leftmargin=1in]
\item[$ \im \alpha \subset \ker \beta $.] Let $ a \in \OOO_K^\times $. If $ f\br{x} = x^n - a \in \OOO_K\sbr{x} $ then $ \widetilde{f}\br{x} = x^n - \widetilde{a} \in \kappa\sbr{x} $ has distinct roots in $ \overline{\kappa} $, using $ p \nmid n $ here. Then $ K\br{\sqrt[n]{a}} / K $ is unramified, so $ a \in \br{\br{K^{\ur}}^*}^n $.
\item[$ \ker \beta \subset \im \alpha $.] Let $ x\br{K^*}^n \in \ker \beta $. Write $ x = u\pi^r $ with $ u \in \OOO_K^\times $ and $ r \in \ZZ $. Since the discrete valuation in $ K $ extends to $ K^{\ur} $ we have $ r \equiv 0 \mod n $, so $ x\br{K^*}^n = u\br{K^*}^n $.
\end{itemize}
\end{proof}

\subsection{The Selmer and Tate-Shafarevich groups}

\lecture{22}{Friday}{27/11/20}

Let $ \phi : E \to E' $ be an isogeny of elliptic curves over $ K $. There is a short exact sequence of $ \Gal\br{\overline{K} / K} $-modules
$$ 0 \to E\sbr{\phi} \to E \xrightarrow{\phi} E' \to 0. $$
The long exact sequence is
$$ E\br{K} \xrightarrow{\phi} E'\br{K} \xrightarrow{\delta} \H^1\br{K, E\sbr{\phi}} \to \H^1\br{K, E} \xrightarrow{\phi_*} \H^1\br{K, E'}. $$
We get a short exact sequence
$$ 0 \to E'\br{K} / \phi\br{E\br{K}} \xrightarrow{\delta} \H^1\br{K, E\sbr{\phi}} \to \H^1\br{K, E}\sbr{\phi_*} \to 0. $$
Now take $ K $ a number field. For each place $ v $ fix an embedding $ \overline{K} \subset \overline{K_v} $. Then $ \Gal\br{\overline{K_v} / K_v} \subset \Gal\br{\overline{K} / K} $, so
$$
\begin{tikzcd}
0 \arrow{r} & E'\br{K} / \phi\br{E\br{K}} \arrow{r}{\delta} \arrow{d} & \H^1\br{K, E\sbr{\phi}} \arrow{r} \arrow{d}[swap]{\res_v} \arrow[dashed]{dr} & \H^1\br{K, E}\sbr{\phi_*} \arrow{r} \arrow{d}{\res_v} & 0 \\
0 \arrow{r} & \displaystyle\prod_v E'\br{K_v} / \phi\br{E\br{K_v}} \arrow{r}[swap]{\delta_v} & \displaystyle\prod_v \H^1\br{K_v, E\sbr{\phi}} \arrow{r} & \displaystyle\prod_v \H^1\br{K_v, E}\sbr{\phi_*} \arrow{r} & 0
\end{tikzcd}.
$$

\begin{definition*}
The \textbf{$ \phi $-Selmer group} is
\begin{align*}
\S^{\br{\phi}}\br{E / K}
& = \ker \br{\H^1\br{K, E\sbr{\phi}} \to \prod_v \H^1\br{K_v, E}} \\
& = \cbr{\alpha \in \H^1\br{K, E\sbr{\phi}} \st \forall v, \ \res_v\br{\alpha} \in \im \delta_v}.
\end{align*}
The \textbf{Tate-Shafarevich group} is
$$ \Sha\br{E / K} = \ker \br{\H^1\br{K, E} \to \prod_v \H^1\br{K_v, E}}. $$
\end{definition*}

We get a short exact sequence
$$ 0 \to E'\br{K} / \phi\br{E\br{K}} \to \S^{\br{\phi}}\br{E / K} \to \Sha\br{E / K}\sbr{\phi_*} \to 0. $$
Taking $ \phi = \sbr{n} $ gives
$$ 0 \to E\br{K} / nE\br{K} \to \S^{\br{n}}\br{E / K} \to \Sha\br{E / K}\sbr{n} \to 0. $$
Re-organising the proof of weak Mordell-Weil gives the following.

\pagebreak

\begin{theorem}
$ \S^{\br{n}}\br{E / K} $ is finite.
\end{theorem}

\begin{proof}
For $ L / K $ a finite Galois extension there is an exact sequence
$$
\begin{tikzcd}[row sep=tiny]
0 \arrow{r} & \H^1\br{\Gal\br{L / K}, E\br{L}\sbr{n}} \arrow{r}{\inf} & \H^1\br{K, E\sbr{n}} \arrow{r}{\res} & \H^1\br{L, E\sbr{n}} \\
& & \S^{\br{n}}\br{E / K} \arrow[subset]{u} \arrow{r} & \S^{\br{n}}\br{E / L} \arrow[subset]{u}
\end{tikzcd},
$$
where $ \H^1\br{\Gal\br{L / K}, E\br{L}\sbr{n}} $ is finite. By extending our field we may assume $ E\sbr{n} \subset E\br{K} $, and hence $ \mu_n \subset K $, so $ E\sbr{n} \cong \mu_n \times \mu_n $ as a Galois module. By Hilbert 90,
$$ \H^1\br{K, E\sbr{n}} \cong \H^1\br{K, \mu_n} \times \H^1\br{K, \mu_n} \cong K^* / \br{K^*}^n \times K^* / \br{K^*}^n. $$
Let
$$ S = \cbr{\text{primes of bad reduction for} \ E / K} \cup \cbr{v \mid n\infty}. $$
Note that this is a finite set of places. Define the subgroup of $ \H^1\br{K, A} $ unramified outside $ S $ by
$$ \H^1\br{K, A; S} = \ker \br{\H^1\br{K, A} \to \prod_{v \notin S} \H^1\br{K_v^{\ur}, A}}. $$
There is a commutative diagram with exact rows
$$
\begin{tikzcd}
E\br{K_v} \arrow{r}{\cdot n} \arrow[subset]{d} & E\br{K_v} \arrow{r}{\delta_v} \arrow[subset]{d} & \H^1\br{K_v, E\sbr{n}} \arrow{d}{\res} \\
E\br{K_v^{\ur}} \arrow{r}[swap]{\cdot n} & E\br{K_v^{\ur}} \arrow{r}[swap]{0} & \H^1\br{K_v^{\ur}, E\sbr{n}}
\end{tikzcd}.
$$
The map $ \cdot n : E\br{K_v^{\ur}} \to E\br{K_v^{\ur}} $ is surjective for all $ v \notin S $, by the proof of Theorem \ref{thm:9.9}, so $ \im \delta_v \subset \ker \res $. Then
\begin{align*}
\S^{\br{n}}\br{E / K}
& = \cbr{\alpha \in \H^1\br{K, E\sbr{n}} \st \forall v, \ \res_v\br{\alpha} \in \im \delta_v} \\
& \subset \H^1\br{K, E\sbr{n}; S}
\cong \H^1\br{K, \mu_n; S} \times \H^1\br{K, \mu_n; S}
\cong K\br{S, n} \times K\br{S, n},
\end{align*}
by Lemma \ref{lem:15.3}, noting that $ \cbr{v \mid n} \subset S $. But $ K\br{S, n} $ is finite by Lemma \ref{lem:11.4}, so $ \S^{\br{n}}\br{E / K} $ is finite.
\end{proof}

\begin{remark*}
$ \S^{\br{n}}\br{E / K} $ is finite and effectively computable. It is conjectured that $ \abs{\Sha\br{E / K}} < \infty $. This would imply that $ \rk E\br{K} $ is effectively computable.
\end{remark*}

\pagebreak

\section{Descent by cyclic isogeny}

\subsection{Descent by \texorpdfstring{$ n $}{n}-isogeny}

Let $ E $ and $ E' $ be elliptic curves over a number field $ K $, and let $ \phi : E \to E' $ be an isogeny of degree $ n $. Suppose $ E'\sbr{\widehat{\phi}} \cong \ZZ / n\ZZ $ is generated by $ T \in E'\br{K} $. Then there is an isomorphism of Galois modules
$$ \function{E\sbr{\phi}}{\mu_n}{S}{\e_\phi\br{S, T}}. $$
The short exact sequence of $ \Gal\br{\overline{K} / K} $-modules
$$ 0 \to \mu_n \to E \xrightarrow{\phi} E' \to 0 $$
gives a long exact sequence
$$
\begin{tikzcd}
E\br{K} \arrow{r} & E'\br{K} \arrow{r}{\delta} \arrow{dr}[swap]{\alpha} & \H^1\br{K, \mu_n} \arrow{r} \arrow{d}{\text{Hilbert 90}}[swap]{\sim} & \H^1\br{K, E} \\
& & K^* / \br{K^*}^n &
\end{tikzcd}.
$$

\begin{theorem}
\label{thm:16.1}
Let $ f \in K\br{E'} $ and $ g \in K\br{E} $ with $ \div f = n\br{T} - n\br{\OOO} $ and $ \phi^*f = g^n $. Then
$$ \alpha\br{P} = f\br{P} \mod \br{K^*}^n, \qquad P \in E'\br{K} \setminus \cbr{\OOO, T}. $$
\end{theorem}

\begin{proof}
Let $ Q \in \phi^{-1}\br{P} $. Then $ \delta\br{P} $ is represented by the cocycle $ \sigma \mapsto \sigma\br{Q} - Q \in E\sbr{\phi} \cong \mu_n $. For any $ X \in E $ not a zero or pole of $ g $,
$$ \e_\phi\br{\sigma\br{Q} - Q, T} = \dfrac{g\br{\sigma\br{Q} - Q + X}}{g\br{X}} = \dfrac{g\br{\sigma\br{Q}}}{g\br{Q}} = \dfrac{\sigma\br{g\br{Q}}}{g\br{Q}} = \dfrac{\sigma\br{\sqrt[n]{f\br{P}}}}{\sqrt[n]{f\br{P}}}, $$
taking $ X = Q $, noting that $ f\br{P} = g\br{Q}^n $, so $ \delta\br{P} $ is represented by the cocycle $ \sigma \mapsto \sigma\br{\sqrt[n]{f\br{P}}} / \sqrt[n]{f\br{P}} $. But there is an isomorphism
$$ \function{K^* / \br{K^*}^n}{\H^1\br{K, \mu_n}}{x}{\br{\sigma \mapsto \dfrac{\sigma\br{\sqrt[n]{x}}}{\sqrt[n]{x}}}}, $$
so $ \alpha\br{P} = f\br{P} \mod \br{K^*}^n $.
\end{proof}

\subsection{Descent by \texorpdfstring{$ 2 $}{2}-isogeny}

\lecture{23}{Monday}{30/11/20}

Let $ E $ be $ y^2 = x\br{x^2 + ax + b} $ where $ b\br{a^2 - 4b} \ne 0 $, let $ E' $ be $ y^2 = x\br{x^2 + a'x + b'} $ where $ a' = -2a $ and $ b' = a^2 - 4b $, and let
$$ \function[\phi]{E}{E'}{\br{x, y}}{\br{\br{\dfrac{y}{x}}^2, \dfrac{y\br{x^2 - b}}{x^2}}}, \qquad \function[\widehat{\phi}]{E'}{E}{\br{x, y}}{\br{\dfrac{1}{4}\br{\dfrac{y}{x}}^2, \dfrac{y\br{x^2 - b'}}{8x^2}}}. $$
Then $ E\sbr{\phi} = \cbr{\OOO, T} $ where $ T = \br{0, 0} \in E\br{K} $ and $ E'\sbr{\widehat{\phi}} = \cbr{\OOO, T'} $ where $ T' = \br{0, 0} \in E'\br{K} $.

\begin{proposition}
There is a group homomorphism
$$ \function{E'\br{K}}{K^* / \br{K^*}^2}{\br{x, y}}{
\begin{cases}
x \mod \br{K^*}^2 & x \ne 0 \\
b' \mod \br{K^*}^2 & x = 0
\end{cases}
}, $$
with kernel $ \phi\br{E\br{K}} $.
\end{proposition}

\begin{proof}
Either apply Theorem \ref{thm:16.1} with $ f = x \in K\br{E'} $ and $ g = y / x \in K\br{E} $, or direct calculation. See example sheet $ 4 $.
\end{proof}

\pagebreak

Let
$$ \alpha_E : E\br{K} / \widehat{\phi}\br{E'\br{K}} \hookrightarrow K^* / \br{K^*}^2, \qquad \alpha_{E'} : E'\br{K} / \phi\br{E\br{K}} \hookrightarrow K^* / \br{K^*}^2. $$

\begin{lemma}
$$ 2^{\rk E\br{K}} = \dfrac{\abs{\im \alpha_E} \cdot \abs{\im \alpha_{E'}}}{4}. $$
\end{lemma}

\begin{proof}
If $ f : A \to B $ and $ g : B \to C $ are homomorphisms of abelian groups then there is an exact sequence
$$ 0 \to \ker f \to \ker gf \xrightarrow{f} \ker g \to \coker f \xrightarrow{g} \coker gf \to \coker g \to 0. $$
Since $ \widehat{\phi} \circ \phi = \sbr{2}_E $ we get an exact sequence
$$
\begin{tikzcd}
& \ZZ / 2\ZZ & & \ZZ / 2\ZZ & \\
0 \arrow{r} & E\br{K}\sbr{\phi} \arrow[cong]{u} \arrow{r} & E\br{K}\sbr{2} \arrow{r}{\phi} & E'\br{K}\sbr{\widehat{\phi}} \arrow[cong]{u} \arrow[in=180, out=0, overlay]{dll} \\
& E'\br{K} / \phi\br{E\br{K}} \arrow{r}[swap]{\widehat{\phi}} \arrow[cong]{d} & E\br{K} / 2E\br{K} \arrow{r} & E\br{K} / \widehat{\phi}\br{E'\br{K}} \arrow{r} \arrow[cong]{d} & 0 \\
& \im \alpha_{E'} & & \im \alpha_E &
\end{tikzcd},
$$
so $ \abs{E\br{K} / 2E\br{K}} / \abs{E\br{K}\sbr{2}} = \abs{\im \alpha_E} \cdot \abs{\im \alpha_{E'}} / 2 \cdot 2 $. By the Mordell-Weil theorem, $ E\br{K} \cong \Delta \times \ZZ^r $ for $ \Delta $ a finite group and $ r = \rk E\br{K} $, so $ E\br{K} / 2E\br{K} \cong \Delta / 2\Delta \times \br{\ZZ / 2\ZZ}^r $ and $ E\br{K}\sbr{2} \cong \Delta\sbr{2} $. Then $ \Delta / 2\Delta $ and $ \Delta\sbr{2} $ have the same order, since $ \Delta $ is finite. Thus $ \abs{E\br{K} / 2E\br{K}} / \abs{E\br{K}\sbr{2}} = 2^r $.
\end{proof}

\begin{lemma}
If $ K $ is a number field and $ a, b \in \OOO_K $ then $ \im \alpha_E \subset K\br{S, 2} $ where $ S = \cbr{\text{primes dividing} \ b} $.
\end{lemma}

\begin{proof}
Must show that if $ x, y \in K $ such that $ y^2 = x\br{x^2 + ax + b} $ and $ \v_\ppp\br{b} = 0 $ then $ \v_\ppp\br{x} \equiv 0 \mod 2 $.
\begin{itemize}[leftmargin=0.5in]
\item[$ \v_\ppp\br{x} < 0 $.] By Lemma \ref{lem:9.1}, $ \v_\ppp\br{x} = -2r $ and $ \v_\ppp\br{y} = -3r $ for some $ r \ge 1 $.
\item[$ \v_\ppp\br{x} > 0 $.] Since $ \v_\ppp\br{x^2 + ax + b} = 0 $, $ \v_\ppp\br{x} = \v_\ppp\br{y^2} = 2\v_\ppp\br{y} $.
\end{itemize}
\end{proof}

\begin{lemma}
If $ b_1b_2 = b $ then $ b_1\br{K^*}^2 \in \im \alpha_E $ if and only if
\begin{equation}
\label{eq:17}
w^2 = b_1u^4 + au^2v^2 + b_2v^4
\end{equation}
is soluble for $ u, v, w \in K $ not all zero.
\end{lemma}

\begin{proof}
If $ b_1 \in \br{K^*}^2 $ or $ b_2 \in \br{K^*}^2 $ then both conditions are satisfied. So we may assume $ b_1, b_2 \notin \br{K^*}^2 $. Then $ b_1\br{K^*}^2 \in \im \alpha_E $ if and only if there exists $ \br{x, y} \in E\br{K} $ such that $ x = b_1t^2 $ for some $ t \in K^* $, so $ y^2 = b_1t^2\br{\br{b_1t^2}^2 + ab_1t^2 + b} $, so $ \br{y / b_1t}^2 = b_1t^4 + at^2 + b_2 $. So $ \br{\ref{eq:17}} $ has a solution $ u = t $, $ v = 1 $, and $ w = y / b_1t $. Conversely if $ \br{u, v, w} $ is a solution to $ \br{\ref{eq:17}} $ then $ uv \ne 0 $ and $ \br{b_1\br{u / v}^2, b_1\br{uw / v^3}} \in E\br{K} $.
\end{proof}

Now take $ K = \QQ $. Then
$$
\begin{tikzcd}[row sep=tiny]
0 \arrow{r} & E'\br{\QQ} / \phi\br{E\br{\QQ}} \arrow{r}{\delta} \arrow{dr}[swap]{\alpha_{E'}} & \S^{\br{\phi}}\br{E / \QQ} \arrow{r} \arrow[subset]{d} & \Sha\br{E / \QQ}\sbr{\phi_*} \arrow{r} & 0 \\
& & \QQ^* / \br{\QQ^*}^2 & &
\end{tikzcd},
$$
so
$$ \im \alpha_{E'} = \cbr{b_1\br{\QQ^*}^2 \st \br{\ref{eq:17}}' \ \text{is soluble over} \ \QQ} $$
is contained in
$$ \S^{\br{\phi}}\br{E / \QQ} = \cbr{b_1\br{\QQ^*}^2 \st \br{\ref{eq:17}}' \ \text{is soluble over} \ \RR \ \text{and} \ \text{over} \ \QQ_p \ \text{for all primes} \ p}, $$
where $ \br{\ref{eq:17}}' $ means $ \br{\ref{eq:17}} $ with $ a $ and $ b $ replaced by $ a' $ and $ b' $.

\pagebreak

\begin{fact*}
If $ a, b_1, b_2 \in \ZZ $ and $ p \nmid 2b\br{a^2 - 4b} $ then $ \br{\ref{eq:17}} $ is soluble over $ \QQ_p $. Uses example sheet $ 3 $, question $ 9 $ and Hensel's lemma.
\end{fact*}

\begin{example*}
Let $ E $ be $ y^2 = x^3 - x $, so $ a = 0 $ and $ b = -1 $. Then $ \im \alpha_E = \abr{-1} \subset \QQ^* / \br{\QQ^*}^2 $. Let $ E' $ be $ y^2 = x^3 + 4x $. Then $ \im \alpha_{E'} \subset \abr{-1, 2} \subset \QQ^* / \br{\QQ^*}^2 $.
\begin{itemize}
\item If $ b_1 = -1 $, then $ w^2 = -u^4 - 4v^4 $ is insoluble over $ \RR $.
\item If $ b_1 = 2 $, then $ w^2 = 2u^4 + 2v^4 $ has solution $ \br{u, v, w} = \br{1, 1, 2} $.
\item If $ b_1 = -2 $, then $ w^2 = -2u^4 - 2v^4 $ is insoluble over $ \RR $.
\end{itemize}
Thus $ \im \alpha_{E'} = \abr{2} \subset \QQ^* / \br{\QQ^*}^2 $. Thus $ \rk E\br{\QQ} = 0 $, so $ 1 $ is not a congruent number.
\end{example*}

\lecture{24}{Wednesday}{02/12/20}

\begin{example*}
Let $ E $ be $ y^2 = x^3 + px $ for $ p $ prime such that $ p \equiv 5 \mod 8 $. If $ b_1 = -1 $, then $ w^2 = -u^4 - pv^4 $ is insoluble over $ \RR $. Thus $ \im \alpha_E = \abr{p} \subset \QQ^* / \br{\QQ^*}^2 $. Let $ E' $ be $ y^2 = x^3 - 4px $. Then $ \im \alpha_{E'} \subset \abr{-1, 2, p} \subset \QQ^* / \br{\QQ^*}^2 $. Note that $ \alpha_{E'}\br{T'} = -4p\br{\QQ^*}^2 = -p\br{\QQ^*}^2 $.
\begin{itemize}
\item If $ b_1 = 2 $, then $ w^2 = 2u^4 - 2pv^4 $. Suppose this is soluble. Without loss of generality $ u, v, w \in \ZZ $ such that $ \gcd\br{u, v} = 1 $. If $ p \mid u $ then $ p \mid w $ and then $ p \mid v $, a contradiction. Then $ w^2 \equiv 2u^4 \not\equiv 0 \mod p $, so $ \br{\tfrac{2}{p}} = 1 $, a contradiction since $ p \equiv 5 \mod 8 $.
\item If $ b_1 = -2 $, then $ w^2 = -2u^4 + 2pv^4 $. Likewise this has no solution since $ \br{\tfrac{-2}{p}} = -1 $.
\item If $ b_1 = p $, then $ w^2 = pu^4 - 4v^4 $.
\begin{itemize}
\item This is soluble over $ \QQ_p $ since $ \br{\tfrac{-1}{p}} = 1 $, so by Hensel's lemma $ -1 \in \br{\ZZ_p^\times}^2 $.
\item This is soluble over $ \QQ_2 $ since $ p - 4 \equiv 1 \mod 8 $, so by Hensel's lemma $ p - 4 \in \br{\ZZ_2^\times}^2 $.
\item This is soluble over $ \RR $ since $ \sqrt{p} \in \RR $.
\end{itemize}
Over $ \QQ $,
$$
\begin{array}{c|ccccc}
p & 5 & 13 & 29 & 37 & 53 \\
\hline
u & 1 & 1 & 1 & 5 & 1 \\
v & 1 & 1 & 1 & 3 & 1 \\
w & 1 & 3 & 5 & 151 & 7
\end{array}.
$$
\end{itemize}
Thus $ \im \alpha_{E'} \subset \abr{-1, p} \subset \QQ^* / \br{\QQ^*}^2 $, and
$$ \rk E\br{\QQ} =
\begin{cases}
0 & w^2 = pu^4 - 4v^4 \ \text{is insoluble over} \ \QQ \\
1 & w^2 = pu^4 - 4v^4 \ \text{is soluble over} \ \QQ
\end{cases}.
$$
The conjecture is that $ \rk E\br{\QQ} = 1 $ for all primes $ p \equiv 5 \mod 8 $.
\end{example*}

\begin{example*}[Lind]
Let $ E $ be $ y^2 = x^3 + 17x $. Then $ \im \alpha_E = \abr{17} \subset \QQ^* / \br{\QQ^*}^2 $. Let $ E' $ be $ y^2 = x^3 - 68x $. If $ b_1 = 2 $, then $ w^2 = 2u^4 - 34v^2 $. Replacing $ w $ by $ 2w $ and dividing by two, let $ C $ be $ 2w^2 = u^4 - 17v^4 $. Denote
$$ C\br{K} = \cbr{\br{u, v, w} \in K^3 \setminus \cbr{0} \st 2w^2 = u^4 - 17v^4} / \sim, $$
where $ \br{u, v, w} \sim \br{\lambda u, \lambda v, \lambda^2 w} $ for all $ \lambda \in K^* $. Then
\begin{itemize}
\item $ C\br{\QQ_2} \ne \emptyset $ since $ 17 \in \br{\ZZ_2^\times}^4 $,
\item $ C\br{\QQ_{17}} \ne \emptyset $ since $ 2 \in \br{\ZZ_{17}^\times}^2 $, and
\item $ C\br{\RR} \ne \emptyset $ since $ \sqrt{2} \in \RR $,
\end{itemize}
so $ C\br{\QQ_v} \ne \emptyset $ for all places $ v $ of $ \QQ $. Suppose $ \br{u, v, w} \in C\br{\QQ} $, without loss of generality $ u, v, w \in \ZZ $ such that $ \gcd\br{u, v} = 1 $ and $ w > 0 $. If $ 17 \mid w $ then $ 17 \mid u $ and then $ 17 \mid v $, a contradiction. So if $ p \mid w $ then $ p \ne 17 $ and $ \br{\tfrac{17}{p}} = 1 $ if $ p $ is odd, so $ \br{\tfrac{p}{17}} = \br{\tfrac{17}{p}} = 1 $, by quadratic reciprocity, but also $ \br{\tfrac{2}{17}} = 1 $. Thus $ \br{\tfrac{w}{17}} = 1 $. But $ 2w^2 \equiv u^4 \mod 17 $, so $ 2 \in \br{\FF_{17}^*}^4 = \cbr{\pm 1, \pm 4} $, a contradiction. Thus $ C\br{\QQ} = \emptyset $. That is, $ C $ is a counterexample to the Hasse principle. It represents a nontrivial element of $ \Sha\br{E / \QQ} $.
\end{example*}

\pagebreak

\appendix

\section{The Birch Swinnerton-Dyer conjecture}

Let $ E / \QQ $ be an elliptic curve.

\begin{definition*}
$ \L\br{E, s} = \prod_p \L_p\br{E, s} $ where
$$ \L_p\br{E, s} =
\begin{cases}
\br{1 - \a_pp^{-s} + p^{1 - 2s}}^{-1} & \text{good reduction} \\
\br{1 - p^{-s}}^{-1} & \text{split multiplicative reduction} \\
\br{1 + p^{-s}}^{-1} & \text{nonsplit multiplicative reduction} \\
1 & \text{additive reduction}
\end{cases},
$$
and $ \#\widetilde{E}\br{\FF_p} = p + 1 - \a_p $.
\end{definition*}

By Hasse's theorem, $ \abs{\a_p} \le 2\sqrt{p} $, so $ \L\br{E, s} $ converges for $ \Re s > \tfrac{3}{2} $.

\begin{theorem}[Wiles, Breuil, Conrad, Diamond, Taylor]
$ \L\br{E, s} $ is the $ \L $-function of a weight two modular form and hence has an analytic continuation to all of $ \CC $, and a functional equation that relates $ \L\br{E, s} $ and $ \L\br{E, 2 - s} $.
\end{theorem}

\begin{theorem}[Weak BSD]
$$ \ord_{s = 1} \L\br{E, s} = \rk E\br{\QQ}. $$
\end{theorem}

\begin{theorem}[Strong BSD]
If $ r = \rk E\br{\QQ} $, then
$$ \lim_{s \to 1} \dfrac{1}{\br{s - 1}^r}\L\br{E, s} = \dfrac{\Omega_E \cdot \Reg E\br{\QQ} \cdot \abs{\Sha\br{E / \QQ}} \cdot \prod_p \c_p}{\abs{E\br{\QQ}_{\tors}}^2}, $$
where
\begin{itemize}
\item the Tamagawa number of $ E / \QQ_p $ is
$$ \c_p = \sbr{E\br{\QQ_p} : E_0\br{\QQ_p}}, $$
\item if $ E\br{\QQ} / E\br{\QQ}_{\tors} \cong \abr{P_1, \dots, P_r} $ then the \textbf{regulator} of $ E / \QQ $ is
$$ \Reg E\br{\QQ} = \det \br{\sbr{P_i, P_j}}_{i, j = 1, \dots, r}, $$
where $ \sbr{P, Q} = \widehat{\h}\br{P + Q} - \widehat{\h}\br{P} - \widehat{\h}\br{Q} $, and
\item the \textbf{real period} of $ E / \QQ $ is
$$ \Omega_E = \intd{E\br{\RR}}{}{\dfrac{1}{\abs{2y + a_1x + a_3}}}{x}, $$
where $ a_i $ are the coefficients of a globally minimal Weierstrass equation.
\end{itemize}
\end{theorem}

\begin{theorem}[Kolyvagin]
If $ \ord_{s = 1} \L\br{E, s} = 0, 1 $ then weak BSD holds and $ \abs{\Sha\br{E / \QQ}} < \infty $.
\end{theorem}

\end{document}