\def\module{Algebraic Geometry}
\def\lecturer{Prof Mark Gross}
\def\term{Michaelmas 2020}
\def\cover{}
\def\syllabus{}
\def\thm{section}

\input{../style/header}

% Macros
\newcommand{\Sch}{\textbf{Sch}}
\newcommand{\Set}{\textbf{Set}}
\newcommand{\HOM}{\mathcal{H}om}

\begin{document}

\input{../style/cover}

\section{Brief review of classical algebraic geometry and motivation for scheme theory}

\lecture{1}{Friday}{09/10/20}

The following are the main references for the course.
\begin{itemize}
\item R Hartshorne, Algebraic geometry, 1977
\item U Goertz and T Wedhorn, Algebraic geometry I, 2010
\item R Vakil, The rising sea: foundations of algebraic geometry, 2017
\end{itemize}

\subsection{Classical algebraic geometry}

Throughout this discussion, we take the base field $ k $ to be algebraically closed. An \textbf{affine variety} $ V \subseteq \AA^n\br{k} $, where, once one has chosen coordinates, $ \AA^n\br{k} = k^n $, is given by the vanishing of polynomials $ f_1, \dots, f_r \in k\sbr{x_1, \dots, x_n} $. If $ I = \abr{f_1, \dots, f_r} \triangleleft k\sbr{x_1, \dots, x_n} $ is any ideal, we set
$$ \VV\br{I} = \cbr{z \in \AA^n \st \forall f \in I, \ f\br{z} = 0}. $$
First set $ \PP^n\br{k} = \br{k^{n + 1} \setminus \cbr{0}} / k^* $ with \textbf{homogeneous coordinates} $ \br{x_0 : \dots : x_n} $. A \textbf{projective variety} $ V \subseteq \PP^n $ is given by the vanishing of homogeneous polynomials $ F_1, \dots, F_r \in k\sbr{x_0, \dots, x_n} $. If $ I $ is the ideal generated by the homogeneous ideals $ F_i $, that is if $ F \in I $ then so are all its homogeneous parts, we set
$$ \VV\br{I} = \cbr{z \in \PP^n \st \forall F \in I \ \text{homogeneous}, \ F\br{z} = 0}. $$
If $ V = \VV\br{I} \subseteq \AA^n $, set
$$ \II\br{V} = \cbr{f \in k\sbr{x_1, \dots, x_n} \st \forall x \in V, \ f\br{x} = 0}. $$
Observe that $ \VV\br{\II\br{V}} = V $, by tautology, and $ \II\br{\VV\br{I}} \supseteq \sqrt{I} $, which is obvious. Recall that the \textbf{radical} $ \sqrt{I} $ of the ideal $ I $ is defined by $ f \in \sqrt{I} $ if and only if there exists $ m > 0 $ such that $ f^m \in I $. \textbf{Hilbert's Nullstellensatz} states that, noting $ k = \overline{k} $, $ \II\br{\VV\br{I}} = \sqrt{I} $. The \textbf{coordinate ring} is
$$ k\sbr{V} = k\sbr{x_1, \dots, x_n} / \II\br{V}. $$
This may be regarded as the ring of polynomial functions on $ V $, and it is a finitely generated reduced $ k $-algebra. Recall that a \textbf{$ k $-algebra} is a commutative ring containing $ k $ as a subring. It is \textbf{finitely generated} if it is the quotient of a polynomial ring over $ k $, and \textbf{reduced} if $ a^m = 0 $ implies that $ a = 0 $.

\subsection{Why schemes?}

A better question is what is wrong with varieties?
\begin{itemize}
\item With varieties, always work over algebraically closed fields. For example, let $ I = \abr{x^2 + y^2 + 1} \subseteq \RR\sbr{x, y} $. Then $ \VV\br{I} = \emptyset $, but $ I $ is a prime ideal, hence radical, so $ \II\br{\VV\br{I}} = \RR\sbr{x, y} \ne I $.
\item Number theory? Diophantine equations. If $ I \subseteq \ZZ\sbr{x_1, \dots, x_n} $ is an ideal, have $ \VV\br{I} \subseteq \ZZ^n $. For example, $ x^n + y^n = z^n $.
\item Why should we only consider radical, or prime, ideals? For example, a natural situation is
$$ X_1 = \VV\br{x - y^2} \subseteq \AA^2, \qquad X_2 = \VV\br{x} \subseteq \AA^2. $$
Then $ X_1 \cap X_2 = \VV\br{x - y^2, x} $. Note $ I = \abr{x - y^2, x} = \abr{x, y^2} $ is not a radical ideal, because $ y \notin I $ and $ y^2 \in I $ so $ y \not\in \sqrt{I} $. Recall the coordinate ring of $ X_i $ is $ k\sbr{X_i} = k\sbr{x, y} / I_i $. Then $ k\sbr{X_1 \cap X_2} = k\sbr{x, y} / \abr{x, y^2} \cong k\sbr{y} / \abr{y^2} $. So thinking of the coordinate ring of $ X_1 \cap X_2 $ as functions on $ X_1 \cap X_2 $, we have a function $ y $ whose square is zero, but is not itself zero.
\end{itemize}

\pagebreak

\subsection{Categorical philosophy}

What is a point? In the category of sets, objects are sets, and if $ A $ and $ B $ are sets, then morphisms are $ \Hom\br{A, B} $, the set of maps $ f : A \to B $. Let $ * $ be a one-element set. Then the elements of any set $ X $ are in one-to-one correspondence with $ \Hom\br{*, X} $. In the category of affine varieties, objects are affine varieties and morphisms are $ \Hom\br{X, Y} = \Hom_{\text{$ k $-alg}}\br{k\sbr{Y}, k\sbr{X}} $. In this category, a point is a single point with coordinate ring $ k $. Giving a morphism
$$ \cbr{\text{point}} \to X = \VV\br{I} \subseteq \AA^n, \qquad I \subseteq k\sbr{x_1, \dots, x_n}, $$
for $ I $ a radical ideal, is the same as giving a homomorphism
$$ \function[\phi]{k\sbr{X} = k\sbr{x_1, \dots, x_n} / I}{k}{x_i}{a_i}. $$
Note that $ \phi $ vanishes in $ I $ if and only if $ f\br{a_1, \dots, a_n} = 0 $ for all $ f \in I $, which is if and only if $ \br{a_1, \dots, a_n} \in \VV\br{I} = X $. Note $ \phi $ is surjective, and hence $ \ker \phi $ is a maximal ideal. With $ k $ algebraically closed, the maximal ideals at $ k\sbr{X} $ are all of the form $ \abr{x_1 - a_1, \dots, x_n - a_n} $ for $ \br{a_1, \dots, a_n} \in X $, a consequence of Hilbert's Nullstellensatz. That is, there exist one-to-one correspondences
$$ \cbr{\text{points of} \ X} \quad \leftrightsquigarrow \quad \cbr{\text{$ k $-algebra homomorphisms} \ \phi : k\sbr{X} \to k} \quad \leftrightsquigarrow \quad \cbr{\text{maximal ideals of} \ k\sbr{X}}. $$

\subsection{Solutions over non-algebraically closed fields}

What if $ k $ is not algebraically closed? We may want to consider solutions not just in $ k^n = \AA^n $ but $ \br{k'}^n $ for $ k' $ any field extension of $ k $. That is, we may consider $ k $-algebra homomorphisms
$$ \function[\phi]{k\sbr{X} = k\sbr{x_1, \dots, x_r} / I}{k'}{x_i}{a_i}. $$
This gives a tuple $ \br{a_1, \dots, a_n} \in \br{k'}^n $ with $ f\br{a_1, \dots, a_n} = 0 $ for all $ f \in I $. Then $ \phi $ need not be surjective, so can only say the image of $ \phi $ is a subring of a field, hence an integral domain. Thus $ \ker \phi $ is a prime ideal, and maximal if and only if $ \im \phi $ is a field.

\begin{example*}
The $ \RR $-algebra homomorphism
$$ \functions[\phi]{\RR\sbr{x, y} / \abr{x^2 + y^2 + 1}}{\CC}{x}{0}{y}{i} $$
is surjective with kernel $ \abr{x, y^2 + 1} $, since $ \RR\sbr{y} / \abr{y^2 + 1} \cong \CC $. This is a maximal ideal but is not of the form $ \abr{x - a, y - b} $ for $ \br{a, b} \in \RR^2 $. If instead we considered the map
$$ \functions{\RR\sbr{x, y} / \abr{x^2 + y^2 + 1}}{\CC}{x}{0}{y}{-i}, $$
we get the same kernel. That is, $ \br{0, i} $ and $ \br{0, -i} $ are solutions to $ x^2 + y^2 + 1 = 0 $, but they correspond to the same maximal ideal. In fact, this maximal ideal corresponds to a Galois orbit of $ \Gal\br{\CC / \RR} $ of solutions.
\end{example*}

\lecture{2}{Monday}{12/10/20}

There are more exotic points by taking even bigger fields.

\begin{example*}
Let $ k\br{X} $ be the field of fractions of $ k\sbr{X} = \RR\sbr{x, y} / \abr{x^2 + y^2 + 1} $. There is an inclusion
$$ \functions{k\sbr{X}}{k\br{X}}{f}{\dfrac{f}{1}}{\br{x, y}}{\br{x, y}}. $$
The kernel of this map is zero. This gives a solution to the equation $ x^2 + y^2 + 1 = 0 $ with coordinates in the field $ k\br{X} $. This solution is $ \br{x, y} \in \AA^2\br{k\br{X}} $.
\end{example*}

The moral is that once we start looking at solutions to equation over any field, then we get maps $ k\sbr{X} \to k' $ with kernel not necessarily maximal. What about solutions over rings?

\pagebreak

\begin{example*}
Let $ A = \ZZ\sbr{x_1, \dots, x_n} / I $, and let $ R $ be any commutative ring. We define an $ R $-valued point of $ \Spec A $ to be a ring homomorphism
$$ \function{A}{R}{x_i}{r_i}. $$
Then $ f\br{r_1, \dots, r_n} = 0 $ for all $ f \in I $. This gives a lot of flexibility. For example,
\begin{itemize}
\item $ R = \ZZ $ gives diophantine equations,
\item $ R = \FF_p $ gives solutions modulo $ p $, and
\item $ R = \QQ $ gives rational solutions.
\end{itemize}
\end{example*}

Take this to its logical conclusion. Let $ A $ be a ring, where all rings are commutative in this course. Given $ A $, we hope for some geometric object $ \Spec A $, the \textbf{spectrum} of $ A $. For a ring $ R $, the set of \textbf{$ R $-valued points} of $ X $ is
$$ X\br{R} = \Hom_{\text{ring}}\br{A, R}. $$
A morphism $ X = \Spec A \to Y = \Spec B $ should be the same thing as giving a morphism $ \phi : B \to A $. Define the category of \textbf{affine schemes} to be the opposite category to the category of rings. Define a \textbf{scheme} to be something which is locally isomorphic to an affine scheme. By analogy, a \textbf{manifold} is a topological space with an open cover $ \cbr{U_i} $ with each $ U_i $ homeomorphic to an open subset of $ \RR^n $. To make sense of the definition of schemes, we need a lot of language.

\subsection{Spectrum of a ring}

\begin{definition*}
Let $ A $ be a ring. Then
$$ \Spec A = \cbr{\ppp \subseteq A \st \ppp \ \text{a prime ideal}}. $$
For $ I \subseteq A $ an ideal, define
$$ \VV\br{I} = \cbr{\ppp \subseteq A \st \ppp \ \text{prime}, \ \ppp \supseteq I}. $$
\end{definition*}

\begin{proposition}
The sets $ \VV\br{I} $ form the closed sets of a topology on $ \Spec A $, called the \textbf{Zariski topology}.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item $ \VV\br{A} = \emptyset $.
\item $ \VV\br{0} = \Spec A $.
\item If $ \cbr{I_i}_{i \in J} $ is a collection of ideals, then
$$ \VV\br{\sum_{i \in J} I_i} = \bigcap_{i \in J} \VV\br{I_i}. $$
\item Claim that
$$ \VV\br{I_1 \cap I_2} = \VV\br{I_1} \cup \VV\br{I_2}. $$
\begin{itemize}
\item[$ \supseteq $] Obvious.
\item[$ \subseteq $] If $ \ppp \supseteq I_1 \cap I_2 $ is prime, then $ \ppp \supseteq I_1 $ or $ \ppp \supseteq I_2 $. See Atiyah-Macdonald, Proposition 1.11.ii. \footnote{Exercise: try to prove without looking up}
\end{itemize}
\end{itemize}
\end{proof}

\begin{example*}
Let $ A = k\sbr{x_1, \dots, x_n} $ with $ k $ algebraically closed and $ I \subseteq A $ an ideal. Then the maximal ideals $ \mmm $ of $ A $ containing $ I $ are in one-to-one correspondence with the zero set of $ I $ in $ \AA^n\br{k} $, so
$$ \correspondence{\abr{x_1 - a_1, \dots, x_n - a_n} \supseteq I, \ a_i \in k}{\br{a_1, \dots, a_n} \in \VV\br{I} \subseteq \AA^n\br{k}}. $$
\end{example*}

The new $ \VV\br{I} $ now extends this notion of zero set by including possible other prime ideals.

\begin{example*}
If $ k $ is a field, $ \Spec k = \cbr{0} $, so the topological space cannot see the field.
\end{example*}

We fix this by also thinking about what functions are on these spaces.

\pagebreak

\section{Sheaves}

Fix a topological space $ X $.

\subsection{Sheaves}

\begin{definition*}
A \textbf{presheaf} $ \FFF $ on $ X $ consists of the following data.
\begin{itemize}
\item For every open set $ U \subseteq X $ an abelian group $ \FFF\br{U} $.
\item Whenever given an inclusion $ V \subseteq U \subseteq X $, a \textbf{restriction map} $ \rho_{UV} : \FFF\br{U} \to \FFF\br{V} $, a homomorphism, such that
\begin{itemize}
\item $ \rho_{UU} = \id_{\FFF\br{U}} $, and
\item if $ W \subseteq V \subseteq U $, then $ \rho_{UW} = \rho_{VW} \circ \rho_{UV} $.
\end{itemize}
\end{itemize}
\end{definition*}

\begin{remark*}
Can think of a presheaf as a contravariant functor from the category of open sets of $ X $, the category whose objects are open subsets of $ X $ and whose morphisms are inclusions of open sets, to the category of abelian groups. Can replace the category of abelian groups with any desired category, such as commutative rings.
\end{remark*}

\begin{definition*}
A \textbf{morphism of presheaves} $ f : \FFF \to \GGG $ is a collection of homomorphisms $ f_U : \FFF\br{U} \to \GGG\br{U} $ such that for all $ V \subseteq U $ the diagram
$$
\begin{tikzcd}
\FFF\br{U} \arrow{r}{f_U} \arrow{d}[swap]{\rho_{UV}} & \GGG\br{U} \arrow{d}{\rho_{UV}} \\
\FFF\br{V} \arrow{r}[swap]{f_V} & \GGG\br{V}
\end{tikzcd}
$$
is commutative.
\end{definition*}

\begin{definition*}
A presheaf $ \FFF $ is a \textbf{sheaf} if it satisfies the following additional axioms.
\begin{enumerate}[label=S\arabic*.]
\item If $ U \subseteq X $ is covered by an open cover $ \cbr{U_i} $ and $ s \in \FFF\br{U} $ satisfies $ \eval{s}_{U_i} = \rho_{UU_i}\br{s} = 0 $ for all $ i $, then $ s = 0 $.
\item If $ U $ and $ \cbr{U_i} $ are as in S1 and $ s_i \in \FFF\br{U_i} $ such that $ \eval{s_i}_{U_i \cap U_j} = \eval{s_j}_{U_i \cap U_j} $ for all $ i $ and $ j $, then there exists $ s \in \FFF\br{U} $ with $ \eval{s}_{U_i} = s_i $ for all $ i $.
\end{enumerate}
\end{definition*}

\begin{remark*}
\hfill
\begin{itemize}
\item If $ \FFF $ is a sheaf, then $ \emptyset \subseteq X $ is covered by the empty covering, and hence $ \FFF\br{\emptyset} = 0 $.
\item S1 and S2 together can be described as saying, given $ U $ and $ \cbr{U_i}_{i \in I} $,
$$ 0 \to \FFF\br{U} \xrightarrow{\alpha} \prod_{i \in I} \FFF\br{U_i} \overset{\beta_1}{\underset{\beta_2}{\rightrightarrows}} \prod_{i, j} \FFF\br{U_i \cap U_j} $$
is exact, where
$$ \alpha\br{s} = \br{\eval{s}_{U_i}}_{i \in I}, \qquad \beta_1\br{\br{s_i}_{i \in I}} = \br{\eval{s_i}_{U_i \cap U_j}}_{i, j}, \qquad \beta_2\br{\br{s_i}_{i \in I}} = \br{\eval{s_j}_{U_i \cap U_j}}_{i, j}. $$
Exactness means
\begin{itemize}
\item $ \alpha $ is injective, which is S1,
\item $ \beta_1 \circ \alpha = \beta_2 \circ \alpha $, and
\item for any $ \br{s_i} \in \prod_{i \in I} \FFF\br{U_i} $, with $ \beta_1\br{\br{s_i}} = \beta_2\br{\br{s_i}} $, there exists $ s \in \FFF\br{U} $ with $ \alpha\br{s} = \br{s_i} $, which is S2.
\end{itemize}
\end{itemize}
\end{remark*}

\pagebreak

\subsection{Examples}

\lecture{3}{Wednesday}{14/10/20}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ X $ be any topological space, and let
$$ \FFF\br{U} = \cbr{\text{continuous functions} \ U \to \RR}. $$
This is a sheaf, by
$$ \function[\rho_{UV}]{\FFF\br{U}}{\FFF\br{V}}{f}{\eval{f}_V}. $$
\begin{enumerate}[label=S\arabic*.]
\item A continuous function is zero if it is zero on every open set of a cover.
\item Continuous functions can be glued.
\end{enumerate}
\item Let $ X = \CC $ with the Euclidean topology, and let
$$ \FFF\br{U} = \cbr{f : U \to \CC \st f \ \text{is a bounded analytic function}}. $$
This is a presheaf. It satisfies S1, and does not satisfy S2. For example, consider the cover $ \cbr{U_i}_{i \in \cbr{1, 2, \dots}} $ of $ \CC $ given by $ U_i = \cbr{z \in \CC \st \abs{z} < i} $ and
$$ \function[s_i]{U_i}{\CC}{z}{z}. $$
Note if $ i < j $, then $ U_i \cap U_j = U_i $ and $ \eval{s_i}_{U_i \cap U_j} = \eval{s_j}_{U_i \cap U_j} $. But if we glue we get the function $ z : \CC \to \CC $, which is not bounded. Note $ \FFF\br{\CC} = \CC $.
\item Take any group $ G $ and set $ \FFF\br{U} = G $ for any open set $ U $. This is called the \textbf{constant presheaf}. This is not a sheaf. Let $ U = U_1 \sqcup U_2 $. If we wanted a sheaf,
$$
\begin{tikzcd}
\FFF\br{U_1} = G \arrow{dr} & & \FFF\br{U_2} = G \arrow{dl} \\
& \FFF\br{U_1 \cap U_2} = \FFF\br{\emptyset} = 0 &
\end{tikzcd},
$$
so if S2 is satisfied, would want $ s_1 \in \FFF\br{U_1} $ and $ s_2 \in \FFF\br{U_2} $ to glue. We would then want to have $ \FFF\br{U} = G \times G $. Now give $ G $ the discrete topology, and define instead
$$ \FFF\br{U} = \cbr{f : U \to G \ \text{continuous}}, $$
that is $ f $ is locally constant. That is, if $ x \in U $, there exists a neighbourhood $ x \in V \subseteq U $ with $ \eval{f}_V $ constant. This is called the \textbf{constant sheaf} and if $ U $ is non-empty and connected, then $ \FFF\br{U} = G $.
\item If $ X $ is an algebraic variety, and $ U \subseteq X $ is a Zariski open subset, define
$$ \OOO_X\br{U} = \cbr{f : U \to k \st f \ \text{regular function}}. $$
Roughly $ f $ is \textbf{regular} means that every point of $ U $ has an open neighbourhood on which $ f $ is expressed as a ratio of polynomials $ g / h $ with $ h $ non-vanishing on the neighbourhood. Then $ \OOO_X $ is a sheaf, called the \textbf{structure sheaf} of $ X $.
\end{itemize}
\end{example*}

\subsection{Stalks}

\begin{definition*}
Let $ \FFF $ be a presheaf on $ X $. Let $ p \in X $. Then the \textbf{stalk} of $ \FFF $ at $ p $ is
$$ \FFF_p = \cbr{\br{U, s} \st U \subseteq X \ \text{is an open neighbourhood of} \ p, \ s \in \FFF\br{U}} / \equiv, $$
where $ \br{U, s} \equiv \br{V, s'} $ if there exists $ W \subseteq U \cap V $ also a neighbourhood of $ p $ such that $ \eval{s}_W = \eval{s'}_W $. An equivalence class of a pair $ \br{U, s} $ is called a \textbf{germ}.
\end{definition*}

\begin{remark*}
$ \FFF_p = \varinjlim_{p \in U} \FFF\br{U} $.
\end{remark*}

\pagebreak

Note that a morphism $ f : \FFF \to \GGG $ of presheaves induces a morphism
$$ \function[f_p]{\FFF_p}{\GGG_p}{\br{U, s}}{\br{U, f_U\br{s}}}. $$

\begin{proposition}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves. Then $ f $ is an isomorphism if and only if $ f_p $ is an isomorphism for all $ p \in X $.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}[leftmargin=0.5in]
\item[$ \implies $] Obvious.
\item[$ \impliedby $] Assume $ f_p $ is an isomorphism for all $ p \in X $. Need to show that $ f_U : \FFF\br{U} \to \GGG\br{U} $ is an isomorphism for all $ U \subseteq X $, as then we can define $ \br{f^{-1}}_U = \br{f_U}^{-1} $. Check that with this definition, $ \br{f^{-1}}_U $ is compatible with restriction maps, hence $ f^{-1} $ is a morphism of sheaves. \footnote{Exercise}
\begin{itemize}
\item $ f_U $ is injective. Suppose $ s \in \FFF\br{U} $, and $ f_U\br{s} = 0 $. Then for all $ p \in U $, $ f_p\br{U, s} = \br{U, f_U\br{s}} = \br{U, 0} = 0 \in \GGG_p $. Since $ f_p $ is injective, $ \br{U, s} = 0 $ in $ \FFF_p $. That is, there exists a open neighbourhood $ V_p $ of $ p $ in $ U $ such that $ \eval{s}_{V_p} = 0 $. Since $ \cbr{V_p}_{p \in U} $ cover $ U $, we see by S1 that $ s = 0 $.
\item $ f_U $ is surjective. Let $ t \in \GGG\br{U} $ and write $ t_p = \br{U, t} \in \GGG_p $. Since $ f_p $ is surjective, there exists $ s_p \in \FFF_p $ with $ f_p\br{s_p} = t_p $. That is, there exists $ V_p \subseteq U $ an open neighbourhood of $ p $, and a germ $ \br{V_p, s_p} $ such that $ \br{V_p, f_{V_p}\br{s_p}} \equiv \br{U, t} $. By shrinking $ V_p $ if necessary, we can assume that $ \eval{t}_{V_p} = f_{V_p}\br{s_p} $. Now on $ V_p \cap V_q $,
$$ f_{V_p \cap V_q}\br{\eval{s_p}_{V_p \cap V_q} - \eval{s_q}_{V_p \cap V_q}} = \eval{t}_{V_p \cap V_q} - \eval{t}_{V_p \cap V_q} = 0, $$
and hence by injectivity of $ f_{V_p \cap V_q} $ already proved, we have $ \eval{s_p}_{V_p \cap V_q} = \eval{s_q}_{V_p \cap V_q} $. By S2 the $ s_p $'s glue to give an element $ s \in \FFF\br{U} $ with $ \eval{s}_{V_p} = s_p $, for all $ p \in U $. Now
$$ \eval{f_U\br{s}}_{V_p} = f_{V_p}\br{\eval{s}_{V_p}} = f_{V_p}\br{s_p} = \eval{t}_{V_p}. $$
By S1, applied to $ f_U\br{s} - t $, we get $ f_U\br{s} = t $. Thus $ f_U $ is surjective.
\end{itemize}
\end{itemize}
\end{proof}

\subsection{Sheafification}

\begin{theorem}[Sheafification]
Given a presheaf $ \FFF $, there exists a sheaf $ \FFF^+ $ and a morphism $ \theta : \FFF \to \FFF^+ $ satisfying the following universal property. For any sheaf $ \GGG $ and morphism $ \phi : \FFF \to \GGG $, there exists a unique morphism $ \phi^+ : \FFF^+ \to \GGG $ such that $ \phi^+ \circ \theta = \phi $, so
$$
\begin{tikzcd}
\FFF \arrow{r}{\theta} \arrow{dr}[swap]{\phi} & \FFF^+ \arrow[dashed]{d}{\phi^+} \\
& \GGG
\end{tikzcd}.
$$
The pair $ \br{\FFF^+, \theta} $ is unique up to unique isomorphism, and is called the \textbf{sheafification} of $ \FFF $.
\end{theorem}

\begin{proof}
See example sheet $ 1 $. The idea is to make $ \FFF^+ $ look like functions. Define
$$ \FFF^+\br{U} = \cbr{s : U \to \bigsqcup_{p \in U} \FFF_p \st \begin{array}{l} \forall p \in U, \ s\br{p} \in \FFF_p, \\ \forall p \in U, \ \exists p \in V \subseteq U, \ \exists t \in \FFF\br{V}, \ \forall q \in V, \ s\br{q} = \br{V, t} \in \FFF_q \end{array}}. $$
Then
$$ \function[\theta_U]{\FFF\br{U}}{\FFF^+\br{U}}{s}{\br{p \mapsto \br{U, s} \in \FFF_p}}. $$
\end{proof}

\begin{exercise*}
A recommendation is to do all exercises in chapter II.$ 1 $ of Hartshorne.
\end{exercise*}

\pagebreak

\subsection{Kernels, cokernels, and images}

\lecture{4}{Friday}{16/10/20}

\begin{definition*}
Let $ f : \FFF \to \GGG $ be a morphism of presheaves on a space $ X $. We define the following.
\begin{itemize}
\item The \textbf{presheaf kernel} of $ f $, $ \ker f $, is the presheaf given by $ \br{\ker f}\br{U} = \ker \br{f_U : \FFF\br{U} \to \GGG\br{U}} $.
\item The \textbf{presheaf cokernel} $ \coker f $ is the presheaf given by $ \br{\coker f}\br{U} = \coker \br{f_U} = \GGG\br{U} / \im f_U $.
\item The \textbf{presheaf image} $ \im f $ is the presheaf given by $ \br{\im f}\br{U} = \im f_U $.
\end{itemize}
\end{definition*}

\begin{exercise*}
Check that these are presheaves, that is restrictions work.
\end{exercise*}

\begin{remark}
If $ f : \FFF \to \GGG $ is a morphism of sheaves, then $ \ker f $ is also a sheaf.
\end{remark}

\begin{proof}
S1 is certainly satisfied. If $ s \in \br{\ker f}\br{U} \subseteq \FFF\br{U} $ satisfies $ \eval{s}_{U_i} = 0 $ for all $ U_i $ in a cover of $ U $ so $ s = 0 $ by S1 for $ \FFF $. Given $ s_i \in \br{\ker f}\br{U_i} $ with $ \cbr{U_i} $ an open cover of $ U $, and with $ \eval{s_i}_{U_i \cap U_j} = \eval{s_j}_{U_i \cap U_j} $, then there exists $ s \in \FFF\br{U} $ with $ \eval{s}_{U_i} = s_i $ by S2 for $ \FFF $. But $ f_U\br{s} = 0 $ since $ \eval{f_U\br{s}}_{U_i} = f_{U_i}\br{\eval{s}_{U_i}} = f_{U_i}\br{s_i} = 0 $ so by S1, $ f_U\br{s} = 0 $.
\end{proof}

\begin{example*}
Let $ X = \PP^1 $, or think of the Riemann sphere. Let $ P, Q \in X $ be distinct points. Let $ \GGG $ be the sheaf of regular functions on $ X $, or think of the sheaf of holomorphic functions. Let $ \FFF $ be the sheaf of regular functions on $ X $ which vanish at $ P $ and $ Q $. Note $ \FFF\br{U} = \GGG\br{U} $ if $ U \cap \cbr{P, Q} = \emptyset $. Let $ U = \PP^1 \setminus \cbr{P} $ and $ V = \PP^1 \setminus \cbr{Q} $. Note $ \FFF\br{\PP^1} = 0 $ and $ \GGG\br{\PP^1} = k $, because regular functions on $ \PP^1 $ are constants. Let $ f : \FFF \to \GGG $ be the obvious inclusion. Then
$$ \br{\coker f}\br{\PP^1} = k, \qquad \br{\coker f}\br{U} = \GGG\br{U} / \FFF\br{U} = k\sbr{x} / \abr{x} = k, $$
$$ \br{\coker f}\br{V} = k, \qquad \br{\coker f}\br{U \cap V} = \GGG\br{U \cap V} / \FFF\br{U \cap V} = 0. $$
If S2 holds, then we would need to have $ \br{\coker f}\br{\PP^1} = k \oplus k $. This is not a bug, but a feature.
\end{example*}

\begin{definition*}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves.
\begin{itemize}
\item The \textbf{sheaf kernel} $ \ker f $ of $ f $ is just the presheaf kernel.
\item The \textbf{sheaf cokernel} is the sheaf associated to the presheaf cokernel of $ f $.
\item The \textbf{sheaf image} is the sheaf associated to the presheaf image of $ f $.
\end{itemize}
\end{definition*}

$ \FFF $ is a \textbf{subsheaf} of $ \GGG $ if we have inclusions $ \FFF\br{U} \subseteq \GGG\br{U} $ for all $ U $ compatible with restrictions.

\begin{exercise*}
The sheaf image $ \im f $ is a subsheaf of $ \GGG $.
\end{exercise*}

We say $ f $ is \textbf{injective} if $ \ker f = 0 $. We say $ f $ is \textbf{surjective} if $ \im f = \GGG $. We say a sequence of morphisms of sheaves
$$ \dots \to \FFF^{i - 1} \xrightarrow{f^i} \FFF^i \xrightarrow{f^{i + 1}} \FFF^{i + 1} \to \dots $$
is \textbf{exact} if $ \ker f^{i + 1} = \im f^i $ for all $ i $. If $ \FFF' \subseteq \FFF $ is a subsheaf, we write $ \FFF / \FFF' $ for the sheaf associated to the presheaf $ U \mapsto \FFF\br{U} / \FFF'\br{U} $. That is, this is the cokernel of the inclusion $ \FFF' \hookrightarrow \FFF $. A warning is if $ f : \FFF \to \GGG $ is surjective, we do not necessarily have $ \FFF\br{U} \to \GGG\br{U} $ surjective for all $ U $.

\begin{lemma}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves. Then for all $ p \in X $,
$$ \br{\ker f}_p = \ker \br{f_p : \FFF_p \to \GGG_p}, \qquad \br{\im f}_p = \im f_p. $$
\end{lemma}

\begin{proof}
Have a map
$$ \function{\br{\ker f}_p}{\ker f_p \subseteq \FFF_p}{\br{U, s}}{\br{U, s}}. $$
If $ s \in \br{\ker f}\br{U} = \ker f_U $ represents a germ $ \br{U, s} \in \br{\ker f}_p $, then $ \br{U, s} \in \FFF_p $, and $ f_p\br{U, s} = \br{U, f_U\br{s}} = \br{U, 0} = 0 \in \GGG_p $. So $ \br{U, s} \in \ker f_p $.
\begin{itemize}
\item Injective. If $ \br{U, s} = 0 $ in $ \FFF_p $, there exists a neighbourhood $ V \subseteq U $ of $ p $ such that $ \eval{s}_V = 0 $. Then $ \br{U, s} \sim \br{V, \eval{s}_V} = \br{V, 0} = 0 $ in $ \br{\ker f}_p $.
\item Surjective. If $ \br{U, s} \in \ker f_p $, then $ \br{U, f_U\br{s}} = 0 $ in $ \GGG_p $. That is, there exists a neighbourhood $ V \subseteq U $ of $ p $ such that $ 0 = \eval{f_U\br{s}}_V = f_V\br{\eval{s}_V} $. Thus $ \eval{s}_V \in \br{\ker f}\br{V} $, and $ \br{V, \eval{s}_V} \in \br{\ker f}_p $, and $ \br{V, \eval{s}_V} $ maps to the same element in $ \ker f_p $ represented by $ \br{U, s} $.
\end{itemize}

\pagebreak

Let $ \im' f $ be the presheaf image. An easy fact is if $ \FFF $ is a presheaf with associated sheaf $ \FFF^+ $, then $ \FFF_p \cong \FFF_p^+ $ for all $ p \in X $. \footnote{Exercise: check} Thus $ \br{\im f}_p = \br{\im' f}_p $, so need to show $ \br{\im' f}_p \cong \im f_p $. Define a map by
$$ \function{\br{\im' f}_p}{\im f_p}{\br{U, s}}{\br{U, s}}. $$
\begin{itemize}
\item Injective. If $ \br{U, s} = 0 $ in $ \GGG_p $ then there exists a neighbourhood $ V \subseteq U $ of $ p $ such that $ \eval{s}_V = 0 $. Then $ \br{U, s} \sim \br{V, 0} $ in $ \br{\im' f}_p $.
\item Surjective. If $ \br{U, s} \in \im f_p $, then there exists $ \br{V, t} \in \FFF_p $ with $ \br{U, s} = f_p\br{V, t} = \br{V, f_V\br{t}} $, so after shrinking $ U $ and $ V $ if necessary, then we can take $ U = V $ and $ f_U\br{t} = s $. Then $ \br{U, s} \in \br{\im' f}_p $.
\end{itemize}
\end{proof}

\begin{proposition}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves. Then
\begin{enumerate}
\item $ f $ is injective if and only if $ f_p : \FFF_p \to \GGG_p $ is injective for all $ p $, and
\item $ f $ is surjective if and only if $ f_p : \FFF_p \to \GGG_p $ is surjective for all $ p $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item $ f_p $ is injective for all $ p $ if and only if $ \ker f_p = 0 $ for all $ p $, if and only if $ \br{\ker f}_p = 0 $ for all $ p $, if and only if $ \ker f = 0 $, \footnote{Exercise: check by S1} which is if and only if $ f $ is injective.
\item $ f_p $ is surjective for all $ p $ if and only if $ \im f_p = \GGG_p $ for all $ p $, if and only if $ \br{\im f}_p = \GGG_p $ for all $ p $, if and only if $ \im f = \GGG $, \footnote{Exercise: check using $ \im f \subseteq \GGG $} which is if and only if $ f $ is surjective.
\end{enumerate}
\end{proof}

\begin{remark*}
Given $ f : \FFF \to \GGG $, in fact $ \GGG / \im f \cong \coker f $. \footnote{Exercise}
\end{remark*}

\subsection{Passing between spaces}

\lecture{5}{Monday}{19/10/20}

Let $ f : X \to Y $ be a continuous map between topological spaces, $ \FFF $ a sheaf on $ X $, and $ \GGG $ a sheaf on $ Y $. Define $ f_*\FFF $ by, for $ U \subseteq Y $
$$ \br{f_*\FFF}\br{U} = \FFF\br{f^{-1}\br{U}}. $$

\begin{exercise*}
Check $ f_*\FFF $ is a sheaf on $ Y $.
\end{exercise*}

Define $ f^{-1}\GGG $ to be the sheaf associated to the presheaf
$$ U \subseteq X \mapsto \cbr{\br{V, s} \st V \supseteq f\br{U}, \ V \ \text{open}, \ s \in \GGG\br{V}} / \sim, $$
where $ \br{V, s} \sim \br{V', s'} $ if there exists $ W \subseteq V \cap V' $ such that $ f\br{U} \subseteq W $, and $ \eval{s}_W = \eval{s'}_W $.

\begin{example*}
If $ f : \cbr{p} \to X $ is an inclusion of a point, then $ f^{-1}\GGG = \GGG_p $. This is a group but defines a sheaf on a one-point space. More generally, if $ \iota : Z \hookrightarrow X $ is an inclusion of a subset with induced topology, we often write
$$ \eval{\FFF}_Z = \iota^{-1}\FFF. $$
If $ Z $ is open in $ X $, then this is easy, since if $ U \subseteq Z $ then $ \eval{\FFF}_Z\br{U} = \FFF\br{U} $.
\end{example*}

\begin{remark*}
If $ s \in \FFF\br{U} $ we say $ s $ is a \textbf{section} of $ \FFF $ over $ U $. We often write
$$ \FFF\br{U} = \Gamma\br{U, \FFF}, $$
thinking of $ \Gamma\br{U, \cdot} $ as a functor from the category of sheaves on a space $ X $ to the category of abelian groups.
\end{remark*}

\pagebreak

\section{Schemes}

Want to construct a sheaf $ \OOO $ on $ \Spec A $, analogous to the sheaf of regular functions on a variety, and $ \OOO $ will be a sheaf of rings. That is, $ \OOO\br{U} $ will be a ring for each open set $ U $ and restriction maps will be ring homomorphisms.

\subsection{Localisation of a ring}

Importantly recall the following. Let $ A $ be a ring, where all rings are commutative with unity, and $ S \subseteq A $ be a multiplicatively closed subset, that is $ 1 \in S $ and if $ s_1, s_2 \in S $ then $ s_1s_2 \in S $. We define a ring
$$ S^{-1}A = \cbr{\br{a, s} \st a \in A, s \in S} / \sim, $$
where $ \br{a, s} \sim \br{a', s'} $ if there exists $ s'' \in S $ such that $ s''\br{as' - a's} = 0 $. Then $ S^{-1}A $ is called the \textbf{localisation of $ A $ at $ S $}. Note that we write $ a / s $ for the equivalence class of $ \br{a, s} $. The usual equivalence relation on fractions is $ a / s = a' / s' $ if and only if $ as' = a's $. We need the extra possibility of killing $ as' - a's $ with $ s'' $ if $ A $ is not an integral domain.

\begin{example*}
\hfill
\begin{itemize}
\item Take $ f \in A $ and $ S = \cbr{1, f, \dots} \subseteq A $. Then we write $ A_f = S^{-1}A $. These will correspond to open subsets.
\item If $ \ppp \subseteq A $ is a prime ideal and $ S = A \setminus \ppp $, then
\begin{itemize}
\item $ 1 \in S $, and
\item $ a, b \in S $ and $ ab \in \ppp $ is a contradiction by definition of prime ideals, so $ ab \in S $.
\end{itemize}
Then $ A_\ppp = S^{-1}A $ is the \textbf{localisation of $ A $ at $ \ppp $}. These will correspond to stalks.
\end{itemize}
\end{example*}

\subsection{Construction of the structure sheaf}

Let
$$ \OOO\br{U} = \cbr{s : U \to \bigsqcup_{\ppp \in U} A_\ppp \st \begin{array}{l} \forall \ppp \in U, \ s\br{\ppp} \in A_\ppp, \\ \forall \ppp \in U, \ \exists \ppp \in V \subseteq U \ \text{open}, \ \exists a, f \in A, \ \forall \qqq \in V, \ f \notin \qqq, \ s\br{\qqq} = \dfrac{a}{f} \in A_\qqq \end{array}}. $$

\begin{proposition}
For any $ \ppp \in \Spec A $, $ \OOO_\ppp = A_\ppp $.
\end{proposition}

\begin{proof}
Have a map
$$ \function{\OOO_\ppp}{A_\ppp}{\br{U, s}}{s\br{\ppp}}. $$
\begin{itemize}
\item Surjective. Any element of $ A_\ppp $ can be written as $ a / f $ for some $ a \in A $ and $ f \notin \ppp $. Then $ \DD\br{f} = \Spec A \setminus \VV\br{f} = \cbr{\ppp \in \Spec A \st f \notin \ppp} $, since $ \VV\br{f} = \cbr{\ppp \in \Spec A \st f \in \ppp} $. Now $ a / f $ defines an element of $ \OOO\br{\DD\br{f}} $ given by
$$ \function[s]{\DD\br{f}}{A_\qqq}{\qqq}{\dfrac{a}{f}}, $$
and in particular, $ s\br{\ppp} = a / f \in A_\ppp $.
\item Injective. Let $ \ppp \in U \subseteq \Spec A $ and $ s \in \OOO\br{U} $ with $ s\br{\ppp} = 0 $ in $ A_\ppp $. Want to show $ \br{U, s} = 0 $ in $ \OOO_\ppp $. By shrinking $ U $ if necessary, we can assume that $ s $ is given by $ a, f \in A $ with $ s\br{\qqq} = a / f $ for all $ \qqq \in U $. In particular $ f \notin \qqq $ for all $ \qqq \in U $. Thus $ a / f = 0 / 1 $ in $ A_\ppp $ so there exists $ h \in A \setminus \ppp $ such that $ 0 = h \cdot \br{a \cdot 1 - f \cdot 0} = h \cdot a $ in $ A $. Now let $ V = U \cap \DD\br{h} $. Then $ \br{V, \eval{s}_V} = 0 $, since for $ \qqq \in V $, $ \eval{s}_V\br{\qqq} = s\br{\qqq} = a / f \in A_\qqq $ and $ h \cdot a = 0 $, and $ h \in A \setminus \qqq $ so $ h \cdot a = 0 $ implies $ a / f = 0 / 1 $ in $ A_\qqq $. Thus $ \br{U, s} = 0 $ in $ \OOO_\ppp $.
\end{itemize}
\end{proof}

\pagebreak

\begin{proposition}
For any $ f \in A $, $ \OOO\br{\DD\br{f}} = A_f $.
\end{proposition}

In particular, as $ \Spec A = \DD\br{1} $, the \textbf{global sections} of $ \OOO $ is $ \OOO\br{\Spec A} = A_1 = A $.

\begin{proof}
Let
$$ \function[\psi]{A_f}{\OOO\br{\DD\br{f}}}{\dfrac{a}{f^n}}{\br{\ppp \in \DD\br{f} \mapsto \dfrac{a}{f^n} \in A_\ppp}}, $$
since $ f \notin \ppp $ implies that $ f^n \notin \ppp $ for all $ n \ge 0 $.
\begin{itemize}
\item Injective. If $ \psi\br{a / f^n} = 0 $, then for all $ \ppp \in \DD\br{f} $, $ a / f^n = 0 $ in $ A_\ppp $, that is there exists $ h \in A \setminus \ppp $ such that $ h \cdot a = 0 $ in $ A $. Let $ I = \cbr{g \in A \st g \cdot a = 0} $, the \textbf{annihilator} of $ a $. So $ h \in I $ and $ h \notin \ppp $, so $ I \not\subseteq \ppp $. This is true for all $ \ppp \in \DD\br{f} $, so $ \VV\br{I} \cap \DD\br{f} = \emptyset $. Thus $ f \in \bigcap_{\ppp \in \VV\br{I}} \ppp = \sqrt{I} $, the radical, so $ f^m \in I $ for some $ m > 0 $. Thus $ f^m \cdot a = 0 $, so $ a / f^n = 0 $ in $ A_f $. Thus $ \psi $ is injective.

\lecture{6}{Wednesday}{21/10/20}

\item Surjective. Let $ s \in \OOO\br{\DD\br{f}} $. Cover $ \DD\br{f} $ with open sets $ V_i $ on which $ s $ is represented as $ a_i / g_i $ with $ a_i, g_i \in A $ such that $ g_i \notin \ppp $ whenever $ \ppp \in V_i $. Thus $ V_i \subseteq \DD\br{g_i} $. By question $ 1 $ on example sheet $ 1 $, the sets of the form $ \DD\br{h} $ form a base for the Zariski topology on $ \Spec A $. Thus we can assume $ V_i = \DD\br{h_i} $ for some $ h_i \in A $. Since $ \DD\br{h_i} \subseteq \DD\br{g_i} $, we have $ \VV\br{h_i} \supseteq \VV\br{g_i} $, so $ \sqrt{\abr{h_i}} \subseteq \sqrt{\abr{g_i}} $, so $ h_i^n \in \abr{g_i} $ for some $ n $, say $ h_i^n = c_ig_i $, so $ a_i / g_i = c_ia_i / h_i^n $. Now replace $ h_i $ by $ h_i^n $, since this does not change open sets because in general $ \DD\br{h_i} = \DD\br{h_i^n} $, and replace $ a_i $ by $ c_ia_i $. The situation so far is that we can assume $ \DD\br{f} $ is covered by sets $ \DD\br{h_i} $ such that $ s $ is represented by $ a_i / h_i $ on $ \DD\br{h_i} $. Claim that $ \DD\br{f} $ can be covered by a finite number of the $ \DD\br{h_i} $, that is $ \DD\br{f} $ is quasi-compact. Since
\begin{align*}
\DD\br{f} \subseteq \bigcup_i \DD\br{h_i} \qquad
& \iff \qquad \VV\br{f} \supseteq \bigcap_i \VV\br{h_i} = \VV\br{\sum_i \abr{h_i}}
\qquad \iff \qquad f \in \bigcap_{\ppp \in \VV\br{\sum_i \abr{h_i}}} \ppp \\
& \iff \qquad f \in \sqrt{\sum_i \abr{h_i}}
\qquad \iff \qquad \exists n, \ f^n \in \sum_i \abr{h_i},
\end{align*}
we can write $ f^n = \sum_{i \in I} b_ih_i $ for some finite index set $ I $. Thus reversing this argument, $ \DD\br{f} \subseteq \bigcup_{i \in I} \DD\br{h_i} $. We now pass to this finite subcover $ \cbr{\DD\br{h_i}} $. On $ \DD\br{h_i} \cap \DD\br{h_j} = \DD\br{h_ih_j} $, note $ a_i / h_i $ and $ a_j / h_j $ both represent $ s $, so by injectivity shown in the last lecture, $ a_ih_j / h_ih_j = a_i / h_i = a_j / h_j = a_jh_i / h_ih_j $ in $ A_{h_ih_j} $. Thus for some $ n $, $ \br{h_ih_j}^n\br{h_ja_i - h_ia_j} = 0 $ in $ A $. We can pick an $ n $ sufficiently large to work for all pairs $ i $ and $ j $. Rewriting, $ h_j^{n + 1}\br{h_i^na_i} - h_i^{n + 1}\br{h_ja_j} = 0 $. Replace each $ h_i $ by $ h_i^{n + 1} $ and $ a_i $ by $ h_i^na_i $, since $ a_i / h_i = a_ih_i^n / h_i^{n + 1} $. Thus we can assume that $ s $ is still represented on $ \DD\br{h_i} $ by $ a_i / h_i $ but also for each $ i $ and $ j $ have $ h_ia_j = h_ja_i $. Note $ f^n = \sum_ib_ih_i $ for $ b_i \in A $, since $ \cbr{\DD\br{h_i}} $ cover $ \DD\br{f} $. Let $ a = \sum_i b_ia_i $. Then for any $ j $, $ h_ja = \sum_i b_ia_ih_j = \sum_i b_ia_jh_i = f^na_j $. Thus $ a / f^n = a_j / h_j $ on $ \DD\br{h_j} $. Thus $ \psi\br{a / f^n} = s $, so $ \psi $ is surjective.
\end{itemize}
\end{proof}

We now have a topological space $ \Spec A $ equipped with a sheaf of rings $ \OOO $.

\subsection{Ringed spaces}

\begin{definition*}
A \textbf{ringed space} is a pair $ \br{X, \OOO_X} $ where
\begin{itemize}
\item $ X $ is a topological space, and
\item $ \OOO_X $ is a sheaf of rings on $ X $.
\end{itemize}
A \textbf{morphism of ringed spaces} $ f : \br{X, \OOO_X} \to \br{Y, \OOO_Y} $ is the following data.
\begin{itemize}
\item $ f : X \to Y $ a continuous map.
\item $ f^\# : \OOO_Y \to f_*\OOO_X $ a morphism of sheaves of rings, that is for each $ U \subseteq Y $ open, we have a ring homomorphism $ f_U^\# : \OOO_Y\br{U} \to \br{f_*\OOO_X}\br{U} = \OOO_X\br{f^{-1}\br{U}} $.
\end{itemize}
\end{definition*}

\pagebreak

\begin{example*}
\hfill
\begin{itemize}
\item Let $ X $ be a topological space, and let $ \OOO_X $ be the sheaf of continuous $ \RR $-valued functions. Then if $ \br{Y, \OOO_Y} $ is similarly defined, given $ f : X \to Y $, we get $ f^\# : \OOO_Y \to f_*\OOO_X $ defined by
$$ \function[f_U^\#]{\OOO_Y\br{U}}{\OOO_X\br{f^{-1}\br{U}}}{\phi}{\phi \circ f}. $$
\item Let $ X $ be a variety, and let $ \OOO_X $ be the sheaf of regular functions on $ X $. A morphism of varieties $ f : X \to Y $ is a continuous map inducing
$$ \function[f_U^\#]{\OOO_Y\br{U}}{\OOO_X\br{f^{-1}\br{U}}}{\phi}{\phi \circ f}. $$
\end{itemize}
\end{example*}

A ring is \textbf{local} if it has a unique maximal ideal.

\begin{definition*}
A \textbf{locally ringed space} $ \br{X, \OOO_X} $ is a ringed space such that $ \OOO_{X, p} $ is a local ring for all $ p \in X $. A \textbf{morphism $ f : \br{X, \OOO_X} \to \br{Y, \OOO_Y} $ of locally ringed spaces} is a morphism of ringed spaces such that the induced homomorphism $ f_p^\# : \OOO_{Y, f\br{p}} \to \OOO_{X, p} $ is a \textbf{local homomorphism} for all $ p \in X $.
\begin{itemize}
\item The map is defined by \footnote{Exercise: check well-defined}
$$ \function[f_p^\#]{\OOO_{Y, f\br{p}}}{\OOO_{X, p}}{\br{U, s}}{\br{f^{-1}\br{U}, f_U^\#\br{s}}}. $$
\item A ring homomorphism $ \phi : \br{A, \mmm_A} \to \br{B, \mmm_B} $ is \textbf{local} if $ \phi^{-1}\br{\mmm_B} = \mmm_A $, where $ \mmm_A $ is the maximal ideal of $ A $. Note that $ \phi\br{A \setminus \mmm_A} = \phi\br{A^*} \subseteq B^* = B \setminus \mmm_B $, where $ A^* $ is the set of invertible elements of $ A $. Thus $ \phi^{-1}\br{\mmm_B} \subseteq \mmm_A $ always.
\end{itemize}
\end{definition*}

\begin{example*}
In the case of varieties, $ \OOO_{X, p} $ has a unique maximal ideal
$$ \cbr{\br{U, f} \in \OOO_X\br{U} \st f\br{p} = 0} / \sim. $$
If $ f\br{p} \ne 0 $, then $ f $ is nowhere vanishing on some neighbourhood of $ p $, so after shrinking $ U $, we can invert $ f $. The local homomorphism condition just follows from the pull-back $ \phi \circ f $ of a function $ \phi $ vanishing at $ f\br{p} $ vanishes at $ p $.
\end{example*}

\subsection{Affine schemes}

\lecture{7}{Friday}{23/10/20}

The key example $ \br{\Spec A, \OOO} $ is a locally ringed space, which we call an affine scheme.

\begin{theorem}
The category of affine schemes with locally ringed morphisms is equivalent to the opposite category of rings.
\end{theorem}

Need to show that
\begin{enumerate}
\item if $ \phi : A \to B $ is a ring homomorphism, we obtain an induced morphism $ \br{f, f^\#} : \br{\Spec B, \OOO_{\Spec B}} \to \br{\Spec A, \OOO_{\Spec A}} $, and
\item any morphism of affine schemes as locally ringed spaces arises in this way.
\end{enumerate}

\begin{proof}
\hfill
\begin{enumerate}
\item Given a ring homomorphism $ \phi : A \to B $, define
$$ \function[f]{\Spec B}{\Spec A}{\ppp}{\phi^{-1}\br{\ppp}}. $$
Note $ \phi^{-1}\br{\ppp} $ is prime, since if $ ab \in \phi^{-1}\br{\ppp} $, then $ \phi\br{ab} = \phi\br{a}\phi\br{b} \in \ppp $, thus either $ \phi\br{a} \in \ppp $ or $ \phi\br{b} \in \ppp $, and hence either $ a \in \phi^{-1}\br{\ppp} $ or $ b \in \phi^{-1}\br{\ppp} $. Then $ f $ is continuous, since
\begin{align*}
f^{-1}\br{\VV\br{I}}
& = f^{-1}\br{\cbr{\ppp \in \Spec A \st \ppp \supseteq I}}
= \cbr{\qqq \in \Spec B \st f\br{\qqq} \supseteq I} \\
& = \cbr{\qqq \in \Spec B \st \phi^{-1}\br{\qqq} \supseteq I}
= \cbr{\qqq \in \Spec B \st \qqq \supseteq \phi\br{I}} = \VV\br{\phi\br{I}}.
\end{align*}

\pagebreak

We need to construct $ f^\# : \OOO_{\Spec A} \to f_*\OOO_{\Spec B} $. For $ \ppp \in \Spec B $, we obtain a natural homomorphism
$$ \function[\phi_\ppp]{A_{\phi^{-1}\br{\ppp}}}{B_\ppp}{\dfrac{a}{s}}{\dfrac{\phi\br{a}}{\phi\br{s}}}. $$
Note $ \phi_\ppp $ is a local homomorphism, since the maximal ideal $ \ppp B_\ppp $ of $ B_\ppp $ is generated by the image of $ \ppp $ under the map
$$ \function{B}{B_\ppp}{b}{\dfrac{b}{1}}, $$
and the maximal ideal $ \phi^{-1}\br{\ppp}A_{\phi^{-1}\br{\ppp}} $ of $ A_{\phi^{-1}\br{\ppp}} $ is generated by the image of $ \phi^{-1}\br{\ppp} $ under the map
$$ \function{A}{A_{\phi^{-1}\br{\ppp}}}{a}{\dfrac{a}{1}}, $$
so have a commutative diagram
$$
\begin{tikzcd}
\phi^{-1}\br{\ppp} \arrow[subset]{r} & A \arrow{r}{\phi} \arrow{d} & B \arrow{d} & \ppp \arrow[subset]{l} \\
f\br{\ppp}A_{f\br{\ppp}} \arrow[subset]{r} & A_{\phi^{-1}\br{\ppp}} \arrow{r}[swap]{\phi_\ppp} & B_\ppp & \ppp B_\ppp \arrow[subset]{l}
\end{tikzcd},
$$
thus $ \phi_\ppp^{-1}\br{\ppp B_\ppp} =\phi^{-1}\br{\ppp}A_{\phi^{-1}\br{\ppp}} $. Given $ V \subseteq \Spec A $ open, we may define
$$ \function[f_V^\#]{\OOO_{\Spec A}\br{V}}{\OOO_{\Spec B}\br{f^{-1}\br{V}}}{\br{\ppp \in V \mapsto s\br{\ppp} \in A_\ppp}}{\br{\qqq \in f^{-1}\br{V} \mapsto \phi_\qqq\br{s\br{f\br{\qqq}}} \in B_\qqq}}. $$
Note that we need to check the local coherence part of the definition of $ \OOO $. That is, if $ s $ is locally given by $ a / h $, then $ f_V^\#\br{s} $ is locally given by $ \phi\br{a} / \phi\br{h} $. This gives the desired map $ f^\# : \OOO_{\Spec A} \to f_*\OOO_{\Spec B} $, and the induced map on stalks $ f_\ppp^\# : \OOO_{\Spec A, f\br{\ppp}} \to \OOO_{\Spec B, \ppp} $ agrees with $ \phi_\ppp : A_{\phi^{-1}\br{\ppp}} \to B_\ppp $, by construction. Hence $ \br{f, f^\#} $ is a morphism of locally ringed spaces.
\item Now suppose given a morphism $ \br{f, f^\#} : \Spec B \to \Spec A $ of locally ringed spaces. Take
$$ \phi = f_{\Spec A}^\# : \Gamma\br{\Spec A, \OOO_{\Spec A}} = A \to \Gamma\br{\Spec B, \OOO_{\Spec B}} = B. $$
We need to show $ \phi $ gives rise to $ \br{f, f^\#} $. We have $ f_\ppp^\# : \OOO_{\Spec A, f\br{\ppp}} = A_{f\br{\ppp}} \to \OOO_{\Spec B, \ppp} = B_\ppp $ a local homomorphism. This is compatible with the corresponding map on global sections, that is
$$
\begin{tikzcd}
\Gamma\br{\Spec A, \OOO_{\Spec A}} \arrow{r}{f_{\Spec A}^\#} \arrow{d} & \Gamma\br{\Spec B, \OOO_{\Spec B}} \arrow{d} \\
\OOO_{\Spec A, f\br{\ppp}} \arrow{r}[swap]{f_\ppp^\#} & \OOO_{\Spec B, \ppp}
\end{tikzcd}
$$
is commutative. That is, we have a commutative diagram
$$
\begin{tikzcd}
f\br{\ppp} \arrow[subset]{r} & A \arrow{r}{\phi} \arrow{d} & B \arrow{d} & \ppp \arrow[subset]{l} \\
f\br{\ppp}A_{f\br{\ppp}} \arrow[subset]{r} & A_{f\br{\ppp}} \arrow{r}[swap]{f_\ppp^\#} & B_\ppp & \ppp B_\ppp \arrow[subset]{l}
\end{tikzcd}.
$$
Then $ \br{f_\ppp^\#}^{-1}\br{\ppp B_\ppp} = f\br{\ppp}A_{f\br{\ppp}} $ since $ f_\ppp^\# $ is a local homomorphism, and by commutativity of the diagram, $ f\br{\ppp} = \phi^{-1}\br{\ppp} $. Thus $ f $ is induced by $ \phi $, and $ f_\ppp^\# = \phi_\ppp $. So $ f^\# $ is as constructed previously.
\end{enumerate}
\end{proof}

\begin{remark*}
Demanding $ \br{f, f^\#} $ was a morphism of locally ringed spaces was crucial to make the proof work.
\end{remark*}

\pagebreak

\begin{definition*}
An \textbf{affine scheme} is a locally ringed space isomorphic, in the category of locally ringed spaces, to $ \br{\Spec A, \OOO_{\Spec A}} $ for some ring $ A $. A \textbf{scheme} is a locally ringed space $ \br{X, \OOO_X} $ with an open cover $ \cbr{\br{U_i, \eval{\OOO_X}_{U_i}}} $ with each $ \br{U_i, \eval{\OOO_X}_{U_i}} $ an affine scheme, where $ \eval{\OOO_X}_{U_i}\br{V} = \OOO_X\br{V} $ for $ V \subseteq U_i $ open. A \textbf{morphism of schemes} is a morphism of locally ringed spaces.
\end{definition*}

\begin{example*}
Let $ k $ be a field. Then $ \Spec k = \br{\cbr{0}, k} $.
\begin{itemize}
\item What does giving a morphism $ f : \Spec k \to X $ to a scheme mean? First, this selects a point $ x \in X $, the image of $ f $. Second, we get a local ring homomorphism $ f_x^\# : \OOO_{X, x} \to \OOO_{\Spec k, 0} = k $, that is $ \br{f_x^\#}^{-1}\br{0} = \mmm_x \subseteq \OOO_{X, x} $, the maximal ideal of $ \OOO_{X, x} $. Thus we get a factorisation $ f_x^\# : \OOO_{X, x} \to \OOO_{X, x} / \mmm_x \to k $, where $ \OOO_{X, x} / \mmm_x $ is a field, written as $ \kappa\br{x} $, called the \textbf{residue field} of $ X $ at $ x $. Thus $ f $ induces an inclusion $ \kappa\br{x} \hookrightarrow k $. Conversely, given such an inclusion $ \iota : \kappa\br{x} \hookrightarrow k $ of fields, we get a scheme morphism by defining $ f\br{0} = x $, and
$$ \function[f^\#]{\OOO_X}{f_*k}{s}{\iota\br{s\br{x}}}, \qquad s\br{x} \in \OOO_{X, x}. $$
The moral is that giving a morphism $ f : \Spec k \to X $ is equivalent to giving a point $ x \in X $ and an inclusion $ \iota : \kappa\br{x} \to k $. Note that if $ X = \Spec A $, giving $ \Spec k \to \Spec A $ is equivalent to giving a homomorphism $ A \to k $, which we viewed at the beginning of the course as a $ k $-valued point on $ \Spec A $.

\lecture{8}{Monday}{26/10/20}

\item What does giving $ X \to \Spec k $ mean? No information in the continuous map, but need also a map $ f^\# : k \to f_*\OOO_X $, that is a map $ k \to \Gamma\br{\Spec k, f_*\OOO_X} = \Gamma\br{X, \OOO_X} $. That is, $ \Gamma\br{X, \OOO_X} $ carries a $ k $-algebra structure. Note this induces $ k $-algebra structures on $ \OOO_X\br{U} $ for all $ U $ via the composition $ k \to \OOO_X\br{X} \to \OOO_X\br{U} $ and similarly all stalks $ \OOO_{X, p} $ are also $ k $-algebras. We say $ X $ is a \textbf{scheme defined over $ k $}. For example, in affine varieties, consider $ A = k\sbr{x_1, \dots, x_n} / I $ with $ I = \sqrt{I} $. Then $ \Spec A $ is our replacement for $ \VV\br{I} \subseteq \AA_k^n $, viewing $ \Spec A $ as a scheme over $ k $. If $ k \subseteq k' $ is a field extension, a \textbf{$ k' $-valued point} of $ X / k $ is a commutative diagram
$$
\begin{tikzcd}
\Spec k' \arrow{rr} \arrow{dr} & & X \arrow{dl} \\
& \Spec k &
\end{tikzcd}.
$$
We write $ X\br{k'} $ for the set of such morphisms.
\end{itemize}
\end{example*}

\begin{remark*}
It is rare in algebraic geometry to work with schemes alone, but rather always working over a base scheme.
\end{remark*}

Fix a base scheme $ S $. Define $ \Sch / S $ to be the category whose objects are morphisms $ T \to S $ and morphisms are commutative diagrams
$$
\begin{tikzcd}
T \arrow{rr} \arrow{dr} & & T' \arrow{dl} \\
& S &
\end{tikzcd}.
$$
We will frequently work with $ \Sch / k = \Sch / \Spec k $. Given $ T \to S $ and $ X \to S $ objects in $ \Sch / S $, a \textbf{$ T $-valued point} of $ X \to S $ is a morphism $ T \to X $ over $ S $, so
$$
\begin{tikzcd}
T \arrow{rr} \arrow{dr} & & X \arrow{dl} \\
& S &
\end{tikzcd},
$$
and we write $ X\br{T} $ for the set of $ T $-valued points. The \textbf{Yoneda philosophy} is that $ X\br{T} $ for all $ T $ determines $ X $.

\pagebreak

\begin{example*}
Fix a field $ k $, and let $ D = \Spec k\sbr{t} / \abr{t^2} = \br{\cbr{\abr{t}}, k\sbr{t} / \abr{t^2}} $. Then $ t $ does not make sense as $ k $-valued function anymore, as $ t^2 = 0 $. Let $ X $ be any scheme over $ k $. What is $ X\br{D} $? Given $ f : D \to X $ a morphism of schemes over $ k $, we get a point $ x \in X $ as the image of $ f $ and a local homomorphism
$$ \function[f_x^\#]{\OOO_{X, x}}{k\sbr{t} / \abr{t^2}}{\mmm_x}{\abr{t}}. $$
Note that $ \mmm_x^2 $ maps to zero, hence we get a $ k $-linear map $ \mmm_x / \mmm_x^2 \to \abr{t} \cong k $ as a $ k $-vector space. We also have a composed surjective $ k $-algebra homomorphism $ \OOO_{X, x} \to k\sbr{t} / \abr{t} \cong k $ with kernel $ \mmm_x $, and hence we have $ \kappa\br{x} = \OOO_{X, x} / \mmm_x \cong k $. So we get
\begin{itemize}
\item a $ k $-valued point $ x $ with residue field $ k $, and
\item a $ k $-vector space map $ \mmm_x / \mmm_x^2 \to k $, that is an element of $ \br{\mmm_x / \mmm_x^2}^* $, the dual vector space.
\end{itemize}
Then $ \br{\mmm_x / \mmm_x^2}^* $ is called the \textbf{Zariski tangent space} to $ X $ at $ x $. Think of $ D $ as a point plus an arrow.
\end{example*}

\begin{example*}
\textbf{Glued schemes} are a special case of a question on example sheet $ 1 $. Suppose given two schemes $ X_1 $ and $ X_2 $ and open subsets $ U_i \subseteq X_i $. Recall $ U_i $ is also a locally ringed space $ \br{U_i, \eval{\OOO_{X_i}}_{U_i}} $, and in fact $ U_i $ is then a scheme. Given an isomorphism $ f : U_1 \xrightarrow{\sim} U_2 $, can glue $ X_1 $ and $ X_2 $ along $ U_1 $ and $ U_2 $ to get a scheme $ X $ with an open cover $ \cbr{X_1, X_2} $, so $ X = X_1 \sqcup X_2 / \sim $ such that $ x_1 \in U_1 \sim x_2 \in U_2 $ if $ f\br{x_1} = x_2 $, and need to define $ \OOO_X $. Now take $ \AA_k^n = \Spec k\sbr{x_1, \dots, x_n} $, so $ \AA_k^1 = \Spec k\sbr{x} $. Take $ X_1 = X_2 = \AA_k^1 $.
\begin{itemize}
\item Glue $ U_1 = \AA^1 \setminus \cbr{0} = \DD\br{x} \subseteq X_1 $ and $ U_2 = \AA^1 \setminus \cbr{0} = \DD\br{x} \subseteq X_2 $ via the identity map. This is the affine line with doubled origin.
\item Could instead glue $ U_1 $ and $ U_2 $ via the map given by $ x \mapsto x^{-1} $, where $ U_1 = \Spec k\sbr{x}_x = U_2 $ and
$$ \function{k\sbr{x}_x}{k\sbr{x}_x}{x}{x^{-1}} $$
induces an isomorphism $ U_1 \to U_2 $. When we glue, we get the projective line over $ k $, $ \PP_k^1 $.
\end{itemize}
\end{example*}

\subsection{Projective schemes}

Let $ S $ be a graded ring, that is
$$ S = \bigoplus_{d \ge 0} S_d, $$
with $ S_d $ an abelian group, and product law satisfies $ S_d \cdot S_{d'} \subseteq S_{d + d'} $.

\begin{example*}
$ S = k\sbr{x_0, \dots, x_n} $, and $ S_d $ is the space of polynomials which are homogeneous of degree $ d $, that is spanned by monomials of degree $ d $.
\end{example*}

We write
$$ S_+ = \bigoplus_{d \ge 1} S_d, $$
which we call the \textbf{irrelevant ideal}.

\begin{definition*}
$ I \subseteq S $ is a \textbf{homogeneous ideal} if $ I $ is generated by its homogeneous elements, that is elements in $ S_d $ for various $ d $.
\end{definition*}

\begin{definition*}
Let
$$ \Proj S = \cbr{\ppp \in \Spec S \st \ppp \ \text{is homogeneous}, \ \ppp \not\supseteq S_+}. $$
For $ I \subseteq S $ a homogeneous ideal, set
$$ \VV\br{I} = \cbr{\ppp \in \Proj S \st \ppp \supseteq I}. $$
\end{definition*}

\begin{exercise*}
Check the $ \VV\br{I} $ form the closed sets of a topology on $ \Proj S $.
\end{exercise*}

\pagebreak

\lecture{9}{Wednesday}{28/10/20}

\begin{notation*}
For $ \ppp \in \Proj S $, let
$$ T = \cbr{f \in S \setminus \ppp \st f \ \text{is homogeneous}}. $$
Then $ T $ is a multiplicatively closed subset of $ S $, and let $ S_{\br{\ppp}} \subseteq T^{-1}S $ be the subring of elements of degree zero, that is written in the form $ s / s' $ with $ s \in S $ homogeneous and $ s' \in T $ with $ \deg s = \deg s' $. For $ f \in S $ homogeneous, we write $ S_{\br{f}} \subseteq S_f $ for the subset of elements of degree zero.
\end{notation*}

Can now define a sheaf $ \OOO $ on $ \Proj S $. For $ U \subseteq \Proj S $ open, set
$$ \OOO\br{U} = \cbr{s : U \to \bigsqcup_{\ppp \in U} S_{\br{\ppp}} \st \begin{array}{l} \forall \ppp \in U, \ s\br{\ppp} \in S_{\br{\ppp}} \\ \forall \ppp \in U, \ \exists \ppp \in V \subseteq U \ \text{open}, \ \exists a, f \in S, \ \forall \qqq \in V, \ f \notin \qqq, \ s\br{\qqq} = \dfrac{a}{f} \in S_{\br{\qqq}} \end{array}}, $$
where $ a $ and $ f $ are homogeneous of the same degree. As before, $ \OOO_\ppp = S_{\br{\ppp}} $. \footnote{Exercise: check} Is the locally ringed space $ \br{\Proj S, \OOO} $ a scheme?

\begin{notation*}
If $ f \in S $ is homogeneous, then we write
$$ \DD_+\br{f} = \cbr{\ppp \in \Proj S \st f \notin \ppp}, $$
which is an open set and $ \DD_+\br{f} = \Proj S \setminus \VV\br{f} $.
\end{notation*}

\begin{proposition}
$ \br{\DD_+\br{f}, \eval{\OOO}_{\DD_+\br{f}}} \cong \Spec S_{\br{f}} $ as locally ringed spaces. Further, the open sets $ \DD_+\br{f} $ for $ f \in S_+ $ cover $ \Proj S $. Hence $ \br{\Proj S, \OOO} $ is a scheme.
\end{proposition}

\begin{proof}
Will be on example sheet $ 2 $.
\end{proof}

\begin{definition*}
If $ A $ is a ring, define
$$ \PP_A^n = \Proj A\sbr{x_0, \dots, x_n}. $$
\end{definition*}

\begin{example*}
If $ k $ is an algebraically closed field, consider $ \PP_k^1 = \Proj k\sbr{x_0, x_1} $. The closed points, that is points $ \ppp $ such that $ \cbr{\ppp} $ is closed, correspond to maximal elements of $ \Proj S $. \footnote{Exercise: check} These maximal elements are ideals of the form $ \abr{ax_0 - bx_1} $. The only maximal homogeneous ideal of $ k\sbr{x_0, x_1} $ is $ \abr{x_0, x_1} = S_+ $, since any maximal ideal is of the form $ \abr{x_0 - a_0, x_1 - a_1} $. The other prime ideals of $ k\sbr{x_0, x_1} $ are principal, that is of the form $ \abr{f} $ with $ f $ irreducible or $ f = 0 $. For $ \abr{f} $ to be homogeneous, $ f $ must be homogeneous. Any such polynomial splits into linear factors, all homogeneous, so in order for $ f $ to be irreducible it must be linear. Note we have a one-to-one correspondence between
$$ \function{\cbr{\abr{ax_0 - bx_1} \st a, b \in k \ \text{not both zero}}}{\br{k^2 \setminus \cbr{\br{0, 0}}} / k^*}{\abr{ax_0 - bx_1}}{\br{b : a}}, $$
where $ k^* $ acts by $ \br{a, b} \mapsto \br{\lambda a, \lambda b} $ for $ \lambda \in k^* $. The conclusion is that the closed points of $ \PP_k^1 $ are in one-to-one correspondence with points of $ \br{k^2 \setminus \cbr{\br{0, 0}}} / k^* $. More generally, the closed points of $ \PP_k^n $ are in one-to-one correspondence with points of $ \br{k^{n + 1} \setminus \cbr{0}} / k^* $. Can see this by making use of the open cover $ \cbr{\DD_+\br{x_i} \st 0 \le i \le n} $, \footnote{Exercise: good exercise} which is an open cover since $ \ppp \notin \DD_+\br{x_i} $ for any $ i $ implies that $ x_i \in \ppp $ for all $ i $, so $ S_+ \subseteq \ppp $ and so $ \ppp \notin \Proj S $.
\end{example*}

\begin{example*}
Let $ S = k\sbr{x_0, \dots, x_n} $, but grade by $ \deg x_i = w_i $, where $ w_0, \dots, w_n $ are positive integers. Define $ \W\PP^n\br{w_0, \dots, w_n} = \Proj S $, the \textbf{weighted projective space}. For example, $ \W\PP^2\br{1, 1, 2} $ has an open cover $ \cbr{\DD_+\br{x_i} \st 0 \le i \le 2} $. Consider $ \DD_+\br{x_2} = \Spec S_{\br{x_2}} $. Note
$$ S_{\br{x_2}} = k\sbr{\dfrac{x_0^2}{x_2}, \dfrac{x_0x_1}{x_2}, \dfrac{x_1^2}{x_2}} \cong k\sbr{u, v, w} / \abr{uw - v^2} \subseteq S_{x_2}, $$
so $ \Spec S_{\br{x_2}} $ is a quadric cone with a singular point. Similarly, $ \DD_+\br{x_0} $ and $ \DD_+\br{x_1} $ are both isomorphic to $ \AA_k^2 $.
\end{example*}

\pagebreak

\begin{example*}
Let $ M = \ZZ^n $ and $ M_\RR = M \otimes_\ZZ \RR = \RR^n $. Let $ \Delta \subseteq M_\RR $ be a compact convex lattice polytope. That is, there exists a finite set $ V \subseteq M $ such that $ \Delta $ is the convex hull of $ V $, that is the smallest convex set containing $ V $. Let
$$ \C\br{\Delta} = \cbr{\br{m, r} \in M_\RR \oplus \RR \st m \in r\Delta, \ r \ge 0} \subseteq M_\RR \oplus \RR. $$
Here $ r\Delta = \cbr{rm \st m \in \Delta} $. This is the \textbf{cone over $ \Delta $}. Let
$$ S = k\sbr{\C\br{\Delta} \cap \br{M \oplus \ZZ}} = \bigoplus_{P \in \C\br{\Delta} \cap \br{M \oplus \ZZ}} kz^P, $$
with multiplication given by $ z^Pz^{P'} = z^{P + P'} $, since $ \C\br{\Delta} \cap \br{M \oplus \ZZ} $ is a monoid, that is it is closed under addition and contains zero. This makes $ S $ into a ring, and it is graded by $ \deg Z^{\br{m, r}} = r $. Define $ \PP_\Delta = \Proj S $. This is called a \textbf{projective toric variety}.
\begin{itemize}
\item Let $ \Delta $ be the convex hull of $ \cbr{0, e_1, \dots, e_n} $ with $ e_1, \dots, e_n $ the standard basis of $ M = \ZZ^n $. Check that $ S = k\sbr{x_0, \dots, x_n} $ with standard grading $ x_0 = z^{\br{0, 1}} $ and $ x_i = z^{\br{e_i, 1}} $. \footnote{Exercise} So $ \PP_\Delta = \PP_k^n $.
\item Let $ n = 2 $, and let $ \Delta $ be the convex hull of $ \cbr{\br{0, 0}, \br{1, 0}, \br{0, 1}, \br{1, 1}} $. In $ S $, the degree $ d $ monomials are $ \cbr{z^{\br{a, b, d}} \st 0 \le a \le d, \ 0 \le b \le d} $. Any of these can be written as a product of monomials of degree one, that is the monomials $ x = z^{\br{0, 0, 1}} $, $ y = z^{\br{1, 0, 1}} $, $ w = z^{\br{0, 1, 1}} $, and $ t = z^{\br{1, 1, 1}} $. Thus $ S = k\sbr{x, y, w, t} / \abr{xt - yw} $. So $ \Proj S $ can be thought of as a quadric surface in $ \PP_k^3 $.
\end{itemize}
\end{example*}

\subsection{Open and closed subschemes}

\lecture{10}{Friday}{30/10/20}

\begin{definition*}
An \textbf{open subscheme} of a scheme $ X $ is a scheme $ \br{U, \eval{\OOO_X}_U} $ for $ U \subseteq X $ an open subset. Note that this is a scheme because from question $ 1 $ and question $ 11 $ on the first example sheet, open affine subsets of $ X $ form a basis for the topology on $ X $. An \textbf{open immersion} is a morphism $ f : X \to Y $ which induces a isomorphism of $ X $ with an open subscheme of $ Y $. A \textbf{closed immersion} $ f : X \to Y $ is a morphism which is a homeomorphism onto a closed subset of $ Y $, and the induced morphism $ f^\# : \OOO_Y \to f_*\OOO_X $ is surjective. A \textbf{closed subscheme} of $ Y $ is an equivalence class of closed immersions, where
$$
\begin{tikzcd}
X \arrow[dashed]{rr}{i} \arrow{dr} & & X' \arrow{dl} \\
& Y &
\end{tikzcd}
$$
are equivalent if there exists an isomorphism $ i $ making the diagram commute.
\end{definition*}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ Y = \Spec A $, let $ I \subseteq A $ be an ideal, and let $ X = \Spec A / I $. Note the map of schemes induced by the quotient map $ A \to A / I $ identifies $ \Spec A / I $ with $ \VV\br{I} \subseteq \Spec A $. Thus $ f : X \to Y $, induced by $ A \to A / I $, satisfies the first condition of being a closed immersion. Note that $ \OOO_Y \to f_*\OOO_X $ is surjective on stalks. For $ \ppp \in \VV\br{I} $, $ \OOO_{Y, \ppp} = A_\ppp $ and $ \br{f_*\OOO_X}_\ppp = \OOO_{X, \ppp} $ since all open sets in $ X $ are of the form $ U \cap X $ for $ U $ an open set of $ Y $ and $ \OOO_{X, \ppp} = \br{A / I}_{\ppp / I} $. Certainly $ A_\ppp \to \br{A / I}_{\ppp / I} $ is surjective.
\item Let $ \Spec k\sbr{x, y} / \abr{x} \to \Spec k\sbr{x, y} = \AA^2 $. This gives a closed subscheme structure to the set $ \VV\br{x} $. Note $ \VV\br{x^2, xy} = \VV\br{x} $. This gives a closed immersion $ \Spec k\sbr{x, y} / \abr{x^2, xy} \to \AA^2 $. This gives a different closed subscheme structure on $ \VV\br{x} $. Note these two subschemes are isomorphic away from the origin, which we can see by looking at $ \DD\br{y} \subseteq \Spec k\sbr{x, y} / \abr{x} $, where
$$ \DD\br{y} \cong \Spec \br{k\sbr{x, y} / \abr{x}}_y = \Spec k\sbr{y}_y. $$
Looking at $ \DD\br{y} \subseteq \Spec k\sbr{x, y} / \abr{x^2, xy} $,
$$ \DD\br{y} \cong \Spec \br{k\sbr{x, y} / \abr{x^2, xy}}_y \cong \Spec k\sbr{x, y}_y / \abr{x} \cong \Spec k\sbr{y}_y. $$
\end{itemize}
\end{example*}

\pagebreak

\subsection{Fibre products}

Let $ \CCC $ be a category and
$$
\begin{tikzcd}
& Y \arrow{d}{g} \\
X \arrow{r}[swap]{f} & Z
\end{tikzcd}
$$
be a diagram in $ \CCC $. Then the \textbf{fibre product}, if it exists, is an object $ W $ equipped with morphisms $ p : W \to X $ and $ q : W \to Y $ such that $ f \circ p = g \circ q $ satisfying the following universal property. For any $ W' $ equipped with maps $ p' : W' \to X $ and $ q' : W' \to Y $ such that $ f \circ p' = g \circ q' $, there exists a unique morphism $ h : W' \to W $ making the diagram
$$
\begin{tikzcd}
W' \arrow[dashed]{dr}{\exists !h} \arrow[bend left=30]{drr}{q'} \arrow[bend right=30]{ddr}[swap]{p'} & & \\
& W \arrow{r}{q} \arrow{d}[swap]{p} & Y \arrow{d}{g} \\
& X \arrow{r}[swap]{f} & Z
\end{tikzcd}
$$
commute, that is $ p \circ h = p' $ and $ q \circ h = q' $. Note that if the fibre product exists, it is unique up to unique isomorphism.

\begin{example*}
Let $ \CCC $ be the category of sets. Then
$$ X \times_Z Y = \cbr{\br{x, y} \in X \times Y \st f\br{x} = g\br{y}}. $$
\end{example*}

It will be helpful to think about the fibre product, and more generally other universal properties, via the Yoneda lemma.

\begin{definition*}
Let $ \CCC $ be a category. Write $ \h_X $ for the contravariant functor
$$ \functions[\h_X]{\CCC}{\Set}{Y}{\Hom\br{Y, X}}{f : Y \to Z}{\br{\phi \in \Hom\br{Z, X} \mapsto \phi \circ f \in \Hom\br{Y, X}}}. $$
\end{definition*}

Recall that a \textbf{natural transformation} between contravariant functors $ F, G : \CCC \to \DDD $, written as $ T : \CCC \to \DDD $, consists of the data $ T\br{X} : F\br{X} \to G\br{X} $ for all $ X \in \Ob \CCC $ such that for all $ f : X \to Y $ in $ \CCC $
$$
\begin{tikzcd}
F\br{X} \arrow{d}[swap]{T\br{X}} & F\br{Y} \arrow{l}[swap]{F\br{f}} \arrow{d}{T\br{Y}} \\
G\br{X} & G\br{Y} \arrow{l}{G\br{f}}
\end{tikzcd}
$$
is commutative.

\begin{lemma}[Yoneda's lemma]
The set of natural transformations between $ \h_X : \CCC \to \Set $ and $ G : \CCC \to \Set $ is $ G\br{X} $.
\end{lemma}

\begin{proof}
Given $ \eta \in G\br{X} $, we need to define a map
$$ \function{\h_X\br{Y} = \Hom\br{Y, X}}{G\br{Y}}{f}{G\br{f}\br{\eta}}, $$
for all objects $ Y \in \CCC $. Check that this defines a natural transformation $ \h_X \to G $. \footnote{Exercise} Conversely, given $ T : \h_X \to G $ a natural transformation, take $ \eta = T\br{X}\br{\id_X} $. Check that these two maps are inverse to each other. \footnote{Exercise}
\end{proof}

\begin{corollary}
The set of natural transformations $ \h_X \to \h_Y $ is $ \h_Y\br{X} = \Hom\br{X, Y} $.
\end{corollary}

\pagebreak

\begin{definition*}
A contravariant functor $ F : \CCC \to \Set $ is said to be \textbf{representable} if $ F \cong \h_X $ for some $ X \in \Ob \CCC $.
\end{definition*}

Lots of questions in algebraic geometry are about representability of functors. Redefining, the fibre product in a category $ \CCC $ is an object which represents the functor
$$ T \mapsto \Hom\br{T, X} \times_{\Hom\br{T, Z}} \Hom\br{T, Y}, $$
since an element of the set $ \Hom\br{T, X} \times_{\Hom\br{T, Z}} \Hom\br{T, Y} $ is a commutative diagram
$$
\begin{tikzcd}
T \arrow[dashed]{dr} \arrow[bend left=30]{drr}{q} \arrow[bend right=30]{ddr}[swap]{p} & & \\
& W \arrow{r} \arrow{d} & Y \arrow{d}{g} \\
& X \arrow{r}[swap]{f} & Z
\end{tikzcd}.
$$
The advantage of using Yoneda is that we can check identities using fibre products using identities of fibre products of sets.

\begin{example*}
In $ \Set $,
$$ \bijection{\br{A \times_B C} \times_C D}{A \times_B D}{\br{\br{a, c}, d}}{\br{a, d}}{\br{\br{a, f\br{d}}, d}}{\br{a, d}}, \qquad f : D \to C. $$
Then we have two functors
$$
\begin{tikzcd}
T \arrow{r} \arrow{dr} & \br{\h_A\br{T} \times_{\h_B\br{T}} \h_C\br{T}} \times_{\h_C\br{T}} \h_D\br{T} \arrow{d}{\sim} \\
& \h_A\br{T} \times_{\h_B\br{T}} \h_D\br{T}
\end{tikzcd},
$$
and natural transformations showing those functors are isomorphic, and hence represent isomorphic objects.
\end{example*}

\lecture{11}{Monday}{02/11/20}

\begin{theorem}
Fibre products exist in the category of schemes.
\end{theorem}

\begin{proof}
Will construct $ X \times_S Y $ for various cases, bootstrapping up to the general case.
\begin{enumerate}[leftmargin=0.5in, label=Step \arabic*.]
\item Let $ X = \Spec A $, let $ Y = \Spec B $, and let $ S = \Spec R $, so
$$
\begin{tikzcd}
& Y \arrow{d} \\
X \arrow{r} & S
\end{tikzcd}
\qquad \iff \qquad
\begin{tikzcd}
& B \\
A & R \arrow{u} \arrow{l}
\end{tikzcd}.
$$
Push-outs exist in the category of rings, so
$$
\begin{tikzcd}
C & & \\
& A \otimes_R B \arrow[dashed]{ul}[swap]{\exists !h} & B \arrow[bend right=30]{ull}[swap]{p_2'} \arrow{l}[swap]{p_2} \\
& A \arrow[bend left=30]{uul}{p_1'} \arrow{u}{p_1} & R \arrow{u}[swap]{g} \arrow{l}{f}
\end{tikzcd},
$$
where $ p_1\br{a} = a \otimes 1 $ and $ p_2\br{b} = 1 \otimes b $. Here $ h $ is defined by $ h\br{a \otimes b} = p_1'\br{a}p_2'\br{b} $. Check well-defined. \footnote{Exercise} Thus $ \Spec A \otimes_R B $ is $ \Spec A \times_{\Spec R} \Spec B $ in the category of affine schemes.

\pagebreak

If $ T $ is an arbitrary scheme, then giving a morphism $ T \to \Spec A $ is the same as giving a morphism $ A \to \Gamma\br{T, \OOO_T} $, by question $ 12 $, example sheet $ 1 $. Thus giving a commutative diagram
$$
\begin{tikzcd}
T \arrow[bend left=30]{drr} \arrow[bend right=30]{ddr} & & \\
& & \Spec B \arrow{d} \\
& \Spec A \arrow{r} & \Spec R
\end{tikzcd}
$$
is equivalent to
$$
\begin{tikzcd}
\Gamma\br{T, \OOO_T} & & \\
& A \otimes_R B \arrow[dashed]{ul}[swap]{\exists !h} & B \arrow[bend right=30]{ull} \arrow{l} \\
& A \arrow[bend left=30]{uul} \arrow{u} & R \arrow{u}[swap]{g} \arrow{l}{f}
\end{tikzcd},
$$
and $ h : A \otimes_R B \to \Gamma\br{T, \OOO_T} $ induces a map $ T \to \Spec A \otimes_R B $. Thus $ \Spec A \otimes_R B $ is the fibre product $ \Spec A \times_{\Spec R} \Spec B $ in the category of schemes.
\item Will construct more general fibre products by gluing of schemes using question $ 14 $ on example sheet $ 1 $. We also glue morphisms, so if $ X $ and $ Y $ are schemes, $ \cbr{U_i} $ an open cover of $ X $, and we are given morphisms $ f_i : U_i \to Y $ such that $ \eval{f_i}_{U_i \cap U_j} = \eval{f_j}_{U_i \cap U_j} $, then we obtain $ f : X \to Y $ such that $ \eval{f}_{U_i} = f_i $. The argument is given in the examples class.
\item If $ X, Y \to S $ are given and $ U \subseteq X $ is open, suppose that $ X \times_S Y $ exists, with projections $ p_1 : X \times_S Y \to X $ and $ p_2 : X \times_S Y \to Y $. Then $ p_1^{-1}\br{U} $ is $ U \times_S Y $. By commutativity of the diagram
$$
\begin{tikzcd}
T \arrow[dashed]{dr}[swap]{\exists! h} \arrow{drr}{\exists !h'} \arrow[bend left=30]{drrr} \arrow[bend right=30]{ddr} & & & \\
& p_1^{-1}\br{U} \arrow[hookrightarrow]{r} \arrow{d} & X \times_S Y \arrow{r} \arrow{d} & Y \arrow{d} \\
& U \arrow[hookrightarrow]{r} & X \arrow{r} & S
\end{tikzcd},
$$
the image of $ h' $ must be contained in $ p_1^{-1}\br{U} $. Thus $ h' $ factors through $ p_1^{-1}\br{U} \hookrightarrow X \times_S Y $ giving the unique map $ h $, so the universal property holds for $ p_1^{-1}\br{U} $.
\item Suppose $ \cbr{X_i} $ is an open cover of $ X $ and $ X_i \times_S Y $ exists for each $ i $. Then $ X \times_S Y $ exists. Let $ X_{ij} = X_i \cap X_j $, and let $ U_{ij} = p_1^{-1}\br{X_{ij}} \subseteq X_i \times_S Y $. By step $ 3 $, $ U_{ij} = X_{ij} \times_S Y $. By the universal property of fibre products there exists a unique isomorphism $ \phi_{ij} : U_{ij} \to U_{ji} $. Check these gluing maps $ \phi_{ij} $ satisfy the requirements of question $ 14 $ on example sheet $ 1 $. \footnote{Exercise: check} Thus we can glue the $ X_i \times_S Y $ via $ \phi_{ij} $'s to get a scheme $ X \times_S Y $, but need to check it satisfies the fibre product axioms. So suppose given
$$
\begin{tikzcd}
T \arrow[bend left=30]{drr}{p_2'} \arrow[bend right=30]{ddr}[swap]{p_1'} & & \\
& & Y \arrow{d} \\
& X \arrow{r} & S
\end{tikzcd}.
$$

\pagebreak

Let $ T_i = \br{p_1'}^{-1}\br{X_i} $, so get a morphism $ \theta_i : T_i \to X_i \times_S Y \hookrightarrow X \times_S Y $, where $ X_i \times_S Y \hookrightarrow X \times_S Y $ is an open immersion by construction. On $ T_i \cap T_j $ these maps agree since they factor through $ X_{ij} \times_S Y \subseteq X_i \times_S Y $ and $ X_{ji} \times_S Y \subseteq X_j \times_S Y $ and by the universal property they agree. Thus using step $ 2 $, we can glue the $ \theta_i $'s to get $ \theta : T \to X \times_S Y $.
\item Using step $ 4 $ and $ 1 $ we may construct $ X \times_S Y $ when $ S $ and $ Y $ are affine. Repeating for $ Y $, we obtain $ X \times_S Y $ when $ S $ is affine, and $ X $ and $ Y $ are arbitrary.
\item Let $ X, Y, S $ be arbitrary, take an open affine cover $ \cbr{S_i} $ of $ S $, let $ f : X \to S $ and $ g : Y \to S $, and let $ X_i = f^{-1}\br{S_i} $ and $ Y_i = g^{-1}\br{S_i} $. Then $ X_i \times_{S_i} Y_i $ exists and $ X_i \times_{S_i} Y_i = X_i \times_S Y_i $. \footnote{Exercise: check, immediate from universal property} Use the same gluing argument as before, to get $ X \times_S Y $.
\end{enumerate}
\end{proof}

\subsection{Fibres of morphisms}

The philosophy in $ \Set $ is
$$
\begin{tikzcd}
f^{-1}\br{y} = \cbr{y} \times_Y X \arrow{r} \arrow{d} & X \arrow{d}{f} \\
\cbr{y} \arrow{r} & Y
\end{tikzcd}.
$$
Given $ f : X \to Y $ a morphism and $ y \in Y $, let $ \kappa\br{y} = \OOO_{Y, y} / \mmm_y $ be the residue field of $ y $, so we get a morphism $ \Spec \kappa\br{y} \to Y $ with image $ y $. Then we define
$$ X_y = \Spec \kappa\br{y} \times_Y X $$
to be the \textbf{scheme-theoretic fibre} of $ f $ at $ y $.

\begin{example*}
Let $ f : X = \Spec k\sbr{x} \to Y = \Spec k\sbr{t} $ be induced by
$$ \function{k\sbr{t}}{k\sbr{x}}{t}{x^2}. $$
For $ y = \abr{t - a} \subseteq k\sbr{t} $ and $ a \in k $, $ \kappa\br{y} = k\sbr{t} / \abr{t - a} \cong k $. If $ B $ is an $ A $-algebra then $ A / I \otimes_A B = B / IB $, so
$$ X_y = \Spec \kappa\br{y} \otimes_{k\sbr{t}} k\sbr{x} = \Spec k\sbr{x} / \abr{x^2 - a}. $$
If $ a \ne 0 $ and $ \ch k \ne 2 $, we obtain either $ X_y $ consists of two distinct points, if $ \sqrt{a} \in k $, or a single point if $ \sqrt{a} \notin k $. If $ a = 0 $, we get $ \Spec k\sbr{x} / \abr{x^2} $.
\end{example*}

\begin{remark*}
\hfill
\begin{itemize}
\item In general, it is hard to calculate fibre products, since $ X \times_S Y $ is not the set-theoretic fibre product in general. For example, $ \AA_k^1 \times_{\Spec k} \AA_k^1 = \Spec k\sbr{x} \otimes_k k\sbr{y} = \Spec k\sbr{x, y} = \AA_k^2 $.
\item If we are interested only in varieties, such as schemes over a field $ k $, the usual product of varieties $ X \times Y $ corresponds to $ X \times_{\Spec k} Y $. More generally, if we are working in the category $ \Sch / S $, the natural product is $ X \times_S Y $.
\item Given schemes $ S $ and $ T $ with a morphism $ T \to S $, we get a functor
$$ \function{\Sch / S}{\Sch / T}{\br{X \to S}}{\br{X \times_S T \to T}}. $$
This functor is called \textbf{base-change}.
\end{itemize}
\end{remark*}

\pagebreak

\lecture{12}{Wednesday}{04/11/20}

\begin{example*}
Consider a scheme $ X $ over $ \Spec \ZZ $, such as $ X = \Proj \ZZ\sbr{x, y, z} / \abr{x^n + y^n - z^n} \to \Spec \ZZ $. May consider base-changes
\begin{itemize}
\item $ \Spec \FF_p \to \Spec \ZZ $, induced by $ \ZZ \to \ZZ / p\ZZ \cong \FF_p $, which gives $ X \times_{\Spec \ZZ} \Spec \FF_p = \Proj \FF_p\sbr{x, y, z} / I $,
\item $ \Spec \QQ \to \Spec \ZZ $, induced by $ \ZZ \to \QQ $, which gives $ X \times_{\Spec \ZZ} \Spec \QQ = \Proj \QQ\sbr{x, y, z} / I $, or
\item $ \Spec \CC \to \Spec \ZZ $, induced by $ \ZZ \to \CC $, which gives $ X \times_{\Spec \ZZ} \Spec \CC = \Proj \CC\sbr{x, y, z} / I \subseteq \PP_\CC^2 $,
\end{itemize}
where $ I = \abr{x^n - y^n - z^n} $.
\end{example*}

\subsection{Properties of schemes and morphisms of schemes}

See example sheet $ 2 $ for more details or your favourite algebraic geometry text.

\begin{definition*}
A scheme $ X $ is \textbf{integral} if for every $ U \subseteq X $ open, $ \OOO_X\br{U} $ is an integral domain.
\end{definition*}

\begin{definition*}
A scheme $ X $ is \textbf{reduced} if for every $ U \subseteq X $ open, $ \OOO_X\br{U} $ has no nilpotents.
\end{definition*}

\begin{definition*}
A scheme $ X $ is \textbf{irreducible} if the underlying topological space $ X $ is irreducible, that is if $ X = X_1 \cup X_2 $ with $ X_1, X_2 \subseteq X $ closed, then either $ X_1 = X $ or $ X_2 = X $.
\end{definition*}

\begin{example*}
Let $ X = \Spec k\sbr{x, y} / \abr{xy} $.
\begin{itemize}
\item $ X $ is not integral because $ \Gamma\br{X, \OOO_X} = k\sbr{x, y} / \abr{xy} $ is not an integral domain, since $ xy = 0 $.
\item $ X $ is reduced.
\item $ X $ is not irreducible, since $ X = \VV\br{x} \cup \VV\br{y} $.
\end{itemize}
\end{example*}

\begin{theorem}
$ X $ is integral if and only if $ X $ is reduced and irreducible.
\end{theorem}

\begin{definition*}
Let $ X $ be a scheme. It is \textbf{locally Noetherian} if there exists a cover $ \cbr{U_i} $ of $ X $ with $ U_i = \Spec A_i $ affine and $ A_i $ Noetherian. Then $ X $ is \textbf{Noetherian} if the cover may be taken to be finite.
\end{definition*}

\begin{example*}
$ \Spec k\sbr{x_1, x_2, \dots} $ with a countable number of variables is not locally Noetherian.
\end{example*}

Not obvious, but can show that $ X $ is locally Noetherian if and only if, if $ U \subseteq X $ is affine and $ U = \Spec A $, then $ A $ is Noetherian.

\begin{definition*}
A morphism $ f : X \to Y $ of schemes is \textbf{locally of finite type} if there is a covering of $ Y $ by affine open sets $ \cbr{V_i = \Spec B_i} $ such that for each $ i $, $ f^{-1}\br{V_i} $ can be covered by affine open sets $ \cbr{U_{ij} = \Spec A_{ij}} $, where each $ A_{ij} $ is a finitely generated $ B_i $-algebra. We say $ f $ is of \textbf{finite type} if for each $ i $, the cover $ \cbr{U_{ij}} $ may be taken to be finite.
\end{definition*}

\begin{definition*}
Let $ k $ be an algebraically closed field. A \textbf{variety over $ k $} is a scheme $ X $ over $ \Spec k $ which is integral and $ X \to \Spec k $ is of finite type. That is, $ X $ can be covered by a finite number of open affines $ U_i = \Spec A_i $ with $ A_i $ a finitely generated $ k $-algebra. The $ A_i $ must be integral domains, so $ A_i = k\sbr{x_1, \dots, x_n} / I $ where $ I $ is a prime ideal.
\end{definition*}

Note that this still allows a non-Hausdorff scheme $ \AA^1 \cup \AA^1 $ obtained by gluing $ \DD\br{x} \subseteq \AA^1 $ to $ \DD\br{x} \subseteq \AA^1 $.

\begin{example*}
Let $ X_i = \Spec k\sbr{x_i, y_i} / \abr{x_iy_i} $ for $ i \in \ZZ $. Glue $ X_i $ to $ X_{i + 1} $ along open subsets $ U_{i, i + 1} \subseteq X_i $ given by $ \DD\br{x_i} $ and $ U_{i + 1, i} \subseteq X_{i + 1} $ given by $ \DD\br{y_{i + 1}} $ via the map
$$ \function{k\sbr{y_{i + 1}}_{y_{i + 1}}}{k\sbr{x_i}_{x_i}}{y_{i + 1}}{x_i^{-1}}. $$
Doing this for all $ i $, we get an infinite chain of $ \PP^1 $'s. Note $ \cbr{X_i} $ forms an open cover of $ X $ but has no finite subcover. Not quasi-compact, only locally of finite type over $ \Spec k $.
\end{example*}

\pagebreak

\subsection{Separated and proper morphisms}

\begin{remark*}
A topological space $ X $ is Hausdorff if and only if the diagonal $ \Delta = \cbr{\br{x, x} \st x \in X} \subseteq X \times X $ is closed.
\end{remark*}

\begin{example*}
Let $ X $ be $ \RR $ with doubled origin in the usual Euclidean topology. Then $ X \times X $ is $ \RR^2 $ with doubled axes and four origins. Then $ \Delta $ only contains two origins but other origins are in the closure of $ \Delta $.
\end{example*}

\begin{definition*}
Let $ f : X \to Y $ be a morphism of schemes, and $ \Delta : X \to X \times_Y X $ be the morphism induced by the diagram
$$
\begin{tikzcd}
X \arrow[bend left=30]{drr}{\id_X} \arrow[bend right=30]{ddr}[swap]{\id_X} & & \\
& & X \arrow{d}{f} \\
& X \arrow{r}[swap]{f} & Y
\end{tikzcd}.
$$
We say $ f $ is \textbf{separated} if $ \Delta $ is a closed immersion.
\end{definition*}

\begin{theorem}[Valuative criterion for separatedness]
Let $ f : X \to Y $ be a morphism and $ X $ Noetherian. Then $ f $ is separated if and only if the following condition holds. For any field $ k $ and any valuation ring $ R \subseteq k $, that is for any $ x \in k $ such that $ x \ne 0 $ either $ x \in R $ or $ x^{-1} \in R $, let $ T = \Spec R $ and $ U = \Spec k $, and $ \iota : U \to T $ be the morphism induced by the inclusion $ R \hookrightarrow k $. Given a commutative diagram
$$
\begin{tikzcd}
U \arrow{r} \arrow{d}[swap]{\iota} & X \arrow{d}{f} \\
T \arrow[dashed]{ur}{\iota'} \arrow{r} & Y
\end{tikzcd},
$$
then there exists at most one morphism $ \iota' : T \to X $ making the diagram commute.
\end{theorem}

\lecture{13}{Friday}{06/11/20}

The intuition is if $ R $ is a valuation ring, it has a zero prime ideal and a unique maximal ideal, such that $ \overline{\cbr{0}} = \VV\br{0} = \Spec R = T $ and the maximal ideal is a closed point.

\begin{remark*}
We may now define a variety over a field $ k $ as a scheme $ X $ which is integral, and finite type and separated over $ \Spec k $.
\end{remark*}

\begin{definition*}
A morphism $ f : X \to Y $ is \textbf{proper} if it is separated, of finite type, and universally closed. That is, for any morphism $ Y' \to Y $ the induced projection $ X \times_Y Y' \to Y' $ is a closed map, that is the image of a closed set is closed.
\end{definition*}

\begin{example*}
\hfill
\begin{itemize}
\item $ \PP_k^n = \Proj k\sbr{x_0, \dots, x_n} \to \Spec k $ is proper.
\item $ \AA_k^1 \to \Spec k $ is not proper. Consider the base-change by $ \AA_k^1 \to \Spec k $. Let
$$ \function[p_2]{\AA_k^1 \times_{\Spec k} \AA_k^1 = \AA_k^2 = \Spec k\sbr{x} \otimes_k k\sbr{y} = \Spec k\sbr{x, y}}{\AA_k^1 = \Spec k\sbr{t}}{\br{x, y}}{y}. $$
This is not a closed map. For example, $ p_2\br{\VV\br{xy - 1}} = \DD\br{t} $, which is open and not closed.
\end{itemize}
\end{example*}

\begin{theorem}[Valuative criterion for properness]
Let $ f : X \to Y $ be a finite type morphism with $ X $ Noetherian. Then $ f $ is proper if as in the criterion for separatedness, whenever given a diagram
$$
\begin{tikzcd}
\Spec k = U \arrow{r} \arrow{d} & X \arrow{d}{f} \\
\Spec R = T \arrow[dashed]{ur}{\exists !g} \arrow{r} & Y
\end{tikzcd},
$$
there exists a unique morphism $ g : T \to X $ making the diagram commute.
\end{theorem}

\begin{example*}
Projective varieties, that is closed subvarieties in $ \PP_k^n $, are proper over $ \Spec k $.
\end{example*}

\section{Sheaves of \texorpdfstring{$ \OOO_X $-modules}{modules}}

The idea is to go from the notion of an $ A $-module $ M $ to the notion of an $ \OOO_X $-module $ \FFF $.

\subsection{Sheaves of modules}

\begin{definition*}
Let $ \br{X, \OOO_X} $ be a ringed space. A \textbf{sheaf of $ \OOO_X $-modules} is a sheaf of abelian groups $ \FFF $ on $ X $ such that for each $ U \subseteq X $, $ \FFF\br{U} $ has the structure of an $ \OOO_X\br{U} $-module, compatible with restriction, that is if $ s \in \OOO_X\br{U} $ and $ m \in \FFF\br{U} $, then $ \eval{s}_V \cdot \eval{m}_V = \eval{\br{s \cdot m}}_V $ for $ V \subseteq U $. A \textbf{morphism of sheaves of $ \OOO_X $-modules} $ \phi : \FFF \to \GGG $ is a morphism of sheaves of abelian groups such that for all $ U \subseteq X $, $ \phi_U : \FFF\br{U} \to \GGG\br{U} $ is a homomorphism of $ \OOO_X\br{U} $-modules.
\begin{itemize}
\item Kernels, cokernels, and images of morphisms of sheaves of $ \OOO_X $-modules are sheaves of $ \OOO_X $-modules.
\item $ \Hom_{\OOO_X}\br{\FFF, \GGG} $ denotes the group of $ \OOO_X $-module homomorphisms $ \cbr{\phi : \FFF \to \GGG} $. This is an $ \OOO_X\br{X} $-module. Then $ U \mapsto \Hom_{\OOO_U}\br{\eval{\FFF}_U, \eval{\GGG}_U} $, which is an $ \OOO_X\br{U} $-module, is a sheaf of $ \OOO_X $-modules, written $ \HOM_{\OOO_X}\br{\FFF, \GGG} $, the \textbf{sheaf hom}.
\item If $ \FFF $ and $ \GGG $ are $ \OOO_X $-modules, we denote by $ F \otimes_{\OOO_X} \GGG $ the sheaf associated to the presheaf $ U \mapsto \FFF\br{U} \otimes_{\OOO_X\br{U}} \GGG\br{U} $.
\item Push-forwards and pull-backs. For modules, let $ \phi : A \to B $ be a homomorphism of rings, let $ M $ be a $ B $-module, and let $ N $ be an $ A $-module. Then $ M $ is also an $ A $-module such that
$$ a \cdot m = \phi\br{a} \cdot m, \qquad a \in A, \qquad m \in M, $$
and $ B \otimes_A N $ is a $ B $-module via
$$ b \cdot \br{b' \otimes n} = bb' \otimes n, \qquad b \in B, \qquad b' \otimes n \in B \otimes_A N. $$
Given $ f : X \to Y $ a morphism of ringed spaces, so $ f^\# : \OOO_Y \to f_*\OOO_X $, if $ \FFF $ is a sheaf of $ \OOO_X $-modules and $ \GGG $ is a sheaf of $ \OOO_Y $-modules, then the following holds.
\begin{itemize}
\item $ f_*\FFF $ is naturally a sheaf of $ f_*\OOO_X $-modules, since $ \br{f_*\FFF}\br{U} = \FFF\br{f^{-1}\br{U}} $ is an $ \br{f_*\OOO_X}\br{U} = \OOO_X\br{f^{-1}\br{U}} $-module, and hence $ f_*\FFF $ is an $ \OOO_Y $-module via $ f^\# $.
\item $ f^{-1}\GGG $ is naturally a sheaf of $ f^{-1}\OOO_Y $-modules. But $ f^\# $ induces the adjoint map $ f^\# : f^{-1}\OOO_Y \to \OOO_X $, by question $ 10 $ on example sheet $ 1 $. Define
$$ f^*\GGG = f^{-1}\GGG \otimes_{f^{-1}\OOO_Y} \OOO_X. $$
This is a sheaf of $ \OOO_X $-modules.
\end{itemize}
\end{itemize}
\end{definition*}

If $ S \subseteq A $ is a multiplicatively closed subset, then
$$ S^{-1}M = \cbr{\dfrac{m}{a} \st a \in S, \ m \in M} / \sim, $$
where $ m / a \sim m / a' $ if and only if there exists $ b \in S $ such that $ b\br{ma' - m'a} = 0 $. Also, $ S^{-1}M = M \otimes_A S^{-1}A $.

\begin{example*}
Let $ X = \Spec A $ be an affine scheme, and let $ M $ be an $ A $-module. For $ \ppp \in \Spec A $, we have the localisation $ M_\ppp = M \otimes_A A_\ppp $. Define a sheaf $ \widetilde{M} $ on $ \Spec A $ by
$$ \widetilde{M}\br{U} = \cbr{s : U \to \bigsqcup_{\ppp \in U} M_\ppp \st \begin{array}{l} \forall \ppp \in U, \ s\br{\ppp} \in M_\ppp, \\ \forall \ppp \in U, \ \exists \ppp \in V \subseteq U \ \text{open}, \ \exists m \in M, \ \exists s \in A, \ \forall \qqq \in V, \ s \notin \qqq, \ s\br{\qqq} = \dfrac{m}{s} \end{array}}. $$
\end{example*}

\begin{example*}
$ \widetilde{A} = \OOO_{\Spec A} $.
\end{example*}

\pagebreak

\begin{proposition}
\hfill
\begin{itemize}
\item $ \widetilde{M}_\ppp = M_\ppp $.
\item $ \widetilde{M}\br{\DD\br{f}} = M_f $.
\item $ \Gamma\br{\Spec A, \widetilde{M}} = M $.
\end{itemize}
\end{proposition}

\begin{proof}
Exactly as the corresponding statements for $ \OOO_{\Spec A} $.
\end{proof}

\subsection{Locally free and coherent modules}

\begin{definition*}
A sheaf of $ \OOO_X $-modules is \textbf{free} if it is isomorphic to $ \bigoplus_{i \in I} \OOO_X $ for some index set $ I $. If $ \#I = r < \infty $, then we say $ \FFF $ has \textbf{rank} $ r $. A sheaf $ \FFF $ is \textbf{locally free} of rank $ r $ if there exists an open cover $ \cbr{U_i} $ on $ X $ such that $ \eval{\FFF}_{U_i} $ is free of rank $ r $ for each $ i $. Then $ \FFF $ is a \textbf{line bundle} if it is rank one. Often more generally, one might refer to a rank $ r $ locally free sheaf as a rank $ r $ \textbf{vector bundle}.
\end{definition*}

\lecture{14}{Monday}{09/11/20}

\begin{remark*}
One way to define the notion of a vector bundle over a $ k $-scheme $ X $ as another scheme $ E $ with a morphism $ \pi : E \to X $ whose fibres are $ \AA^r $, and there exists an open cover $ \cbr{U_i} $ such that $ \pi^{-1}\br{U_i} \cong U_i \times \AA^r $, and other conditions. We get a sheaf
$$ \EEE\br{U} = \cbr{s : U \to \pi^{-1}\br{U} \st \pi \circ s = \id_U}. $$
This gives a locally free sheaf on $ X $. See somewhere in Hartshorne II.5 exercises.
\end{remark*}

\begin{example*}
Let $ E = X \times \AA^1 $. Then $ \EEE\br{U} = \OOO_X\br{U} $. Giving a morphism $ s : U \to U \times_{\Spec k} \AA_k^1 $ whose composition with $ \pi_1 : U \times_{\Spec k} \AA_k^1 \to U $ is the identity is the same as giving a morphism $ f : U \to \AA_k^1 $, since
$$
\begin{tikzcd}
U \arrow[dashed]{dr}{s} \arrow[bend left=30]{drr}{f} \arrow[bend right=30]{ddr}[swap]{\id_U} & & \\
& U \times_{\Spec k} \AA_k^1 \arrow{r} \arrow{d}[swap]{\pi_1} & \AA_k^1 \arrow{d} \\
& U \arrow{r} & \Spec k
\end{tikzcd}.
$$
Giving $ U \to \AA_k^1 $ is the same thing as giving a $ k $-algebra homomorphism
$$ \function{k\sbr{x}}{\OOO_X\br{U}}{x}{\phi}. $$
The set of such homomorphisms is $ \OOO_X\br{U} $.
\end{example*}

\begin{definition*}
Let $ X $ be a scheme and $ \FFF $ a sheaf of $ \OOO_X $-modules on $ X $. We say $ \FFF $ is \textbf{quasi-coherent} if $ X $ can be covered with affines $ U_i = \Spec A_i $ such that $ \eval{\FFF}_{U_i} \cong \widetilde{M_i} $ for some $ A_i $-module $ M_i $. We say $ \FFF $ is \textbf{coherent} if each $ M_i $ can be taken to be finitely generated.
\end{definition*}

\begin{example*}
A locally free sheaf is always quasi-coherent and coherent if of finite rank. If $ U \subseteq X $ satisfies $ \eval{\FFF}_U = \bigoplus_{i \in I} \OOO_U $, then $ \eval{\FFF}_U = \widetilde{\bigoplus_{i \in I} A} $ for $ U = \Spec A $.
\end{example*}

Kernels, cokernels, images, tensor products, and hom sheaves of quasi-coherent sheaves of $ \OOO_X $-modules are quasi-coherent. This follows since those operations commute with $ \widetilde{\cdot} $, such as
$$ \ker \br{\widetilde{M_1} \to \widetilde{M_2}} = \widetilde{\ker \br{M_1 \to M_2}}, \quad \widetilde{M_1} \otimes_{\OOO_X} \widetilde{M_2} = \widetilde{M_1 \otimes_A M_2}, \quad \HOM_{\OOO_X}\br{\widetilde{M_1}, \widetilde{M_2}} = \widetilde{\Hom_A\br{M_1, M_2}}. $$

\pagebreak

\begin{remark*}
Note that if $ \LLL $ is a line bundle, say with trivialising cover $ \cbr{U_i} $, then we have on $ U_i \cap U_j $
$$ \phi_{ij} : \eval{\OOO_{U_i}}_{U_i \cap U_j} \xrightarrow{\sim} \eval{\LLL}_{U_i \cap U_j} \xrightarrow{\sim} \eval{\OOO_{U_j}}_{U_i \cap U_j}, $$
using trivialisations on $ U_i $ and $ U_j $. Then $ \phi_{ij} $ is an automorphism of $ \OOO_{U_i \cap U_j} $ as an $ \OOO_{U_i \cap U_j} $-module, and as such is given by multiplication by $ g_{ij} \in \OOO_X^*\br{U_i \cap U_j} $, where $ \OOO_X^* $ is the subsheaf of $ \OOO_X $ consisting of invertible sections of $ \OOO_X $. Note on $ U_i \cap U_j \cap U_k $, we have $ g_{ij}g_{jk} = g_{ik} $.
\end{remark*}

Now suppose given $ f : Y \to X $ a morphism. How do we think about $ f^*\LLL $? Let $ Y_i = f^{-1}\br{U_i} $ and $ f_i : Y_i \to U_i $. Then
$$ f_i^*\br{\eval{\LLL}_{U_i}} \cong f_i^*\OOO_{U_i} \cong f_i^{-1}\OOO_{U_i} \otimes_{f_i^{-1}\OOO_{U_i}} \OOO_{Y_i} \cong \OOO_{Y_i}, $$
since $ A \otimes_A M \cong M $. Now $ \eval{\br{f^*\LLL}}_{Y_i} \cong \OOO_{Y_i} $. So $ \cbr{U_i} $ pulls back to a trivialising cover for $ f^*\LLL $, so pull-back of a line bundle is a line bundle. Further the transition maps are given by $ f^\#\br{g_{ij}} $.

\begin{remark*}
Push-forward is not as well-behaved. For example, $ f_*\LLL' $ for $ \LLL' $ a line bundle on $ Y $ need not be a line bundle. In fact, it will always be quasi-coherent but not necessarily coherent.
\end{remark*}

If $ \LLL_1 $ and $ \LLL_2 $ are line bundles on $ X $, with a common trivialising cover $ \cbr{U_i} $ and with transition functions $ g_{ij} $ and $ h_{ij} $ respectively, then the following holds.
\begin{itemize}
\item The transition functions of $ \LLL_1 \otimes_{\OOO_X} \LLL_2 $ are $ g_{ij}h_{ij} $. Note if $ \cdot g : A \to A $ and $ \cdot h : A \to A $ are given, then these two homomorphisms induce the homomorphism $ \cdot g \otimes \cdot h : A \otimes_A A \to A \otimes_A A $, which is $ \cdot gh : A \to A $.
\item Set $ \LLL_1^\vee \cong \HOM_{\OOO_X}\br{\LLL_1, \OOO_X} $. This is also a line bundle because on $ U_i $, $ \eval{\LLL_1}_{U_i} \cong \OOO_{U_i} $, and since $ \Hom_A\br{A, A} = A $, $ \HOM_{\OOO_{U_i}}\br{\OOO_{U_i}, \OOO_{U_i}} = \OOO_{U_i} $. The transition maps are given by $ g_{ij}^{-1} $, since $ \cdot g_{ij} : \eval{\OOO_{U_i}}_{U_i \cap U_j} \to \eval{\OOO_{U_j}}_{U_i \cap U_j} $ has dual $ \cdot \br{g_{ij}^\intercal}^{-1} = \cdot g_{ij}^{-1} : \eval{\OOO_{U_i}}_{U_i \cap U_j} \to \eval{\OOO_{U_j}}_{U_i \cap U_j} $.
\end{itemize}
Note that $ \LLL_1^\vee \otimes_{\OOO_X} \LLL_1 $ has transition maps $ g_{ij}^{-1}g_{ij} = 1 $. Thus
$$ \LLL_1^\vee \otimes_{\OOO_X} \LLL_1 \cong \OOO_X. $$

\begin{definition*}
Let $ X $ be a scheme. Define $ \Pic X $, the \textbf{Picard group} of $ X $, to be the set of isomorphism classes of line bundles on $ X $. This is a group with product law
$$ \LLL_1 \cdot \LLL_2 = \LLL_1 \otimes_{\OOO_X} \LLL_2, \qquad \LLL^{-1} = \LLL^\vee = \HOM\br{\LLL, \OOO_X}. $$
\end{definition*}

\subsection{Morphisms to projective space}

Why are line bundles important? Fix a base scheme $ \Spec k $. Let $ \PP_k^n = \Proj k\sbr{x_1, \dots, x_n} $. Denote by $ \Sch / k $ the category of schemes over $ k $. Let $ F $ be the functor
$$ \function{\Sch / k}{\Set}{T}{\cbr{\text{surjections} \ \OOO_T^{\oplus \br{n + 1}} \twoheadrightarrow \LLL \ \text{for} \ \LLL \ \text{a line bundle on} \ T} / \cong}, $$
where $ \phi_1 : \OOO_T^{\oplus \br{n + 1}} \to \LLL $, and $ \phi_2 : \OOO_T^{\oplus \br{n + 1}} \to \LLL_2 $ are isomorphic if there exists an isomorphism $ f : \LLL_1 \to \LLL_2 $ of $ \OOO_X $-modules making
$$
\begin{tikzcd}
\LLL_1 \arrow{rr}{f} & & \LLL_2 \\
& \OOO_T^{\oplus \br{n + 1}} \arrow{ul}{\phi_1} \arrow{ur}[swap]{\phi_2} &
\end{tikzcd}
$$
commute. Given $ f : T_1 \to T_2 $ a morphism in $ \Sch / k $, we get a map of $ \Set $
$$ \function{F\br{T_2}}{F\br{T_1}}{\br{\phi : \OOO_{T_1}^{\oplus \br{n + 1}} \twoheadrightarrow \LLL}}{\br{f^*\phi : f^*\OOO_{T_2}^{\oplus \br{n + 1}} = \OOO_{T_1}^{\oplus \br{n + 1}} \twoheadrightarrow f^*\LLL}}. $$
This is a surjection by right exactness of tensor products.

\pagebreak

\begin{theorem}
$ F $ is represented by $ \PP_k^n $, that is $ F \cong \h_{\PP_k^n} $.
\end{theorem}

\begin{remark*}
This is an example of a \textbf{Quot scheme}, which is a scheme which represents a functor of the form $ T \mapsto \cbr{\OOO_T^{\oplus k} \twoheadrightarrow \EEE} $, where $ \EEE $ is a coherent sheaf satisfying some properties.
\end{remark*}

\lecture{15}{Wednesday}{11/11/20}

\begin{proof}
If the statement holds, then there is a universal object. That is, an element of $ F\br{\PP^n} $ corresponding to the identity $ \id_{\PP^n} \in \h_{\PP^n}\br{\PP^n} $, that is a surjective map $ \OOO_{\PP^n}^{\oplus \br{n + 1}} \twoheadrightarrow \LLL $. Further, following the proof of Yoneda's lemma, given $ f : X \to \PP^n $ and $ T : \h_{\PP^n} \to F $ the natural transformation giving the natural isomorphism of functors, we get a commutative diagram
$$
\begin{tikzcd}
\id_{\PP^n} \in \h_{\PP^n}\br{\PP^n} \arrow{r}{T\br{\PP^n}} \arrow{d}[swap]{\h_{\PP^n}\br{f}} & F\br{\PP^n} \ni \br{\OOO_{\PP^n}^{\oplus \br{n + 1}} \xrightarrow{\phi} \LLL} \arrow{d}{F\br{f}} \\
f \in \h_{\PP^n}\br{X} \arrow{r}[swap]{T\br{X}} & F\br{X} \ni \br{\OOO_X^{\oplus \br{n + 1}} \xrightarrow{f^*\phi} f^*\LLL}
\end{tikzcd}.
$$
That is, the element $ T\br{X}\br{f} $ is precisely $ f^*\phi : \OOO_X^{\oplus \br{n + 1}} \to f^*\LLL $. So the representing scheme $ \PP^n $ comes with the universal object $ \OOO_{\PP^n}^{\oplus \br{n + 1}} \twoheadrightarrow \LLL $. So we will construct the universal object. The line bundle we construct has a name, $ \OOO_{\PP^n}\br{1} $.
\begin{itemize}
\item If $ S = k\sbr{x_0, \dots, x_n} $, then $ \PP^n = \Proj S $ has an open cover
$$ \UUU = \cbr{\DD_+\br{x_i} \st 0 \le i \le n}, \qquad \DD_+\br{x_i} = \cbr{\ppp \in \Proj S \st x_i \in \ppp}. $$
We will take $ \UUU $ to be a trivialising cover for $ \OOO_{\PP^n}\br{1} $, with transition map given by
$$ g_{ij} = \dfrac{x_i}{x_j} = \dfrac{x_i^2}{x_ix_j} \in \OOO_{\PP^n}^*\br{\DD_+\br{x_i} \cap \DD_+\br{x_j}} = \OOO_{\PP^n}^*\br{\DD_+\br{x_ix_j}} = S_{\br{x_ix_j}}, $$
so $ g_{ji} = x_j / x_i = x_j^2 / x_ix_j $ and $ g_{ij}g_{jk} = \br{x_i / x_j}\br{x_j / x_k} = x_i / x_k = g_{ik} $. Have a morphism defined in $ \DD_+\br{x_i} $ by
$$ \function{\OOO_{\PP^n}^{\oplus \br{n + 1}}}{\OOO_{\PP^n}\br{1}}{e_j}{\dfrac{x_j}{x_i}}, \qquad e_j = \br{0, \dots, 0, 1, 0, \dots, 0}, $$
using the trivialisation of $ \OOO_{\PP^n}\br{1} $ on $ \DD_+\br{x_i} $, that is we have an isomorphism $ \eval{\OOO_{\PP^n}\br{1}}_{\DD_+\br{x_i}} \cong \OOO_{\DD_+\br{x_i}} \ni x_j / x_i $. Well-defined globally, since
$$
\begin{tikzcd}
& \eval{\OOO_{\PP^n}^{\oplus \br{n + 1}}}_{\DD_+\br{x_ix_k}} \arrow{dl}[swap]{e_j \mapsto \tfrac{x_j}{x_i}} \arrow{dr}{e_j \mapsto \tfrac{x_j}{x_k}} & \\
\eval{\OOO_{\DD_+\br{x_i}}}_{\DD_+\br{x_ix_k}} \arrow{rr}[swap]{\cdot g_{ik}} & & \eval{\OOO_{\DD_+\br{x_k}}}_{\DD_+\br{x_ix_k}}
\end{tikzcd},
$$
but $ g_{ik}\br{x_j / x_i} = \br{x_i / x_k}\br{x_j / x_i} = x_j / x_k $. Note in particular each $ e_j $ maps to a global section of $ \OOO_{\PP^n}\br{1} $. We now have a morphism $ \OOO_{\PP^n}^{\oplus \br{n + 1}} \to \OOO_{\PP^n}\br{1} $, and need to check surjective. On $ \DD_+\br{x_i} $, $ e_i \mapsto x_i / x_i = 1 \in \Gamma\br{\DD_+\br{x_i}, \OOO_{\PP^n}} = S_{\br{x_i}} $ so in particular, looking at sections over $ \DD_+\br{x_i} $, we get a homomorphism of $ S_{\br{x_i}} $-modules
$$ \function{S_{\br{x_i}}^{\oplus \br{n + 1}}}{S_{\br{x_i}}}{e_i}{1}, $$
so clearly a surjective map of modules. Thus $ \br{\psi : \OOO_{\PP^n}^{\oplus \br{n + 1}} \twoheadrightarrow \OOO_{\PP^n}\br{1}} \in F\br{\PP^n} $.

\pagebreak

\item It remains to show that given $ X $ and $ \br{\phi : \OOO_X^{\oplus \br{n + 1}} \twoheadrightarrow \LLL} \in F\br{X} $, we need that there exists a unique morphism $ f : X \to \PP^n $ such that
$$ \br{\phi : \OOO_X^{\oplus \br{n + 1}} \twoheadrightarrow \LLL} \cong \br{f^*\psi : \OOO_X^{\oplus \br{n + 1}} \to f^*\OOO_{\PP^n}\br{1}}. $$
Indeed, this will give the natural transformation $ F \to \h_{\PP^n} $, and the inverse natural transformation $ \h_{\PP^n} \to F $ is given by pull-back, that is $ f : X \to \PP^n $ gives $ f^*\psi : \OOO_X^{\oplus \br{n + 1}} \to f^*\OOO_{\PP^n}\br{1} $.
\begin{itemize}
\item Let $ \phi\br{e_i} = s_i \in \Gamma\br{X, \LLL} $. Define
$$ Z_i = \cbr{x \in X \st \br{s_i}_x \in \mmm_x\LLL_x}, \qquad \mmm_x \subseteq \OOO_{X, x}. $$
Claim that this is a closed set. This can be checked on an open cover $ \cbr{U_i} $, since $ Z \subseteq X $ is closed if and only if $ Z \cap U_i $ is closed in $ U_i $ for all $ i $. Thus we may use a trivialising affine cover $ \cbr{U_i} $ of $ X $. So we reduce to the case that $ X = \Spec A $ and $ \LLL \cong \OOO_{\Spec A} $, so $ \Gamma\br{X, \LLL} \cong A $ so $ s_i \in A $ induces $ \br{s_i}_\ppp = s_i / 1 \in A_\ppp $. Now $ s_i / 1 \in \mmm_\ppp A_\ppp $ if and only if $ s_i $ lies in the inverse image $ \ppp $ of $ \mmm_\ppp A_\ppp $ under the localisation map $ A \to A_\ppp $. Thus $ Z_i = \VV\br{s_i} $, a closed set. Let
$$ U_i = X \setminus Z_i. $$
Then there is an isomorphism \footnote{Exercise: check on stalks}
$$ \bijection{\OOO_{U_i}}{\eval{\LLL}_{U_i}}{1}{s_i}{\dfrac{s}{s_i}}{s}. $$
Interpret $ s / s_i $ as the element of $ \OOO_{U_i} $ such that $ \br{s / s_i}s_i = s $.

\lecture{16}{Friday}{13/11/20}

\item We may now define a morphism $ f_i : U_i = X \setminus Z_i \to \DD_+\br{x_i} = \Spec S_{\br{x_i}} $ by giving a homomorphism by
$$ \function[f_i^\#]{S_{\br{x_i}} = k\sbr{\dfrac{x_0}{x_i}, \dots, \dfrac{x_n}{x_i}}}{\Gamma\br{U_i, \OOO_X}}{\dfrac{x_j}{x_i}}{\dfrac{s_j}{s_i}}, $$
defining $ f_i^\# $ as a $ k $-algebra homomorphism. To get a morphism $ f : X \to \PP^n $ such that $ \eval{f}_{U_i} = f_i $, we need to check $ \eval{f_i}_{U_i \cap U_j} = \eval{f_j}_{U_i \cap U_j} $. Check that
$$ \functions[\eval{f_i^\#}_{U_i \cap U_j}]{\Gamma\br{\DD_+\br{x_i} \cap \DD_+\br{x_j}, \OOO_{\PP^n}} = S_{\br{x_ix_j}}}{\Gamma\br{U_i \cap U_j, \OOO_X}}{\dfrac{x_k}{x_i}}{\dfrac{s_k}{s_i}}{\dfrac{x_k}{x_j} = \dfrac{\tfrac{x_k}{x_i}}{\tfrac{x_j}{x_i}}}{\dfrac{\tfrac{s_k}{s_i}}{\tfrac{s_j}{s_i}} = \dfrac{s_k}{s_j}}, $$
$$ \functions[\eval{f_j^\#}_{U_i \cap U_j}]{\Gamma\br{\DD_+\br{x_i} \cap \DD_+\br{x_j}, \OOO_{\PP^n}} = S_{\br{x_ix_j}}}{\Gamma\br{U_i \cap U_j, \OOO_X}}{\dfrac{x_k}{x_j}}{\dfrac{s_k}{s_j}}{\dfrac{x_k}{x_i} = \dfrac{\tfrac{x_k}{x_j}}{\tfrac{x_i}{x_j}}}{\dfrac{\tfrac{s_k}{s_j}}{\tfrac{s_i}{s_j}} = \dfrac{s_k}{s_i}}. $$
So $ \eval{f_i^\#}_{U_i \cap U_j} = \eval{f_j^\#}_{U_i \cap U_j} $, so $ \eval{f_i}_{U_i \cap U_j} = \eval{f_j}_{U_i \cap U_j} $, so the morphisms glue to give $ f : X \to \PP^n $. Further, $ f^*\OOO_{\PP^n}\br{1} \cong \LLL $, because the transition maps $ g_{ij} = x_i / x_j $ of $ \OOO_{\PP^n}\br{1} $ pull back under $ f^\# $ to $ s_i / s_j $, which are the transition maps for $ \LLL $ using trivialisations for $ \eval{\LLL}_{U_i} $ which we used above.

\pagebreak

\item For uniqueness, suppose given a surjection $ \OOO_X^{\oplus \br{n + 1}} \twoheadrightarrow \LLL $ and a morphism $ g : X \to \PP^n $ such that
$$ g^*\br{\OOO_{\PP^n}^{\oplus \br{n + 1}} \to \OOO_{\PP^n}\br{1}} \cong \br{\phi : \OOO_X^{\oplus \br{n + 1}} \twoheadrightarrow \LLL}. $$
We may think of $ \phi $ as given by $ n + 1 $ sections $ s_0, \dots, s_n \in \Gamma\br{X, \LLL} $ with $ s_i = \phi\br{e_i} $. Similarly the universal object on $ \PP^n $ is given by sections $ x_i \in \Gamma\br{\PP^n, \OOO_{\PP^n}\br{1}} $. Note by the construction of the universal object, the section $ x_j $ is given on $ \DD_+\br{x_i} $ by $ x_j / x_i \in S_{\br{x_i}} $. If $ f : X \to Y $ and $ \FFF $ is a sheaf of $ \OOO_Y $-modules, then $ s \in \Gamma\br{Y, \FFF} $ induces a section $ \br{Y, s} $ in $ \Gamma\br{X, f^{-1}\FFF} $, and hence a section
$$ f^*s = \br{Y, s} \otimes 1 \in \Gamma\br{X, f^{-1}\FFF \otimes_{f^{-1}\OOO_X} \OOO_X} = \Gamma\br{X, f^*\FFF}. $$
In particular, pull-back of the section $ x_i \in \Gamma\br{\PP^n, \OOO_{\PP^n}\br{1}} $ is $ s_i $, that is $ g^*x_i = s_i $. In particular, $ \br{s_i}_x \in \mmm_x\LLL_x $ for some $ x \in X $ if and only if $ \br{x_i}_{g\br{x}} \in \mmm_{g\br{x}}\OOO_{\PP^n}\br{1}_{g\br{x}} $. Thus $ U_i = \cbr{x \in X \st \br{s_i}_x \notin \mmm_x\LLL_x} $ satisfies $ U_i = g^{-1}\br{\DD_+\br{x_i}} $. So we have $ g_i = \eval{g}_{U_i} : U_i \to \DD_+\br{x_i} $ and it is enough to show $ g_i = f_i $, where $ f_i $ was constructed previously from $ \OOO_X^{\oplus \br{n + 1}} \twoheadrightarrow \LLL $. So it is enough to check $ g_i^\# = f_i^\# $, and
$$ g_i^\#\br{\dfrac{x_j}{x_i}} = \dfrac{g^*x_j}{g^*x_i} = \dfrac{s_j}{s_i} = f_i^\#\br{\dfrac{x_j}{x_i}}. $$
Hence uniqueness.
\end{itemize}
\end{itemize}
\end{proof}

\begin{remark*}
\hfill
\begin{itemize}
\item If instead I had chosen $ g_{ij} = x_j / x_i $, we would have obtained the line bundle $ \OOO_{\PP^n}\br{-1} = \OOO_{\PP^n}\br{1}^\vee $, and $ \Gamma\br{\PP^n, \OOO_{\PP^n}\br{-1}} = 0 $.
\item If we were working in the world of varieties, locally the section $ s_i $ is viewed as a function and $ Z_i $ is the locus where $ s_i $ vanishes. On $ U_i $, we define a morphism to projective space
$$ \function{U_i}{\DD_+\br{x_i} \subseteq \PP^n}{p}{\br{\dfrac{s_0\br{p}}{s_i\br{p}}, \dots, \dfrac{s_n\br{p}}{s_i\br{p}}}}. $$
Equivalently, on $ X $, we can view this function as
$$ \function{X}{\PP^n}{p}{\br{s_0\br{p}, \dots, s_n\br{p}}}. $$
\end{itemize}
\end{remark*}

\subsection{Divisors and the Picard group}

Weil divisors are codimension one subvarieties and Cartier divisors are subschemes defined by a single equation. Recall the following.

\begin{definition*}
The \textbf{dimension} of a topological space $ X $ is the length $ n $ of the longest chain $ Z_0 \subsetneq \dots \subsetneq Z_n $ of irreducible closed subsets of $ X $.
\end{definition*}

\begin{example*}
$ \dim \AA_k^1 = 1 $, since $ \cbr{\text{point}} \subseteq \AA_k^1 $.
\end{example*}

\begin{definition*}
The \textbf{Krull dimension} of a ring $ A $ is $ \dim A = \dim \Spec A $, which is the length of the longest chain $ \ppp_0 \subsetneq \dots \subsetneq \ppp_n $ of prime ideals of $ A $.
\end{definition*}

\begin{definition*}
If $ Z \subseteq X $ is an irreducible closed subset, then $ \codim\br{Z, X} $ is the length $ n $ of the longest chain $ Z = Z_0 \subsetneq \dots \subseteq Z_n $ of irreducible closed subsets.
\end{definition*}

\pagebreak

\begin{remark*}
Intuition on dimension may be faulty, even for Noetherian affine schemes. However, if $ B $ is a domain and a finitely generated $ k $-algebra for $ k $ a field, then for any $ \ppp \subseteq B $,
\begin{equation}
\label{eq:1}
\Ht \ppp + \dim B / \ppp = \dim B.
\end{equation}
Here $ \Ht \ppp $ is the length $ n $ of the longest chain of primes $ \ppp_0 \subsetneq \dots \subsetneq \ppp_n = \ppp $. Write $ \dim B / \ppp = \dim \VV\br{\ppp} $ and $ \Ht \ppp = \codim\br{\VV\br{\ppp}, \Spec B} $, so we have from $ \br{\ref{eq:1}} $ that
$$ \codim\br{\VV\br{\ppp}, \Spec B} + \dim \VV\br{\ppp} = \dim \Spec B. $$
This implies that if $ X $ is a variety over $ k $, so integral and finite type over $ k $, and $ Z \subseteq X $ an irreducible closed subset, that $ \dim Z + \codim\br{Z, X} = \dim X $. Also if $ \eta \in Z \subseteq X $ is the generic point of $ Z $, then $ \dim \OOO_{X, \eta} = \codim\br{Z, X} $, by example sheet $ 3 $.
\end{remark*}

\begin{proposition}
If $ X $ is a Noetherian scheme, then $ X $ is a Noetherian topological space, that is every decreasing sequence of closed sets is stationary, and every closed subset of $ X $ has a decomposition into a finite number of irreducible closed subsets.
\end{proposition}

\begin{proof}
Exercise. \footnote{Exercise}
\end{proof}

Assume $ X $ is a Notherian integral scheme over $ \Spec k $ which is \textbf{regular in codimension one}. That is, whenever a local ring $ \OOO_{X, x} $ is of dimension one, it is \textbf{regular}, that is $ \dim_{\OOO_{X, x} / \mmm_x} \mmm_x / \mmm_x^2 = \dim \OOO_{X, x} $. That is, the dimension of the Zariski tangent space to $ X $ at $ x $ coincides with $ \dim \OOO_{X, x} $.

\end{document}