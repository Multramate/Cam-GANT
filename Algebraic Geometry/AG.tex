\def\module{Algebraic Geometry}
\def\lecturer{Prof Mark Gross}
\def\term{Michaelmas 2020}
\def\cover{}
\def\syllabus{}
\def\thm{section}

\input{../style/header}

\begin{document}

\input{../style/cover}

\section{Brief review of classical algebraic geometry and motivation for scheme theory}

\lecture{1}{Friday}{09/10/20}

The following are the main references for the course.
\begin{itemize}
\item R Hartshorne, Algebraic geometry, 1977
\item U Goertz and T Wedhorn, Algebraic geometry I, 2010
\item R Vakil, The rising sea: foundations of algebraic geometry, 2017
\end{itemize}

\subsection{Classical algebraic geometry}

Throughout this discussion, we take the base field $ k $ to be algebraically closed. An \textbf{affine variety} $ V \subseteq \AA^n\br{k} $, where, once one has chosen coordinates, $ \AA^n\br{k} = k^n $, is given by the vanishing of polynomials $ f_1, \dots, f_r \in k\sbr{X_1, \dots, X_n} $. If $ I = \abr{f_1, \dots, f_r} \triangleleft k\sbr{X_1, \dots, X_n} $ is any ideal, we set
$$ \VV\br{I} = \cbr{z \in \AA^n \st \forall f \in I, \ f\br{z} = 0}. $$
First set $ \PP^n\br{k} = \br{k^{n + 1} \setminus \cbr{0}} / k^* $ with \textbf{homogeneous coordinates} $ \br{x_0 : \dots : x_n} $. A \textbf{projective variety} $ V \subseteq \PP^n $ is given by the vanishing of homogeneous polynomials $ F_1, \dots, F_r \in k\sbr{X_0, \dots, X_n} $. If $ I $ is the ideal generated by the homogeneous ideals $ F_i $, that is if $ F \in I $ then so are all its homogeneous parts, we set
$$ \VV\br{I} = \cbr{z \in \PP^n \st \forall F \in I \ \text{homogeneous}, \ F\br{z} = 0}. $$
If $ V = \VV\br{I} \subseteq \AA^n $, set
$$ \II\br{V} = \cbr{f \in k\sbr{X_1, \dots, X_n} \st \forall x \in V, \ f\br{x} = 0}. $$
Observe that $ \VV\br{\II\br{V}} = V $, by tautology, and $ \II\br{\VV\br{I}} \supseteq \sqrt{I} $, which is obvious. Recall that the \textbf{radical} $ \sqrt{I} $ of the ideal $ I $ is defined by $ f \in \sqrt{I} $ if and only if there exists $ m > 0 $ such that $ f^m \in I $. \textbf{Hilbert's Nullstellensatz} states that, noting $ k = \overline{k} $, $ \II\br{\VV\br{I}} = \sqrt{I} $. The \textbf{coordinate ring} is
$$ k\sbr{V} = k\sbr{X_1, \dots, X_n} / \II\br{V}. $$
This may be regarded as the ring of polynomial functions on $ V $, and it is a finitely generated reduced $ k $-algebra. Recall that a \textbf{$ k $-algebra} is a commutative ring containing $ k $ as a subring. It is \textbf{finitely generated} if it is the quotient of a polynomial ring over $ k $, and \textbf{reduced} if $ a^m = 0 $ implies that $ a = 0 $.

\subsection{Why schemes?}

A better question is what is wrong with varieties?
\begin{itemize}
\item With varieties, always work over algebraically closed fields. For example, let $ I = \abr{X^2 + Y^2 + 1} \subseteq \RR\sbr{X, Y} $. Then $ \VV\br{I} = \emptyset $, but $ I $ is a prime ideal, hence radical, so $ \II\br{\VV\br{I}} = \RR\sbr{X, Y} \ne I $.
\item Number theory? Diophantine equations. If $ I \subseteq \ZZ\sbr{X_1, \dots, X_n} $ is an ideal, have $ \VV\br{I} \subseteq \ZZ^n $. For example, $ X^n + Y^n = Z^n $.
\item Why should we only consider radical, or prime, ideals? For example, a natural situation is
$$ X_1 = \VV\br{X - Y^2} \subseteq \AA^2, \qquad X_2 = \VV\br{X} \subseteq \AA^2. $$
Then $ X_1 \cap X_2 = \VV\br{X - Y^2, X} $. Note $ I = \abr{X - Y^2, X} = \abr{X, Y^2} $ is not a radical ideal, because $ Y \notin I $ and $ Y^2 \in I $ so $ Y \not\in \sqrt{I} $. Recall the coordinate ring of $ X_i $ is $ k\sbr{X_i} = k\sbr{X, Y} / I_i $. Then $ k\sbr{X_1 \cap X_2} = k\sbr{X, Y} / \abr{X, Y^2} \cong k\sbr{Y} / \abr{Y^2} $. So thinking of the coordinate ring of $ X_1 \cap X_2 $ as functions on $ X_1 \cap X_2 $, we have a function $ Y $ whose square is zero, but is not itself zero.
\end{itemize}

\pagebreak

\subsection{Categorical philosophy}

What is a point? In the category of sets, objects are sets, and if $ A $ and $ B $ are sets, then morphisms are $ \Hom\br{A, B} $, the set of maps $ f : A \to B $. Let $ * $ be a one-element set. Then the elements of any set $ X $ are in one-to-one correspondence with $ \Hom\br{*, X} $. In the category of affine varieties, objects are affine varieties and morphisms are $ \Hom\br{X, Y} = \Hom_{\text{$ k $-alg}}\br{k\sbr{Y}, k\sbr{X}} $. In this category, a point is a single point with coordinate ring $ k $. Giving a morphism
$$ \cbr{\text{point}} \to X = \VV\br{I} \subseteq \AA^n, \qquad I \subseteq k\sbr{X_1, \dots, X_n}, $$
for $ I $ a radical ideal, is the same as giving a homomorphism
$$ \function[\phi]{k\sbr{X} = k\sbr{X_1, \dots, X_n} / I}{k}{X_i}{a_i}. $$
Note that $ \phi $ vanishes in $ I $ if and only if $ f\br{a_1, \dots, a_n} = 0 $ for all $ f \in I $, which is if and only if $ \br{a_1, \dots, a_n} \in \VV\br{I} = X $. Note $ \phi $ is surjective, and hence $ \ker \phi $ is a maximal ideal. With $ k $ algebraically closed, the maximal ideals at $ k\sbr{X} $ are all of the form $ \abr{X_1 - a_1, \dots, X_n - a_n} $ for $ \br{a_1, \dots, a_n} \in X $, a consequence of Hilbert's Nullstellensatz. That is, there exists one-to-one correspondences
$$ \cbr{\text{points of} \ X} \quad \leftrightsquigarrow \quad \cbr{\text{$ k $-algebra homomorphisms} \ \phi : k\sbr{X} \to k} \quad \leftrightsquigarrow \quad \cbr{\text{maximal ideals of} \ k\sbr{X}}. $$

\subsection{Solutions over non-algebraically closed fields}

What if $ k $ is not algebraically closed? We may want to consider solutions not just in $ k^n = \AA^n $ but $ \br{k'}^n $ for $ k' $ any field extension of $ k $. That is, we may consider $ k $-algebra homomorphisms
$$ \function[\phi]{k\sbr{X} = k\sbr{X_1, \dots, X_r} / I}{k'}{X_i}{a_i}. $$
This gives a tuple $ \br{a_1, \dots, a_n} \in \br{k'}^n $ with $ f\br{a_1, \dots, a_n} = 0 $ for all $ f \in I $. Then $ \phi $ need not be surjective, so can only say the image of $ \phi $ is a subring of a field, hence an integral domain. Thus $ \ker \phi $ is a prime ideal, and maximal if and only if $ \im \phi $ is a field.

\begin{example*}
The $ \RR $-algebra homomorphism
$$ \functions[\phi]{\RR\sbr{X, Y} / \abr{X^2 + Y^2 + 1}}{\CC}{X}{0}{Y}{i} $$
is surjective with kernel $ \abr{X, Y^2 + 1} $, since $ \RR\sbr{Y} / \abr{Y^2 + 1} \cong \CC $. This is a maximal ideal but is not of the form $ \abr{X - a, Y - b} $ for $ \br{a, b} \in \RR^2 $. If instead we considered the map
$$ \functions{\RR\sbr{X, Y} / \abr{X^2 + Y^2 + 1}}{\CC}{X}{0}{Y}{-i}, $$
we get the same kernel. That is, $ \br{0, i} $ and $ \br{0, -i} $ are solutions to $ X^2 + Y^2 + 1 $, but they correspond to the same maximal ideal. In fact, this maximal ideal corresponds to a Galois orbit of $ \Gal\br{\CC / \RR} $ of solutions.
\end{example*}

\lecture{2}{Monday}{12/10/20}

There are more exotic points by taking even bigger fields.

\begin{example*}
Let $ k\br{X} $ be the field of fractions of $ k\sbr{X} = \RR\sbr{X, Y} / \abr{X^2 + Y^2 + 1} $. There is an inclusion
$$ \functions{k\sbr{X}}{k\br{X}}{f}{\tfrac{f}{1}}{\br{X, Y}}{\br{X, Y}}. $$
The kernel of this map is zero. This gives a solution to the equation $ X^2 + Y^2 + 1 = 0 $ with coordinates in the field $ k\br{X} $. This solution is $ \br{X, Y} \in \AA^2\br{k\br{X}} $.
\end{example*}

The moral is that once we start looking at solutions to equation over any field, then we get maps $ k\sbr{X} \to k' $ with kernel not necessarily maximal. What about solutions over rings?

\pagebreak

\begin{example*}
Let $ A = \ZZ\sbr{X_1, \dots, X_n} / I $, and let $ R $ be any commutative ring. We define an $ R $-valued point of $ \Spec A $ to be a ring homomorphism
$$ \function{A}{R}{X_i}{r_i}. $$
Then $ f\br{r_1, \dots, r_n} = 0 $ for all $ f \in I $. This gives a lot of flexibility. For example,
\begin{itemize}
\item $ R = \ZZ $ gives diophantine equations,
\item $ R = \FF_p $ gives solutions modulo $ p $, and
\item $ R = \QQ $ gives rational solutions.
\end{itemize}
\end{example*}

Take this to its logical conclusion. Let $ A $ be a ring, where all rings are commutative in this course. Given $ A $, we hope for some geometric object $ \Spec A $, the \textbf{spectrum} of $ A $. For a ring $ R $, the set of \textbf{$ R $-valued points} of $ X $ is
$$ X\br{R} = \Hom_{\text{ring}}\br{A, R}. $$
A morphism $ X = \Spec A \to Y = \Spec B $ should be the same thing as giving a morphism $ \phi : B \to A $. Define the category of \textbf{affine schemes} to be the opposite category to the category of rings. Define a \textbf{scheme} to be something which is locally isomorphic to an affine scheme. By analogy, a \textbf{manifold} is a topological space with an open cover $ \cbr{U_i} $ with each $ U_i $ homeomorphic to an open subset of $ \RR^n $. To make sense of the definition of schemes, we need a lot of language.

\subsection{Spectrum of a ring}

\begin{definition*}
Let $ A $ be a ring. Then
$$ \Spec A = \cbr{\ppp \subseteq A \st \ppp \ \text{a prime ideal}}. $$
For $ I \subseteq A $ an ideal, define
$$ \VV\br{I} = \cbr{\ppp \subseteq A \st \ppp \ \text{prime}, \ \ppp \supseteq I}. $$
\end{definition*}

\begin{proposition}
The sets $ \VV\br{I} $ form the closed sets of a topology on $ \Spec A $, called the \textbf{Zariski topology}.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item $ \VV\br{A} = \emptyset $.
\item $ \VV\br{0} = \Spec A $.
\item If $ \cbr{I_i}_{i \in J} $ is a collection of ideals, then
$$ \VV\br{\sum_{i \in J} I_i} = \bigcap_{i \in J} \VV\br{I_i}. $$
\item Claim that
$$ \VV\br{I_1 \cap I_2} = \VV\br{I_1} \cup \VV\br{I_2}. $$
\begin{itemize}
\item[$ \supseteq $] Obvious.
\item[$ \subseteq $] If $ \ppp \supseteq I_1 \cap I_2 $ is prime, then $ \ppp \supseteq I_1 $ or $ \ppp \supseteq I_2 $. See Atiyah-Macdonald, Proposition 1.11.ii. \footnote{Exercise: try to prove without looking up}
\end{itemize}
\end{itemize}
\end{proof}

\begin{example*}
Let $ A = k\sbr{X_1, \dots, X_n} $ with $ k $ algebraically closed and $ I \subseteq A $ an ideal. Then the maximal ideals $ \mmm $ of $ A $ containing $ I $ are in one-to-one correspondence with the zero set of $ I $ in $ \AA^n\br{k} $, so
$$ \correspondence{\abr{X_1 - a_1, \dots, X_n - a_n} \supseteq I, \ a_i \in k}{\br{a_1, \dots, a_n} \in \VV\br{I} \subseteq \AA^n\br{k}}. $$
\end{example*}

The new $ \VV\br{I} $ now extends this notion of zero set by including possible other prime ideals.

\begin{example*}
If $ k $ is a field, $ \Spec k = \cbr{0} $, so the topological space cannot see the field.
\end{example*}

We fix this by also thinking about what functions are on these spaces.

\pagebreak

\section{Sheaves}

Fix a topological space $ X $.

\subsection{Sheaves}

\begin{definition*}
A \textbf{presheaf} $ \FFF $ on $ X $ consists of the following data.
\begin{itemize}
\item For every open set $ U \subseteq X $ an abelian group $ \FFF\br{U} $.
\item Whenever given an inclusion $ V \subseteq U \subseteq X $, a \textbf{restriction map} $ \rho_{UV} : \FFF\br{U} \to \FFF\br{V} $, a homomorphism, such that
\begin{itemize}
\item $ \rho_{UU} = \id_{\FFF\br{U}} $, and
\item if $ W \subseteq V \subseteq U $, then $ \rho_{UW} = \rho_{VW} \circ \rho_{UV} $.
\end{itemize}
\end{itemize}
\end{definition*}

\begin{remark*}
Can think of a presheaf as a contravariant functor from the category of open sets of $ X $, the category whose objects are open subsets of $ X $ and whose morphisms are inclusions of open sets, to the category of abelian groups. Can replace the category of abelian groups with any desired category, such as commutative rings.
\end{remark*}

\begin{definition*}
A \textbf{morphism of presheaves} $ f : \FFF \to \GGG $ is a collection of homomorphisms $ f_U : \FFF\br{U} \to \GGG\br{U} $ such that for all $ V \subseteq U $ the diagram
$$
\begin{tikzcd}
\FFF\br{U} \arrow{r}{f_U} \arrow{d}[swap]{\rho_{UV}} & \GGG\br{U} \arrow{d}{\rho_{UV}} \\
\FFF\br{V} \arrow{r}[swap]{f_V} & \GGG\br{V}
\end{tikzcd}
$$
is commutative.
\end{definition*}

\begin{definition*}
A presheaf $ \FFF $ is a \textbf{sheaf} if it satisfies the following additional axioms.
\begin{enumerate}[label=S\arabic*.]
\item If $ U \subseteq X $ is covered by an open cover $ \cbr{U_i} $ and $ s \in \FFF\br{U} $ satisfies $ \eval{s}_{U_i} = \rho_{UU_i}\br{s} = 0 $ for all $ i $, then $ s = 0 $.
\item If $ U $ and $ \cbr{U_i} $ are as in S1 and $ s_i \in \FFF\br{U_i} $ such that $ \eval{s_i}_{U_i \cap U_j} = \eval{s_j}_{U_i \cap U_j} $ for all $ i $ and $ j $, then there exists $ s \in \FFF\br{U} $ with $ \eval{s}_{U_i} = s_i $ for all $ i $.
\end{enumerate}
\end{definition*}

\begin{remark*}
\hfill
\begin{itemize}
\item If $ \FFF $ is a sheaf, then $ \emptyset \subseteq X $ is covered by the empty covering, and hence $ \FFF\br{\emptyset} = 0 $.
\item S1 and S2 together can be described as saying, given $ U $ and $ \cbr{U_i}_{i \in I} $,
$$ 0 \to \FFF\br{U} \xrightarrow{\alpha} \prod_{i \in I} \FFF\br{U_i} \overset{\beta_1}{\underset{\beta_2}{\rightrightarrows}} \prod_{i, j} \FFF\br{U_i \cap U_j} $$
is exact, where
$$ \alpha\br{s} = \br{\eval{s}_{U_i}}_{i \in I}, \qquad \beta_1\br{\br{s_i}_{i \in I}} = \br{\eval{s_i}_{U_i \cap U_j}}_{i, j}, \qquad \beta_2\br{\br{s_i}_{i \in I}} = \br{\eval{s_j}_{U_i \cap U_j}}_{i, j}. $$
Exactness means
\begin{itemize}
\item $ \alpha $ is injective, which is S1,
\item $ \beta_1 \circ \alpha = \beta_2 \circ \alpha $, and
\item for any $ \br{s_i} \in \prod_{i \in I} \FFF\br{U_i} $, with $ \beta_1\br{\br{s_i}} = \beta_2\br{\br{s_i}} $, there exists $ s \in \FFF\br{U} $ with $ \alpha\br{s} = \br{s_i} $, which is S2.
\end{itemize}
\end{itemize}
\end{remark*}

\pagebreak

\subsection{Examples}

\lecture{3}{Wednesday}{14/10/20}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ X $ be any topological space, and let
$$ \FFF\br{U} = \cbr{\text{continuous functions} \ U \to \RR}. $$
This is a sheaf, by
$$ \function[\rho_{UV}]{\FFF\br{U}}{\FFF\br{V}}{f}{\eval{f}_V}. $$
\begin{enumerate}[label=S\arabic*.]
\item A continuous function is zero if it is zero on every open set of a cover.
\item Continuous functions can be glued.
\end{enumerate}
\item Let $ X = \CC $ with the Euclidean topology, and let
$$ \FFF\br{U} = \cbr{f : U \to \CC \st f \ \text{is a bounded analytic function}}. $$
This is a presheaf. It satisfies S1, and does not satisfy S2. For example, consider the cover $ \cbr{U_i}_{i \in \cbr{1, 2, \dots}} $ of $ \CC $ given by $ U_i = \cbr{z \in \CC \st \abs{z} < i} $ and
$$ \function[s_i]{U_i}{\CC}{z}{z}. $$
Note if $ i < j $, then $ U_i \cap U_j = U_i $ and $ \eval{s_i}_{U_i \cap U_j} = \eval{s_j}_{U_i \cap U_j} $. But if we glue we get the function $ z : \CC \to \CC $, which is not bounded. Note $ \FFF\br{\CC} = \CC $.
\item Take any group $ G $ and set $ \FFF\br{U} = G $ for any open set $ U $. This is called the \textbf{constant presheaf}. This is not a sheaf. Let $ U = U_1 \sqcup U_2 $. If we wanted a sheaf,
$$
\begin{tikzcd}
\FFF\br{U_1} = G \arrow{dr} & & \FFF\br{U_2} = G \arrow{dl} \\
& \FFF\br{U_1 \cap U_2} = \FFF\br{\emptyset} = 0 &
\end{tikzcd},
$$
so if S2 is satisfied, would want $ s_1 \in \FFF\br{U_1} $ and $ s_2 \in \FFF\br{U_2} $ to glue. We would then want to have $ \FFF\br{U} = G \times G $. Now give $ G $ the discrete topology, and define instead
$$ \FFF\br{U} = \cbr{f : U \to G \ \text{continuous}}, $$
that is $ f $ is locally constant. That is, if $ x \in U $, there exists a neighbourhood $ x \in V \subseteq U $ with $ \eval{f}_V $ constant. This is called the \textbf{constant sheaf} and if $ U $ is non-empty and connected, then $ \FFF\br{U} = G $.
\item If $ X $ is an algebraic variety, and $ U \subseteq X $ is a Zariski open subset, define
$$ \OOO_X\br{U} = \cbr{f : U \to k \st f \ \text{regular function}}. $$
Roughly $ f $ is \textbf{regular} means that every point of $ U $ has an open neighbourhood on which $ f $ is expressed as a ratio of polynomials $ g / h $ with $ h $ non-vanishing on the neighbourhood. Then $ \OOO_X $ is a sheaf, called the \textbf{structure sheaf} of $ X $.
\end{itemize}
\end{example*}

\subsection{Stalks}

\begin{definition*}
Let $ \FFF $ be a presheaf on $ X $. Let $ p \in X $. Then the \textbf{stalk} of $ \FFF $ at $ p $ is
$$ \FFF_p = \cbr{\br{U, s} \st U \subseteq X \ \text{is an open neighbourhood of} \ p, \ s \in \FFF\br{U}} / \equiv, $$
where $ \br{U, s} \equiv \br{V, s'} $ if there exists $ W \subseteq U \cap V $ also a neighbourhood of $ p $ such that $ \eval{s}_W = \eval{s'}_W $. An equivalence class of a pair $ \br{U, s} $ is called a \textbf{germ}.
\end{definition*}

\begin{remark*}
$ \FFF_p = \varinjlim_{p \in U} \FFF\br{U} $.
\end{remark*}

\pagebreak

Note that a morphism $ f : \FFF \to \GGG $ of presheaves induces a morphism
$$ \function[f_p]{\FFF_p}{\GGG_p}{\br{U, s}}{\br{U, f_U\br{s}}}. $$

\begin{proposition}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves. Then $ f $ is an isomorphism if and only if $ f_p $ is an isomorphism for all $ p \in X $.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}[leftmargin=0.5in]
\item[$ \implies $] Obvious.
\item[$ \impliedby $] Assume $ f_p $ is an isomorphism for all $ p \in X $. Need to show that $ f_U : \FFF\br{U} \to \GGG\br{U} $ is an isomorphism for all $ U \subseteq X $, as then we can define $ \br{f^{-1}}_U = \br{f_U}^{-1} $. Check that with this definition, $ \br{f^{-1}}_U $ is compatible with restriction maps, hence $ f^{-1} $ is a morphism of sheaves. \footnote{Exercise}
\begin{itemize}
\item $ f_U $ is injective. Suppose $ s \in \FFF\br{U} $, and $ f_U\br{s} = 0 $. Then for all $ p \in U $, $ f_p\br{U, s} = \br{U, f_U\br{s}} = \br{U, 0} = 0 \in \GGG_p $. Since $ f_p $ is injective, $ \br{U, s} = 0 $ in $ \FFF_p $. That is, there exists a open neighbourhood $ V_p $ of $ p $ in $ U $ such that $ \eval{s}_{V_p} = 0 $. Since $ \cbr{V_p}_{p \in U} $ cover $ U $, we see by S1 that $ s = 0 $.
\item $ f_U $ is surjective. Let $ t \in \GGG\br{U} $ and write $ t_p = \br{U, t} \in \GGG_p $. Since $ f_p $ is surjective, there exists $ s_p \in \FFF_p $ with $ f_p\br{s_p} = t_p $. That is, there exists $ V_p \subseteq U $ an open neighbourhood of $ p $, and a germ $ \br{V_p, s_p} $ such that $ \br{V_p, f_{V_p}\br{s_p}} \equiv \br{U, t} $. By shrinking $ V_p $ if necessary, we can assume that $ \eval{t}_{V_p} = f_{V_p}\br{s_p} $. Now on $ V_p \cap V_q $,
$$ f_{V_p \cap V_q}\br{\eval{s_p}_{V_p \cap V_q} - \eval{s_q}_{V_p \cap V_q}} = \eval{t}_{V_p \cap V_q} - \eval{t}_{V_p \cap V_q} = 0, $$
and hence by injectivity of $ f_{V_p \cap V_q} $ already proved, we have $ \eval{s_p}_{V_p \cap V_q} = \eval{s_q}_{V_p \cap V_q} $. By S2 the $ s_p $'s glue to give an element $ s \in \FFF\br{U} $ with $ \eval{s}_{V_p} = s_p $, for all $ p \in U $. Now
$$ \eval{f_U\br{s}}_{V_p} = f_{V_p}\br{\eval{s}_{V_p}} = f_{V_p}\br{s_p} = \eval{t}_{V_p}. $$
By S1, applied to $ f_U\br{s} - t $, we get $ f_U\br{s} = t $. Thus $ f_U $ is surjective.
\end{itemize}
\end{itemize}
\end{proof}

\subsection{Sheafification}

\begin{theorem}[Sheafification]
Given a presheaf $ \FFF $, there exists a sheaf $ \FFF^+ $ and a morphism $ \theta : \FFF \to \FFF^+ $ satisfying the following universal property. For any sheaf $ \GGG $ and morphism $ \phi : \FFF \to \GGG $, there exists a unique morphism $ \phi^+ : \FFF^+ \to \GGG $ such that $ \phi^+ \circ \theta = \phi $, so
$$
\begin{tikzcd}
\FFF \arrow{r}{\theta} \arrow{dr}[swap]{\phi} & \FFF^+ \arrow[dashed]{d}{\phi^+} \\
& \GGG
\end{tikzcd}.
$$
The pair $ \br{\FFF^+, \theta} $ is unique up to unique isomorphism, and is called the \textbf{sheafification} of $ \FFF $.
\end{theorem}

\begin{proof}
See example sheet $ 1 $. The idea is to make $ \FFF^+ $ look like functions. Define
$$ \FFF^+\br{U} = \cbr{s : U \to \bigsqcup_{p \in U} \FFF_p \st \begin{array}{l} \forall p \in U, \ s\br{p} \in \FFF_p, \\ \forall p \in U, \ \exists p \in V \subseteq U, \ \exists t \in \FFF\br{V}, \ \forall q \in V, \ s\br{q} = \br{V, t} \in \FFF_q \end{array}}. $$
Then
$$ \function[\theta_U]{\FFF\br{U}}{\FFF^+\br{U}}{s}{\br{p \mapsto \br{U, s} \in \FFF_p}}. $$
\end{proof}

\begin{exercise*}
A recommendation is to do all exercises in chapter II.$ 1 $ of Hartshorne.
\end{exercise*}

\pagebreak

\subsection{Kernels, cokernels, and images}

\lecture{4}{Friday}{16/10/20}

\begin{definition*}
Let $ f : \FFF \to \GGG $ be a morphism of presheaves on a space $ X $. We define the following.
\begin{itemize}
\item The \textbf{presheaf kernel} of $ f $, $ \ker f $, is the presheaf given by $ \br{\ker f}\br{U} = \ker \br{f_U : \FFF\br{U} \to \GGG\br{U}} $.
\item The \textbf{presheaf cokernel} $ \coker f $ is the presheaf given by $ \br{\coker f}\br{U} = \coker \br{f_U} = \GGG\br{U} / \im f_U $.
\item The \textbf{presheaf image} $ \im f $ is the presheaf given by $ \br{\im f}\br{U} = \im f_U $.
\end{itemize}
\end{definition*}

\begin{exercise*}
Check that these are presheaves, that is restrictions work.
\end{exercise*}

\begin{remark}
If $ f : \FFF \to \GGG $ is a morphism of sheaves, then $ \ker f $ is also a sheaf.
\end{remark}

\begin{proof}
S1 is certainly satisfied. If $ s \in \br{\ker f}\br{U} \subseteq \FFF\br{U} $ satisfies $ \eval{s}_{U_i} = 0 $ for all $ U_i $ in a cover of $ U $ so $ s = 0 $ by S1 for $ \FFF $. Given $ s_i \in \br{\ker f}\br{U_i} $ with $ \cbr{U_i} $ an open cover of $ U $, and with $ \eval{s_i}_{U_i \cap U_j} = \eval{s_j}_{U_i \cap U_j} $, then there exists $ s \in \FFF\br{U} $ with $ \eval{s}_{U_i} = s_i $ by S2 for $ \FFF $. But $ f_U\br{s} = 0 $ since $ \eval{f_U\br{s}}_{U_i} = f_{U_i}\br{\eval{s}_{U_i}} = f_{U_i}\br{s_i} = 0 $ so by S1, $ f_U\br{s} = 0 $.
\end{proof}

\begin{example*}
Let $ X = \PP^1 $, or think of the Riemann sphere. Let $ P, Q \in X $ be distinct points. Let $ \GGG $ be the sheaf of regular functions on $ X $, or think of the sheaf of holomorphic functions. Let $ \FFF $ be the sheaf of regular functions on $ X $ which vanish at $ P $ and $ Q $. Note $ \FFF\br{U} = \GGG\br{U} $ if $ U \cap \cbr{P, Q} = \emptyset $. Let $ U = \PP^1 \setminus \cbr{P} $ and $ V = \PP^1 \setminus \cbr{Q} $. Note $ \FFF\br{\PP^1} = 0 $ and $ \GGG\br{\PP^1} = k $, because regular functions on $ \PP^1 $ are constants. Let $ f : \FFF \to \GGG $ be the obvious inclusion. Then
$$ \br{\coker f}\br{\PP^1} = k, \qquad \br{\coker f}\br{U} = \GGG\br{U} / \FFF\br{U} = k\sbr{X} / \abr{X} = k, $$
$$ \br{\coker f}\br{V} = k, \qquad \br{\coker f}\br{U \cap V} = \GGG\br{U \cap V} / \FFF\br{U \cap V} = 0. $$
If S2 holds, then we would need to have $ \br{\coker f}\br{\PP^1} = k \oplus k $. This is not a bug, but a feature.
\end{example*}

\begin{definition*}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves.
\begin{itemize}
\item The \textbf{sheaf kernel} $ \ker f $ of $ f $ is just the presheaf kernel.
\item The \textbf{sheaf cokernel} is the sheaf associated to the presheaf cokernel of $ f $.
\item The \textbf{sheaf image} is the sheaf associated to the presheaf image of $ f $.
\end{itemize}
\end{definition*}

$ \FFF $ is a \textbf{subsheaf} of $ \GGG $ if we have inclusions $ \FFF\br{U} \subseteq \GGG\br{U} $ for all $ U $ compatible with restrictions.

\begin{exercise*}
The sheaf image $ \im f $ is a subsheaf of $ \GGG $.
\end{exercise*}

We say $ f $ is \textbf{injective} if $ \ker f = 0 $. We say $ f $ is \textbf{surjective} if $ \im f = \GGG $. We say a sequence of morphisms of sheaves
$$ \dots \to \FFF^{i - 1} \xrightarrow{f^i} \FFF^i \xrightarrow{f^{i + 1}} \FFF^{i + 1} \to \dots $$
is \textbf{exact} if $ \ker f^{i + 1} = \im f^i $ for all $ i $. If $ \FFF' \subseteq \FFF $ is a subsheaf, we write $ \FFF / \FFF' $ for the sheaf associated to the presheaf $ U \mapsto \FFF\br{U} / \FFF'\br{U} $. That is, this is the cokernel of the inclusion $ \FFF' \hookrightarrow \FFF $. A warning is if $ f : \FFF \to \GGG $ is surjective, we do not necessarily have $ \FFF\br{U} \to \GGG\br{U} $ surjective for all $ U $.

\begin{lemma}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves. Then for all $ p \in X $,
$$ \br{\ker f}_p = \ker \br{f_p : \FFF_p \to \GGG_p}, \qquad \br{\im f}_p = \im f_p. $$
\end{lemma}

\begin{proof}
Have a map
$$ \function{\br{\ker f}_p}{\ker f_p \subseteq \FFF_p}{\br{U, s}}{\br{U, s}}. $$
If $ s \in \br{\ker f}\br{U} = \ker f_U $ represents a germ $ \br{U, s} \in \br{\ker f}_p $, then $ \br{U, s} \in \FFF_p $, and $ f_p\br{U, s} = \br{U, f_U\br{s}} = \br{U, 0} = 0 \in \GGG_p $. So $ \br{U, s} \in \ker f_p $.
\begin{itemize}
\item Injective. If $ \br{U, s} = 0 $ in $ \FFF_p $, there exists a neighbourhood $ V \subseteq U $ of $ p $ such that $ \eval{s}_V = 0 $. Then $ \br{U, s} \sim \br{V, \eval{s}_V} = \br{V, 0} = 0 $ in $ \br{\ker f}_p $.
\item Surjective. If $ \br{U, s} \in \ker f_p $, then $ \br{U, f_U\br{s}} = 0 $ in $ \GGG_p $. That is, there exists a neighbourhood $ V \subseteq U $ of $ p $ such that $ 0 = \eval{f_U\br{s}}_V = f_V\br{\eval{s}_V} $. Thus $ \eval{s}_V \in \br{\ker f}\br{V} $, and $ \br{V, \eval{s}_V} \in \br{\ker f}_p $, and $ \br{V, \eval{s}_V} $ maps to the same element in $ \ker f_p $ represented by $ \br{U, s} $.
\end{itemize}

\pagebreak

Let $ \im' f $ be the presheaf image. An easy fact is if $ \FFF $ is a presheaf with associated sheaf $ \FFF^+ $, then $ \FFF_p \cong \FFF_p^+ $ for all $ p \in X $. \footnote{Exercise: check} Thus $ \br{\im f}_p = \br{\im' f}_p $, so need to show $ \br{\im' f}_p \cong \im f_p $. Define a map by
$$ \function{\br{\im' f}_p}{\im f_p}{\br{U, s}}{\br{U, s}}. $$
\begin{itemize}
\item Injective. If $ \br{U, s} = 0 $ in $ \GGG_p $ then there exists a neighbourhood $ V \subseteq U $ of $ p $ such that $ \eval{s}_V = 0 $. Then $ \br{U, s} \sim \br{V, 0} $ in $ \br{\im' f}_p $.
\item Surjective. If $ \br{U, s} \in \im f_p $, then there exists $ \br{V, t} \in \FFF_p $ with $ \br{U, s} = f_p\br{V, t} = \br{V, f_V\br{t}} $, so after shrinking $ U $ and $ V $ if necessary, then we can take $ U = V $ and $ f_U\br{t} = s $. Then $ \br{U, s} \in \br{\im' f}_p $.
\end{itemize}
\end{proof}

\begin{proposition}
Let $ f : \FFF \to \GGG $ be a morphism of sheaves. Then
\begin{enumerate}
\item $ f $ is injective if and only if $ f_p : \FFF_p \to \GGG_p $ is injective for all $ p $, and
\item $ f $ is surjective if and only if $ f_p : \FFF_p \to \GGG_p $ is surjective for all $ p $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item $ f_p $ is injective for all $ p $ if and only if $ \ker f_p = 0 $ for all $ p $, if and only if $ \br{\ker f}_p = 0 $ for all $ p $, if and only if $ \ker f = 0 $, \footnote{Exercise: check by S1} which is if and only if $ f $ is injective.
\item $ f_p $ is surjective for all $ p $ if and only if $ \im f_p = \GGG_p $ for all $ p $, if and only if $ \br{\im f}_p = \GGG_p $ for all $ p $, if and only if $ \im f = \GGG $, \footnote{Exercise: check using $ \im f \subseteq \GGG $} which is if and only if $ f $ is surjective.
\end{enumerate}
\end{proof}

\begin{remark*}
Given $ f : \FFF \to \GGG $, in fact $ \GGG / \im f \cong \coker f $. \footnote{Exercise}
\end{remark*}

\subsection{Passing between spaces}

\lecture{5}{Monday}{19/10/20}

Let $ f : X \to Y $ be a continuous map between topological spaces, $ \FFF $ a sheaf on $ X $, and $ \GGG $ a sheaf on $ Y $. Define $ f_*\FFF $ by, for $ U \subseteq Y $
$$ \br{f_*\FFF}\br{U} = \FFF\br{f^{-1}\br{U}}. $$

\begin{exercise*}
Check $ f_*\FFF $ is a sheaf on $ Y $.
\end{exercise*}

Define $ f^{-1}\GGG $ to be the sheaf associated to the presheaf
$$ U \subseteq X \mapsto \cbr{\br{V, s} \st V \supseteq f\br{U}, \ V \ \text{open}, \ s \in \GGG\br{V}} / \sim, $$
where $ \br{V, s} \sim \br{V', s'} $ if there exists $ W \subseteq V \cap V' $ such that $ f\br{U} \subseteq W $, and $ \eval{s}_W = \eval{s'}_W $.

\begin{example*}
If $ f : \cbr{p} \to X $ is an inclusion of a point, then $ f^{-1}\GGG = \GGG_p $. This is a group but defines a sheaf on a one-point space. More generally, if $ \iota : Z \hookrightarrow X $ is an inclusion of a subset with induced topology, we often write
$$ \eval{\FFF}_Z = \iota^{-1}\FFF. $$
If $ Z $ is open in $ X $, then this is easy, since if $ U \subseteq Z $ then $ \eval{\FFF}_Z\br{U} = \FFF\br{U} $.
\end{example*}

\begin{remark*}
If $ s \in \FFF\br{U} $ we say $ s $ is a \textbf{section} of $ \FFF $ over $ U $. We often write
$$ \FFF\br{U} = \Gamma\br{U, \FFF}, $$
thinking of $ \Gamma\br{U, \cdot} $ as a functor from the category of sheaves on a space $ X $ to the category of abelian groups.
\end{remark*}

\pagebreak

\section{Schemes}

Want to construct a sheaf $ \OOO $ on $ \Spec A $, analogous to the sheaf of regular functions on a variety, and $ \OOO $ will be a sheaf of rings. That is, $ \OOO\br{U} $ will be a ring for each open set $ U $ and restriction maps will be ring homomorphisms.

\subsection{Localisation of a ring}

Importantly recall the following. Let $ A $ be a ring, where all rings are commutative with unity, and $ S \subseteq A $ be a multiplicatively closed subset, that is $ 1 \in S $ and if $ s_1, s_2 \in S $ then $ s_1s_2 \in S $. We define a ring
$$ S^{-1}A = \cbr{\br{a, s} \st a \in A, s \in S} / \sim, $$
where $ \br{a, s} \sim \br{a', s'} $ if there exists $ s'' \in S $ such that $ s''\br{as' - a's} = 0 $. Then $ S^{-1}A $ is called the \textbf{localisation of $ A $ at $ S $}. Note that we write $ a / s $ for the equivalence class of $ \br{a, s} $. The usual equivalence relation on fractions is $ a / s = a' / s' $ if and only if $ as' = a's $. We need the extra possibility of killing $ as' - a's $ with $ s'' $ if $ A $ is not an integral domain.

\begin{example*}
\hfill
\begin{itemize}
\item Take $ f \in A $ and $ S = \cbr{1, f, \dots} \subseteq A $. Then we write $ A_f = S^{-1}A $. These will correspond to open subsets.
\item If $ \ppp \subseteq A $ is a prime ideal and $ S = A \setminus \ppp $, then
\begin{itemize}
\item $ 1 \in S $, and
\item $ a, b \in S $ and $ ab \in \ppp $ is a contradiction by definition of prime ideals, so $ ab \in S $.
\end{itemize}
Then $ A_\ppp = S^{-1}A $ is the \textbf{localisation of $ A $ at $ \ppp $}. These will correspond to stalks.
\end{itemize}
\end{example*}

\subsection{Construction of the structure sheaf}

Let
$$ \OOO\br{U} = \cbr{s : U \to \bigsqcup_{\ppp \in U} A_\ppp \st \begin{array}{l} \forall \ppp \in U, \ s\br{\ppp} \in A_\ppp \\ \forall \ppp \in U, \ \exists \ppp \in V \subseteq U \ \text{open}, \ \exists a, f \in A, \ \forall \qqq \in V, \ f \notin \qqq, \ s\br{\qqq} = \dfrac{a}{f} \in A_\qqq \end{array}}. $$

\begin{proposition}
For any $ \ppp \in \Spec A $, $ \OOO_\ppp = A_\ppp $.
\end{proposition}

\begin{proof}
Have a map
$$ \function{\OOO_\ppp}{A_\ppp}{\br{U, s}}{s\br{\ppp}}. $$
\begin{itemize}
\item Surjective. Any element of $ A_\ppp $ can be written as $ a / f $ for some $ a \in A $ and $ f \notin \ppp $. Then $ \DD\br{f} = \Spec A \setminus \VV\br{f} = \cbr{\ppp \in \Spec A \st f \notin \ppp} $, since $ \VV\br{f} = \cbr{\ppp \in \Spec A \st f \in \ppp} $. Now $ a / f $ defines an element of $ \OOO\br{\DD\br{f}} $ given by
$$ \function[s]{\DD\br{f}}{A_\qqq}{\qqq}{\dfrac{a}{f}}, $$
and in particular, $ s\br{\ppp} = a / f \in A_\ppp $.
\item Injective. Let $ \ppp \in U \subseteq \Spec A $ and $ s \in \OOO\br{U} $ with $ s\br{\ppp} = 0 $ in $ A_\ppp $. Want to show $ \br{U, s} = 0 $ in $ \OOO_\ppp $. By shrinking $ U $ if necessary, we can assume that $ s $ is given by $ a, f \in A $ with $ s\br{\qqq} = a / f $ for all $ \qqq \in U $. In particular $ f \notin \qqq $ for all $ \qqq \in U $. Thus $ a / f = 0 / 1 $ in $ A_\ppp $ so there exists $ h \in A \setminus \ppp $ such that $ 0 = h \cdot \br{a \cdot 1 - f \cdot 0} = h \cdot a $ in $ A $. Now let $ V = U \cap \DD\br{h} $. Then $ \br{V, \eval{s}_V} = 0 $, since for $ \qqq \in V $, $ \eval{s}_V\br{\qqq} = s\br{\qqq} = a / f \in A_\qqq $ and $ h \cdot a = 0 $, and $ h \in A \setminus \qqq $ so $ h \cdot a = 0 $ implies $ a / f = 0 / 1 $ in $ A_\qqq $. Thus $ \br{U, s} = 0 $ in $ \OOO_\ppp $.
\end{itemize}
\end{proof}

\pagebreak

\begin{proposition}
For any $ f \in A $, $ \OOO\br{\DD\br{f}} = A_f $.
\end{proposition}

In particular, as $ \Spec A = \DD\br{1} $, the \textbf{global sections} of $ \OOO $ is $ \OOO\br{\Spec A} = A_1 = A $.

\begin{proof}
Let
$$ \function[\psi]{A_f}{\OOO\br{\DD\br{f}}}{\dfrac{a}{f^n}}{\br{\ppp \in \DD\br{f} \mapsto \dfrac{a}{f^n} \in A_\ppp}}, $$
since $ f \notin \ppp $ implies that $ f^n \notin \ppp $ for all $ n \ge 0 $.
\begin{itemize}
\item Injective. If $ \psi\br{a / f^n} = 0 $, then for all $ \ppp \in \DD\br{f} $, $ a / f^n = 0 $ in $ A_\ppp $, that is there exists $ h \in A \setminus \ppp $ such that $ h \cdot a = 0 $ in $ A $. Let $ I = \cbr{g \in A \st g \cdot a = 0} $, the \textbf{annihilator} of $ a $. So $ h \in I $ and $ h \notin \ppp $, so $ I \not\subseteq \ppp $. This is true for all $ \ppp \in \DD\br{f} $, so $ \VV\br{I} \cap \DD\br{f} = \emptyset $. Thus $ f \in \bigcap_{\ppp \in \VV\br{I}} \ppp = \sqrt{I} $, the radical, so $ f^m \in I $ for some $ m > 0 $. Thus $ f^m \cdot a = 0 $, so $ a / f^n = 0 $ in $ A_f $. Thus $ \psi $ is injective.

\lecture{6}{Wednesday}{21/10/20}

\item Surjective. Let $ s \in \OOO\br{\DD\br{f}} $. Cover $ \DD\br{f} $ with open sets $ V_i $ on which $ s $ is represented as $ a_i / g_i $ with $ a_i, g_i \in A $ such that $ g_i \notin \ppp $ whenever $ \ppp \in V_i $. Thus $ V_i \subseteq \DD\br{g_i} $. By question $ 1 $ on example sheet $ 1 $, the sets of the form $ \DD\br{h} $ form a base for the Zariski topology on $ \Spec A $. Thus we can assume $ V_i = \DD\br{h_i} $ for some $ h_i \in A $. Since $ \DD\br{h_i} \subseteq \DD\br{g_i} $, we have $ \VV\br{h_i} \supseteq \VV\br{g_i} $, so $ \sqrt{\abr{h_i}} \subseteq \sqrt{\abr{g_i}} $, so $ h_i^n \in \abr{g_i} $ for some $ n $, say $ h_i^n = c_ig_i $, so $ a_i / g_i = c_ia_i / h_i^n $. Now replace $ h_i $ by $ h_i^n $, since this does not change open sets because in general $ \DD\br{h_i} = \DD\br{h_i^n} $, and replace $ a_i $ by $ c_ia_i $. The situation so far is that we can assume $ \DD\br{f} $ is covered by sets $ \DD\br{h_i} $ such that $ s $ is represented by $ a_i / h_i $ on $ \DD\br{h_i} $. Claim that $ \DD\br{f} $ can be covered by a finite number of the $ \DD\br{h_i} $, that is $ \DD\br{f} $ is quasi-compact. Since
\begin{align*}
\DD\br{f} \subseteq \bigcup_i \DD\br{h_i} \qquad
& \iff \qquad \VV\br{f} \supseteq \bigcap_i \VV\br{h_i} = \VV\br{\sum_i \abr{h_i}}
\qquad \iff \qquad f \in \bigcap_{\ppp \in \VV\br{\sum_i \abr{h_i}}} \ppp \\
& \iff \qquad f \in \sqrt{\sum_i \abr{h_i}}
\qquad \iff \qquad \exists n, \ f^n \in \sum_i \abr{h_i},
\end{align*}
we can write $ f^n = \sum_{i \in I} b_ih_i $ for some finite index set $ I $. Thus reversing this argument, $ \DD\br{f} \subseteq \bigcup_{i \in I} \DD\br{h_i} $. We now pass to this finite subcover $ \cbr{\DD\br{h_i}} $. On $ \DD\br{h_i} \cap \DD\br{h_j} = \DD\br{h_ih_j} $, note $ a_i / h_i $ and $ a_j / h_j $ both represent $ s $, so by injectivity shown in the last lecture, $ a_ih_j / h_ih_j = a_i / h_i = a_j / h_j = a_jh_i / h_ih_j $ in $ A_{h_ih_j} $. Thus for some $ n $, $ \br{h_ih_j}^n\br{h_ja_i - h_ia_j} = 0 $ in $ A $. We can pick an $ n $ sufficiently large to work for all pairs $ i $ and $ j $. Rewriting, $ h_j^{n + 1}\br{h_i^na_i} - h_i^{n + 1}\br{h_ja_j} = 0 $. Replace each $ h_i $ by $ h_i^{n + 1} $ and $ a_i $ by $ h_i^na_i $, since $ a_i / h_i = a_ih_i^n / h_i^{n + 1} $. Thus we can assume that $ s $ is still represented on $ \DD\br{h_i} $ by $ a_i / h_i $ but also for each $ i $ and $ j $ have $ h_ia_j = h_ja_i $. Note $ f^n = \sum_ib_ih_i $ for $ b_i \in A $, since $ \cbr{\DD\br{h_i}} $ cover $ \DD\br{f} $. Let $ a = \sum_i b_ia_i $. Then for any $ j $, $ h_ja = \sum_i b_ia_ih_j = \sum_i b_ia_jh_i = f^na_j $. Thus $ a / f^n = a_j / h_j $ on $ \DD\br{h_j} $. Thus $ \psi\br{a / f^n} = s $, so $ \psi $ is surjective.
\end{itemize}
\end{proof}

We now have a topological space $ \Spec A $ equipped with a sheaf of rings $ \OOO $.

\subsection{Ringed spaces}

\begin{definition*}
A \textbf{ringed space} is a pair $ \br{X, \OOO_X} $ where
\begin{itemize}
\item $ X $ is a topological space, and
\item $ \OOO_X $ is a sheaf of rings on $ X $.
\end{itemize}
A \textbf{morphism of ringed spaces} $ f : \br{X, \OOO_X} \to \br{Y, \OOO_Y} $ is the following data.
\begin{itemize}
\item $ f : X \to Y $ a continuous map.
\item $ f^\# : \OOO_Y \to f_*\OOO_X $ a morphism of sheaves of rings, that is for each $ U \subseteq Y $ open, we have a ring homomorphism $ f_U^\# : \OOO_Y\br{U} \to \br{f_*\OOO_X}\br{U} = \OOO_X\br{f^{-1}\br{U}} $.
\end{itemize}
\end{definition*}

\pagebreak

\begin{example*}
\hfill
\begin{itemize}
\item Let $ X $ be a topological space, and let $ \OOO_X $ be the sheaf of continuous $ \RR $-valued functions. Then if $ \br{Y, \OOO_Y} $ is similarly defined, given $ f : X \to Y $, we get $ f^\# : \OOO_Y \to f_*\OOO_X $ defined by
$$ \function[f_U^\#]{\OOO_Y\br{U}}{\OOO_X\br{f^{-1}\br{U}}}{\phi}{\phi \circ f}. $$
\item Let $ X $ be a variety, and let $ \OOO_X $ be the sheaf of regular functions on $ X $. A morphism of varieties $ f : X \to Y $ is a continuous map inducing
$$ \function[f_U^\#]{\OOO_Y\br{U}}{\OOO_X\br{f^{-1}\br{U}}}{\phi}{\phi \circ f}. $$
\end{itemize}
\end{example*}

A ring is \textbf{local} if it has a unique maximal ideal.

\begin{definition*}
A \textbf{locally ringed space} $ \br{X, \OOO_X} $ is a ringed space such that $ \OOO_{X, p} $ is a local ring for all $ p \in X $. A \textbf{morphism $ f : \br{X, \OOO_X} \to \br{Y, \OOO_Y} $ of locally ringed spaces} is a morphism of ringed spaces such that the induced homomorphism $ f_p^\# : \OOO_{Y, f\br{p}} \to \OOO_{X, p} $ is a \textbf{local homomorphism} for all $ p \in X $.
\begin{itemize}
\item The map is defined by \footnote{Exercise: check well-defined}
$$ \function[f_p^\#]{\OOO_{Y, f\br{p}}}{\OOO_{X, p}}{\br{U, s}}{\br{f^{-1}\br{U}, f_U^\#\br{s}}}. $$
\item A ring homomorphism $ \phi : \br{A, \mmm_A} \to \br{B, \mmm_B} $ is \textbf{local} if $ \phi^{-1}\br{\mmm_B} = \mmm_A $, where $ \mmm_A $ is the maximal ideal of $ A $. Note that $ \phi\br{A \setminus \mmm_A} = \phi\br{A^*} \subseteq B^* = B \setminus \mmm_B $, where $ A^* $ is the set of invertible elements of $ A $. Thus $ \phi^{-1}\br{\mmm_B} \subseteq \mmm_A $ always.
\end{itemize}
\end{definition*}

\begin{example*}
In the case of varieties, $ \OOO_{X, p} $ has a unique maximal ideal
$$ \cbr{\br{U, f} \in \OOO_X\br{U} \st f\br{p} = 0} / \sim. $$
If $ f\br{p} \ne 0 $, $ f $ is nowhere vanishing on some neighbourhood of $ p $, so after shrinking $ U $, we can invert $ f $. The local homomorphism condition just follows from the pull-back $ \phi \circ f $ of a function $ \phi $ vanishing at $ f\br{p} $ vanishes at $ p $.
\end{example*}

\subsection{Affine schemes}

\lecture{7}{Friday}{23/10/20}

The key example $ \br{\Spec A, \OOO} $ is a locally ringed space, which we call an affine scheme.

\begin{theorem}
The category of affine schemes with locally ringed morphisms is equivalent to the opposite category of rings.
\end{theorem}

Need to show that
\begin{enumerate}
\item if $ \phi : A \to B $ is a ring homomorphism, we obtain an induced morphism $ \br{f, f^\#} : \br{\Spec B, \OOO_{\Spec B}} \to \br{\Spec A, \OOO_{\Spec A}} $, and
\item any morphism of affine schemes as locally ringed spaces arises in this way.
\end{enumerate}

\begin{proof}
\hfill
\begin{enumerate}
\item Given a ring homomorphism $ \phi : A \to B $, define
$$ \function[f]{\Spec B}{\Spec A}{\ppp}{\phi^{-1}\br{\ppp}}. $$
Note $ \phi^{-1}\br{\ppp} $ is prime, since if $ ab \in \phi^{-1}\br{\ppp} $, then $ \phi\br{ab} = \phi\br{a}\phi\br{b} \in \ppp $, thus either $ \phi\br{a} \in \ppp $ or $ \phi\br{b} \in \ppp $, and hence either $ a \in \phi^{-1}\br{\ppp} $ or $ b \in \phi^{-1}\br{\ppp} $. Then $ f $ is continuous, since
\begin{align*}
f^{-1}\br{\VV\br{I}}
& = f^{-1}\br{\cbr{\ppp \in \Spec A \st \ppp \supseteq I}}
= \cbr{\qqq \in \Spec B \st f\br{\qqq} \supseteq I} \\
& = \cbr{\qqq \in \Spec B \st \phi^{-1}\br{\qqq} \supseteq I}
= \cbr{\qqq \in \Spec B \st \qqq \supseteq \phi\br{I}} = \VV\br{\phi\br{I}}.
\end{align*}

\pagebreak

We need to construct $ f^\# : \OOO_{\Spec A} \to f_*\OOO_{\Spec B} $. For $ \ppp \in \Spec B $, we obtain a natural homomorphism
$$ \function[\phi_\ppp]{A_{\phi^{-1}\br{\ppp}}}{B_\ppp}{\dfrac{a}{s}}{\dfrac{\phi\br{a}}{\phi\br{s}}}. $$
Note $ \phi_\ppp $ is a local homomorphism, since the maximal ideal $ \ppp B_\ppp $ of $ B_\ppp $ is generated by the image of $ \ppp $ under the map
$$ \function{B}{B_\ppp}{b}{\dfrac{b}{1}}, $$
and the maximal ideal $ \phi^{-1}\br{\ppp}A_{\phi^{-1}\br{\ppp}} $ of $ A_{\phi^{-1}\br{\ppp}} $ is generated by the image of $ \phi^{-1}\br{\ppp} $ under the map
$$ \function{A}{A_{\phi^{-1}\br{\ppp}}}{a}{\dfrac{a}{1}}, $$
so have a commutative diagram
$$
\begin{tikzcd}
\phi^{-1}\br{\ppp} \arrow[subset]{r} & A \arrow{r}{\phi} \arrow{d} & B \arrow{d} & \ppp \arrow[subset]{l} \\
f\br{\ppp}A_{f\br{\ppp}} \arrow[subset]{r} & A_{\phi^{-1}\br{\ppp}} \arrow{r}[swap]{\phi_\ppp} & B_\ppp & \ppp B_\ppp \arrow[subset]{l}
\end{tikzcd},
$$
thus $ \phi_\ppp^{-1}\br{\ppp B_\ppp} =\phi^{-1}\br{\ppp}A_{\phi^{-1}\br{\ppp}} $. Given $ V \subseteq \Spec A $ open, we may define
$$ \function[f_V^\#]{\OOO_{\Spec A}\br{V}}{\OOO_{\Spec B}\br{f^{-1}\br{V}}}{\br{\ppp \in V \mapsto s\br{\ppp} \in A_\ppp}}{\br{\qqq \in f^{-1}\br{V} \mapsto \phi_\qqq\br{s\br{f\br{\qqq}}} \in B_\qqq}}. $$
Note that we need to check the local coherence part of the definition of $ \OOO $. That is, if $ s $ is locally given by $ a / h $, then $ f_V^\#\br{s} $ is locally given by $ \phi\br{a} / \phi\br{h} $. This gives the desired map $ f^\# : \OOO_{\Spec A} \to f_*\OOO_{\Spec B} $, and the induced map on stalks $ f_\ppp^\# : \OOO_{\Spec A, f\br{\ppp}} \to \OOO_{\Spec B, \ppp} $ agrees with $ \phi_\ppp : A_{\phi^{-1}\br{\ppp}} \to B_\ppp $, by construction. Hence $ \br{f, f^\#} $ is a morphism of locally ringed spaces.
\item Now suppose given a morphism $ \br{f, f^\#} : \Spec B \to \Spec A $ of locally ringed spaces. Take
$$ \phi = f_{\Spec A}^\# : \Gamma\br{\Spec A, \OOO_{\Spec A}} = A \to \Gamma\br{\Spec B, \OOO_{\Spec B}} = B. $$
We need to show $ \phi $ gives rise to $ \br{f, f^\#} $. We have $ f_\ppp^\# : \OOO_{\Spec A, f\br{\ppp}} = A_{f\br{\ppp}} \to \OOO_{\Spec B, \ppp} = B_\ppp $ a local homomorphism. This is compatible with the corresponding map on global sections, that is
$$
\begin{tikzcd}
\Gamma\br{\Spec A, \OOO_{\Spec A}} \arrow{r}{f_{\Spec A}^\#} \arrow{d} & \Gamma\br{\Spec B, \OOO_{\Spec B}} \arrow{d} \\
\OOO_{\Spec A, f\br{\ppp}} \arrow{r}[swap]{f_\ppp^\#} & \OOO_{\Spec B, \ppp}
\end{tikzcd}
$$
is commutative. That is, we have a commutative diagram
$$
\begin{tikzcd}
f\br{\ppp} \arrow[subset]{r} & A \arrow{r}{\phi} \arrow{d} & B \arrow{d} & \ppp \arrow[subset]{l} \\
f\br{\ppp}A_{f\br{\ppp}} \arrow[subset]{r} & A_{f\br{\ppp}} \arrow{r}[swap]{f_\ppp^\#} & B_\ppp & \ppp B_\ppp \arrow[subset]{l}
\end{tikzcd}.
$$
Then $ \br{f_\ppp^\#}^{-1}\br{\ppp B_\ppp} = f\br{\ppp}A_{f\br{\ppp}} $ since $ f_\ppp^\# $ is a local homomorphism, and by commutativity of the diagram, $ f\br{\ppp} = \phi^{-1}\br{\ppp} $. Thus $ f $ is induced by $ \phi $, and $ f_\ppp^\# = \phi_\ppp $. So $ f^\# $ is as constructed previously.
\end{enumerate}
\end{proof}

\begin{remark*}
Demanding $ \br{f, f^\#} $ was a morphism of locally ringed spaces was crucial to make the proof work.
\end{remark*}

\pagebreak

\begin{definition*}
An \textbf{affine scheme} is a locally ringed space isomorphic, in the category of locally ringed spaces, to $ \br{\Spec A, \OOO_{\Spec A}} $ for some ring $ A $. A \textbf{scheme} is a locally ringed space $ \br{X, \OOO_X} $ with an open cover $ \cbr{\br{U_i, \eval{\OOO_X}_{U_i}}} $ with each $ \br{U_i, \eval{\OOO_X}_{U_i}} $ an affine scheme, where $ \eval{\OOO_X}_{U_i}\br{V} = \OOO_X\br{V} $ for $ V \subseteq U_i $ open. A \textbf{morphism of schemes} is a morphism of locally ringed spaces.
\end{definition*}

\begin{example*}
Let $ k $ be a field. Then $ \Spec k = \br{\cbr{0}, k} $. What does giving a morphism $ f : \Spec k \to X $ to a scheme mean? First, this selects a point $ x \in X $, the image of $ f $. Second, we get a local ring homomorphism $ f_x^\# : \OOO_{X, x} \to \OOO_{\Spec k, 0} = k $, that is $ \br{f_x^\#}^{-1}\br{0} = \mmm_x \subseteq \OOO_{X, x} $, the maximal ideal of $ \OOO_{X, x} $. Thus we get a factorisation $ f_x^\# : \OOO_{X, x} \to \OOO_{X, x} / \mmm_x \to k $, where $ \OOO_{X, x} / \mmm_x $ is a field, written as $ \kappa\br{x} $, called the \textbf{residue field} of $ X $ at $ x $. Thus $ f $ induces an inclusion $ \kappa\br{x} \hookrightarrow k $. Conversely, given such an inclusion $ \iota : \kappa\br{x} \hookrightarrow k $ of fields, we get a scheme morphism by defining $ f\br{0} = x $, and
$$ \function[f^\#]{\OOO_X}{f_*k}{s}{\iota\br{s\br{x}}}, \qquad s\br{x} \in \OOO_{X, x}. $$
The moral is that giving a morphism $ f : \Spec k \to X $ is equivalent to giving a point $ x \in X $ and an inclusion $ \iota : \kappa\br{x} \to k $. Note that if $ X = \Spec A $, giving $ \Spec k \to \Spec A $ is equivalent to giving a homomorphism $ A \to k $, which we viewed at the beginning of the course as a $ k $-valued point on $ \Spec A $.
\end{example*}

\end{document}